!function e(t,n,r){function o(a,l){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[a]={exports:{}};t[a][0].call(d.exports,function(e){var n=t[a][1][e];return o(n?n:e)},d,d.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function o(e){return 3*e.length/4-r(e)}function i(e){var t,n,o,i,a,l,s=e.length;a=r(e),l=new u(3*s/4-a),o=a>0?s-4:s;var c=0;for(t=0,n=0;t<o;t+=4,n+=3)i=d[e.charCodeAt(t)]<<18|d[e.charCodeAt(t+1)]<<12|d[e.charCodeAt(t+2)]<<6|d[e.charCodeAt(t+3)],l[c++]=i>>16&255,l[c++]=i>>8&255,l[c++]=255&i;return 2===a?(i=d[e.charCodeAt(t)]<<2|d[e.charCodeAt(t+1)]>>4,l[c++]=255&i):1===a&&(i=d[e.charCodeAt(t)]<<10|d[e.charCodeAt(t+1)]<<4|d[e.charCodeAt(t+2)]>>2,l[c++]=i>>8&255,l[c++]=255&i),l}function a(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function l(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16)+(e[i+1]<<8)+e[i+2],o.push(a(r));return o.join("")}function s(e){for(var t,n=e.length,r=n%3,o="",i=[],a=16383,s=0,d=n-r;s<d;s+=a)i.push(l(e,s,s+a>d?d:s+a));return 1===r?(t=e[n-1],o+=c[t>>2],o+=c[t<<4&63],o+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],o+=c[t>>10],o+=c[t>>4&63],o+=c[t<<2&63],o+="="),i.push(o),i.join("")}n.byteLength=o,n.toByteArray=i,n.fromByteArray=s;for(var c=[],d=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=0,m=f.length;g<m;++g)c[g]=f[g],d[f.charCodeAt(g)]=g;d["-".charCodeAt(0)]=62,d["_".charCodeAt(0)]=63},{}],2:[function(e,t,n){(function(t){"use strict";function r(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}function o(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=a.prototype):(null===e&&(e=new a(t)),e.length=t),e}function a(e,t,n){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?g(e,t,n,r):"string"==typeof t?u(e,t,n):m(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t,n,r){return s(t),t<=0?i(e,t):void 0!==n?"string"==typeof r?i(e,t).fill(n,r):i(e,t).fill(n):i(e,t)}function d(e,t){if(s(t),e=i(e,t<0?0:0|p(t)),!a.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function u(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!a.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|b(t,n);e=i(e,r);var o=e.write(t,n);return o!==r&&(e=e.slice(0,o)),e}function f(e,t){var n=t.length<0?0:0|p(t.length);e=i(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function g(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),a.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=a.prototype):e=f(e,t),e}function m(e,t){if(a.isBuffer(t)){var n=0|p(t.length);return e=i(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||X(t.length)?i(e,0):f(e,t);if("Buffer"===t.type&&Q(t.data))return f(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function p(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function h(e){return+e!=e&&(e=0),a.alloc(+e)}function b(e,t){if(a.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return W(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return K(e).length;default:if(r)return W(e).length;t=(""+t).toLowerCase(),r=!0}}function C(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,n);case"utf8":case"utf-8":return w(this,t,n);case"ascii":return L(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return N(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function E(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=a.from(t,r)),a.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,o);if("number"==typeof t)return t=255&t,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,o){function i(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,l=e.length,s=t.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,l/=2,s/=2,n/=2}var c;if(o){var d=-1;for(c=n;c<l;c++)if(i(e,c)===i(t,d===-1?0:c-d)){if(d===-1&&(d=c),c-d+1===s)return d*a}else d!==-1&&(c-=c-d),d=-1}else for(n+s>l&&(n=l-s),c=n;c>=0;c--){for(var u=!0,f=0;f<s;f++)if(i(e,c+f)!==i(t,f)){u=!1;break}if(u)return c}return-1}function T(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r),r>o&&(r=o)):r=o;var i=t.length;if(i%2!==0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var l=parseInt(t.substr(2*a,2),16);if(isNaN(l))return a;e[n+a]=l}return a}function S(e,t,n,r){return Z(W(t,e.length-n),e,n,r)}function A(e,t,n,r){return Z(j(t),e,n,r)}function x(e,t,n,r){return A(e,t,n,r)}function O(e,t,n,r){return Z(K(t),e,n,r)}function _(e,t,n,r){return Z(q(t,e.length-n),e,n,r)}function N(e,t,n){return 0===t&&n===e.length?$.fromByteArray(e):$.fromByteArray(e.slice(t,n))}function w(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i=e[o],a=null,l=i>239?4:i>223?3:i>191?2:1;if(o+l<=n){var s,c,d,u;switch(l){case 1:i<128&&(a=i);break;case 2:s=e[o+1],128===(192&s)&&(u=(31&i)<<6|63&s,u>127&&(a=u));break;case 3:s=e[o+1],c=e[o+2],128===(192&s)&&128===(192&c)&&(u=(15&i)<<12|(63&s)<<6|63&c,u>2047&&(u<55296||u>57343)&&(a=u));break;case 4:s=e[o+1],c=e[o+2],d=e[o+3],128===(192&s)&&128===(192&c)&&128===(192&d)&&(u=(15&i)<<18|(63&s)<<12|(63&c)<<6|63&d,u>65535&&u<1114112&&(a=u))}}null===a?(a=65533,l=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),o+=l}return D(r)}function D(e){var t=e.length;if(t<=ee)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=ee));return n}function L(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function R(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function I(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=V(e[i]);return o}function k(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function M(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,n,r,o,i){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function P(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function z(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function U(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(e,t,n,r,o){return o||U(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(e,t,n,r,23,4),n+4}function H(e,t,n,r,o){return o||U(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(e,t,n,r,52,8),n+8}function G(e){if(e=Y(e).replace(te,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function Y(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function V(e){return e<16?"0"+e.toString(16):e.toString(16)}function W(e,t){t=t||1/0;for(var n,r=e.length,o=null,i=[],a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function j(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function q(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}function K(e){return $.toByteArray(G(e))}function Z(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function X(e){return e!==e}var $=e("base64-js"),J=e("ieee754"),Q=e("isarray");n.Buffer=a,n.SlowBuffer=h,n.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:r(),n.kMaxLength=o(),a.poolSize=8192,a._augment=function(e){return e.__proto__=a.prototype,e},a.from=function(e,t,n){return l(null,e,t,n)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(e,t,n){return c(null,e,t,n)},a.allocUnsafe=function(e){return d(null,e)},a.allocUnsafeSlow=function(e){return d(null,e)},a.isBuffer=function(e){return!(null==e||!e._isBuffer)},a.compare=function(e,t){if(!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=a.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var i=e[n];if(!a.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},a.byteLength=b,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)E(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)E(this,t,t+3),E(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)E(this,t,t+7),E(this,t+1,t+6),E(this,t+2,t+5),E(this,t+3,t+4);return this},a.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?w(this,0,e):C.apply(this,arguments)},a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},a.prototype.compare=function(e,t,n,r,o){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var i=o-r,l=n-t,s=Math.min(i,l),c=this.slice(r,o),d=e.slice(t,n),u=0;u<s;++u)if(c[u]!==d[u]){i=c[u],l=d[u];break}return i<l?-1:l<i?1:0},a.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1},a.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},a.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},a.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t=0|t,isFinite(n)?(n=0|n,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return T(this,e,t,n);case"utf8":case"utf-8":return S(this,e,t,n);case"ascii":return A(this,e,t,n);case"latin1":case"binary":return x(this,e,t,n);case"base64":return O(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ee=4096;a.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),t<e&&(t=e);var r;if(a.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=a.prototype;else{var o=t-e;r=new a(o,(void 0));for(var i=0;i<o;++i)r[i]=this[i+e]}return r},a.prototype.readUIntLE=function(e,t,n){e=0|e,t=0|t,n||M(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},a.prototype.readUIntBE=function(e,t,n){e=0|e,t=0|t,n||M(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},a.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,n){e=0|e,t=0|t,n||M(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*t)),r},a.prototype.readIntBE=function(e,t,n){e=0|e,t=0|t,n||M(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},a.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?(255-this[e]+1)*-1:this[e]},a.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),J.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),J.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),J.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),J.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t=0|t,n=0|n,!r){var o=Math.pow(2,8*n)-1;B(this,e,t,n,o,0)}var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},a.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t=0|t,n=0|n,!r){var o=Math.pow(2,8*n)-1;B(this,e,t,n,o,0)}var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},a.prototype.writeUInt8=function(e,t,n){return e=+e,t=0|t,n||B(this,e,t,1,255,0),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,n){return e=+e,t=0|t,n||B(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},a.prototype.writeUInt16BE=function(e,t,n){return e=+e,t=0|t,n||B(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},a.prototype.writeUInt32LE=function(e,t,n){return e=+e,t=0|t,n||B(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):z(this,e,t,!0),t+4},a.prototype.writeUInt32BE=function(e,t,n){return e=+e,t=0|t,n||B(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):z(this,e,t,!1),t+4},a.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t=0|t,!r){var o=Math.pow(2,8*n-1);B(this,e,t,n,o-1,-o)}var i=0,a=1,l=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===l&&0!==this[t+i-1]&&(l=1),this[t+i]=(e/a>>0)-l&255;return t+n},a.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t=0|t,!r){var o=Math.pow(2,8*n-1);B(this,e,t,n,o-1,-o)}var i=n-1,a=1,l=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===l&&0!==this[t+i+1]&&(l=1),this[t+i]=(e/a>>0)-l&255;return t+n},a.prototype.writeInt8=function(e,t,n){return e=+e,t=0|t,n||B(this,e,t,1,127,-128),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,n){return e=+e,t=0|t,n||B(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},a.prototype.writeInt16BE=function(e,t,n){return e=+e,t=0|t,n||B(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},a.prototype.writeInt32LE=function(e,t,n){return e=+e,t=0|t,n||B(this,e,t,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):z(this,e,t,!0),t+4},a.prototype.writeInt32BE=function(e,t,n){return e=+e,t=0|t,n||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):z(this,e,t,!1),t+4},a.prototype.writeFloatLE=function(e,t,n){return F(this,e,t,!0,n)},a.prototype.writeFloatBE=function(e,t,n){return F(this,e,t,!1,n)},a.prototype.writeDoubleLE=function(e,t,n){return H(this,e,t,!0,n)},a.prototype.writeDoubleBE=function(e,t,n){return H(this,e,t,!1,n)},a.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!a.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},a.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e=255&e);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var i;if("number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var l=a.isBuffer(e)?e:W(new a(e,r).toString()),s=l.length;for(i=0;i<n-t;++i)this[i+t]=l[i%s]}return this};var te=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:3,isarray:4}],3:[function(e,t,n){n.read=function(e,t,n,r,o){var i,a,l=8*o-r-1,s=(1<<l)-1,c=s>>1,d=-7,u=n?o-1:0,f=n?-1:1,g=e[t+u];for(u+=f,i=g&(1<<-d)-1,g>>=-d,d+=l;d>0;i=256*i+e[t+u],u+=f,d-=8);for(a=i&(1<<-d)-1,i>>=-d,d+=r;d>0;a=256*a+e[t+u],u+=f,d-=8);if(0===i)i=1-c;else{if(i===s)return a?NaN:(g?-1:1)*(1/0);a+=Math.pow(2,r),i-=c}return(g?-1:1)*a*Math.pow(2,i-r)},n.write=function(e,t,n,r,o,i){var a,l,s,c=8*i-o-1,d=(1<<c)-1,u=d>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:i-1,m=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,a=d):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),t+=a+u>=1?f/s:f*Math.pow(2,1-u),t*s>=2&&(a++,s/=2),a+u>=d?(l=0,a=d):a+u>=1?(l=(t*s-1)*Math.pow(2,o),a+=u):(l=t*Math.pow(2,u-1)*Math.pow(2,o),a=0));o>=8;e[n+g]=255&l,g+=m,l/=256,o-=8);for(a=a<<o|l,c+=o;c>0;e[n+g]=255&a,g+=m,a/=256,c-=8);e[n+g-m]|=128*p}},{}],4:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},{}],5:[function(e,t,n){"use strict";function r(){var e,t=u.doc.getElementById(f.ID.AMEND_INFO);return h.remove(t),t=u.doc.createElement("div"),e=u.doc.createElement("div"),h.setContenteditable(e,!1),t.appendChild(e),t.id=f.ID.AMEND_INFO,h.css(t,{position:"absolute","z-index":f.CSS.Z_INDEX.amendInfo,display:"none",padding:"6px","font-family":'"Microsoft Yahei","微软雅黑",Helvetica,SimSun,SimHei'}),e.innerHTML=o(),h.css(e,{"background-color":"white",padding:"0px","font-size":"12px",border:"1px solid #D8D8D8","-webkit-border-radius":"4px","-moz-border-radius":"4px","-border-radius":"4px","-webkit-box-shadow":"rgba(0, 0, 0, 0.24) 0px 3px 3px","-moz-box-shadow":"rgba(0, 0, 0, 0.24) 0px 3px 3px","box-shadow":"rgba(0, 0, 0, 0.24) 0px 3px 3px","min-width":"160px","max-width":"280px","min-height":"50px"}),S.template.appendChild(t),t}function o(){return u.client.type.isIOS||u.client.type.isMac||u.client.type.isAndroid?'<div id="'+f.ID.AMEND_INFO_SINGLE+'" style="display:none; padding: 8px 16px;"><img id="'+f.ID.AMEND_INFO_IMG+'" class="'+f.CLASS.IMG_NOT_DRAG+'" style="width: 40px; height: 40px !important; position: absolute; -webkit-border-radius: 40px;-moz-border-radius:40px;border-radius:40px;"><ul style="list-style-type: none;margin: 4px 0 0 50px;padding-left: 0;"><li style="line-height: 18px;white-space: nowrap;padding: 2px 0;"><span id="'+f.ID.AMEND_INFO_NAME+'" style="color:#000;font-size:12px;font-weight:bold;max-width:90px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:inline-block;"></span><span id="'+f.ID.AMEND_INFO_CONTENT+'" style="color:#000;font-size:12px;margin-left:.5em;display:inline-block;overflow:hidden;float:right"></span></li><li style="line-height: 18px;text-align: right;"><span id="'+f.ID.AMEND_INFO_TIME+'" style="color:#A3A3A3;font-size:12px;"></span></li></ul></div><div id="'+f.ID.AMEND_INFO_MULTI+'" style="display:none; padding: 8px 16px;"><p style="margin: 4px 16px;">'+p.Amend.MultiInfo+'</p></div><div id="'+f.ID.AMEND_INFO_TOOLS+'" style="padding:0;margin:0;box-sizing: border-box;"><div style="line-height: 26px;width: 50%;display:inline-block;text-align: center;padding:0 8px;margin:0;box-sizing: border-box;"><a id="'+f.ID.AMEND_INFO_REFUSE+'" href="javascript:void(0);" style="font-size:12px;display:block;cursor:pointer;color:#447BD8;text-decoration: blink;">'+p.Amend.BtnRefuse+'</a></div><div style="line-height: 26px;width: 50%;display:inline-block;text-align: center;padding:0 8px;margin:0;box-sizing: border-box;"><a id="'+f.ID.AMEND_INFO_ACCEPT+'" href="javascript:void(0);" style="font-size:12px;display:block;cursor:pointer;color:#447BD8;text-decoration: blink;">'+p.Amend.BtnAccept+"</a></div></div>":'<div id="'+f.ID.AMEND_INFO_SINGLE+'" style="display:none; padding: 8px 16px;"><img id="'+f.ID.AMEND_INFO_IMG+'" class="'+f.CLASS.IMG_NOT_DRAG+'" style="width: 40px; height: 40px !important; position: absolute;"><ul style="list-style-type: none;margin: 4px 0 0 50px;padding-left: 0;"><li style="line-height: 18px;white-space: nowrap;padding: 2px 0;"><span id="'+f.ID.AMEND_INFO_NAME+'" style="color:#000;font-size:12px;font-weight:bold;max-width:90px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:inline-block;"></span><span id="'+f.ID.AMEND_INFO_CONTENT+'" style="color:#000;font-size:12px;margin-left:.5em;display:inline-block;overflow:hidden;float:right"></span></li><li style="line-height: 18px;text-align: right;"><span id="'+f.ID.AMEND_INFO_TIME+'" style="color:#A3A3A3;font-size:12px;"></span></li></ul></div><div id="'+f.ID.AMEND_INFO_MULTI+'" style="display:none; padding: 8px 16px;"><p style="margin: 4px 16px;">'+p.Amend.MultiInfo+'</p></div><div id="'+f.ID.AMEND_INFO_TOOLS+'" style="padding:0;margin:0;box-sizing:border-box;border-top:1px solid #D8D8D8"><div style="line-height: 26px;width: 50%;display:inline-block;text-align: center;padding:0 8px;margin:0;box-sizing: border-box;border-right: 1px solid #D8D8D8"><a id="'+f.ID.AMEND_INFO_ACCEPT+'" href="javascript:void(0);" style="font-size:12px;display:block;cursor:pointer;color:#447BD8;text-decoration: blink;">'+p.Amend.BtnAccept+'</a></div><div style="line-height: 26px;width: 50%;display:inline-block;text-align: center;padding:0 8px;margin:0;box-sizing: border-box;"><a id="'+f.ID.AMEND_INFO_REFUSE+'" href="javascript:void(0);" style="font-size:12px;display:block;cursor:pointer;color:#447BD8;text-decoration: blink;">'+p.Amend.BtnRefuse+"</a></div></div>"}function i(){return{dom:S.cur,isSelection:!!S.isSelection}}function a(e){var t=S.cur,n=t.getAttribute(f.ATTR.SPAN_USERID),r=C.getUserByGuid(n),o=r?r.name:p.Amend.UserNameDefault,i=t.getAttribute(f.ATTR.SPAN_TIMESTAMP),a=!!t.getAttribute(f.ATTR.SPAN_DELETE),r=C.getUserByGuid(n);i=i.substring(0,i.length-3),S.curPos=e,S.img.src=r?r.imgUrl:"",S.name.innerText=o,S.name.setAttribute("title",o),S.content.innerText=a?p.Amend.Delete:p.Amend.Edit,S.time.innerText=i,S.multiUser.style.display="none",S.singleUser.style.display="block"}function l(e){S.curPos=e,S.singleUser.style.display="none",S.multiUser.style.display="block"}function s(e){S.main.parentNode==S.template&&(u.doc.body.appendChild(S.main),S.singleUser=u.doc.getElementById(f.ID.AMEND_INFO_SINGLE),S.multiUser=u.doc.getElementById(f.ID.AMEND_INFO_MULTI),S.img=u.doc.getElementById(f.ID.AMEND_INFO_IMG),S.name=u.doc.getElementById(f.ID.AMEND_INFO_NAME),S.content=u.doc.getElementById(f.ID.AMEND_INFO_CONTENT),S.time=u.doc.getElementById(f.ID.AMEND_INFO_TIME),S.tools=u.doc.getElementById(f.ID.AMEND_INFO_TOOLS),S.btnAccept=u.doc.getElementById(f.ID.AMEND_INFO_ACCEPT),S.btnRefuse=u.doc.getElementById(f.ID.AMEND_INFO_REFUSE)),S.cur?a(e):l(e),A.bindInfoBtn(),S.readonly?S.tools.style.display="none":S.tools.style.display="block",h.css(S.main,{top:"0px",left:"0px",display:"block",visibility:"hidden"}),h.setLayout({layerObj:S.main,target:e,layout:f.TYPE.POS.upLeft,fixed:!1,noSpace:!1,reverse:!0}),h.css(S.main,{display:"block",visibility:"visible"})}function c(){S.main&&(A.unbindInfoBtn(),S.cur=null,S.curPos=null,S.isMulti=!1,S.isSelection=!1,S.img.src="",S.name.innerText="",S.name.setAttribute("title",""),S.content.innerText="",h.css(S.main,{display:"none"}),S.template.appendChild(S.main))}function d(){h.remove(u.doc.getElementById(f.ID.AMEND_INFO))}var u=e("../common/env"),f=e("../common/const"),g=e("../common/utils"),m=e("../common/lang"),p=m.getLang(),h=e("../domUtils/domBase"),b=e("./amendUtils/amendBase"),C=e("./amendUser"),E=e("../common/wizUserAction"),v={onAccept:null,onRefuse:null},y=!1,T={x:null,y:null},S={cur:null,curPos:null,isMulti:!1,isSelection:!1,template:null,main:null,img:null,name:null,content:null,time:null,btnAccept:null,btnRefuse:null,init:function(e,t){S.template=u.doc.createElement("div"),S.main=r(),S.readonly=!(!e||!e.readonly),h.setContenteditable(S.main,!1),t&&t.onAccept&&(v.onAccept=t.onAccept),t&&t.onRefuse&&(v.onRefuse=t.onRefuse),A.unbind(),A.bind()},remove:function(){A.unbind(),d(),S.main=null,S.img=null,S.name=null,S.content=null,S.time=null,S.btnAccept=null,S.btnRefuse=null},show:function(e,t){clearTimeout(S.showTimer),clearTimeout(S.hideTimer);var n=g.isArray(e),r=n&&e.length>1,o=n?r?null:e[0]:e,i=!1;S.isSelection=n,S.isMulti!==r||o!==S.cur?(S.hide(!0),i=!0):(!S.curPos||Math.abs(S.curPos.left-t.left)>75||Math.abs(S.curPos.top-t.top)>24)&&(i=!0),i&&(S.showTimer=setTimeout(function(){S.isMulti=r,S.cur=o,s(t)},2*f.AMEND.INFO_TIMER))},hide:function(e){clearTimeout(S.showTimer),clearTimeout(S.hideTimer),(S.cur||S.isMulti)&&(e?c():S.hideTimer=setTimeout(c,f.AMEND.INFO_TIMER))},isInfo:function(e){var t=h.getParentByFilter(e,function(e){return e==S.main},!0);return!!t},start:function(){y=!1},stop:function(){S.hide(!0),y=!0}},A={bind:function(){u.client.type.isIOS||u.client.type.isAndroid?(u.event.add(f.EVENT.ON_TOUCH_START,A.handler.onTouchstart),u.event.add(f.EVENT.ON_TOUCH_END,A.handler.onMouseMove)):u.event.add(f.EVENT.ON_MOUSE_MOVE,A.handler.onMouseMove)},unbind:function(){u.event.remove(f.EVENT.ON_TOUCH_START,A.handler.onTouchstart),u.event.remove(f.EVENT.ON_TOUCH_END,A.handler.onMouseMove),u.event.remove(f.EVENT.ON_MOUSE_MOVE,A.handler.onMouseMove)},bindInfoBtn:function(){A.unbindInfoBtn(),u.client.type.isIOS||u.client.type.isAndroid?S.main.addEventListener("touchend",A.handler.onClick):S.main.addEventListener("click",A.handler.onClick)},unbindInfoBtn:function(){u.client.type.isIOS||u.client.type.isAndroid?S.main.removeEventListener("touchend",A.handler.onClick):S.main.removeEventListener("click",A.handler.onClick)},handler:{onMouseMove:function(e){var t=g.getEventClientPos(e);if((T.x!==t.x||T.y!==t.y)&&(T=t,!y)){var n,r=e.target,o=S.isInfo(r),i={width:20,height:20};if(o)return clearTimeout(S.showTimer),void clearTimeout(S.hideTimer);var a,l=u.doc.getSelection(),s=b.getWizDeleteParent(r)||b.getWizInsertParent(r);!l.isCollapsed&&s&&l.containsNode(s,!0)&&(a=l.isCollapsed?null:b.getAmendDoms({selection:!0,selectAll:!1})),a&&(a=a.deletedInsertList.concat(a.insertList,a.deleteList),0===a.length&&(a=null));var c;a||s?(c=parseInt(u.win.getComputedStyle(s)["font-size"]),isNaN(c)&&(c=14),n=h.getPageScroll(),
i.left=t.x+n.left,i.top=t.y+n.top-c,i.top<s.offsetTop&&(i.top=s.offsetTop),S.show(a||s,i)):S.hide(!1)}},onTouchstart:function(e){var t=e.target,n=S.isInfo(t);n||S.hide(!1)},onClick:function(e){var t;t=e.changedTouches?e.changedTouches[0].target:e.target,t.id==f.ID.AMEND_INFO_ACCEPT?A.handler.onAccept(e):t.id==f.ID.AMEND_INFO_REFUSE&&A.handler.onRefuse(e),g.stopEvent(e)},onAccept:function(e){v.onAccept&&v.onAccept(i()),S.hide(!0),E.save(E.ActionId.ClickAcceptFromAmendInfo)},onRefuse:function(e){v.onRefuse&&v.onRefuse(i()),S.hide(!0),E.save(E.ActionId.ClickRefuseFromAmendInfo)}}};t.exports=S},{"../common/const":14,"../common/env":16,"../common/lang":18,"../common/utils":20,"../common/wizUserAction":22,"../domUtils/domBase":24,"./amendUser":6,"./amendUtils/amendBase":7}],6:[function(e,t,n){"use strict";function r(e){return e}function o(e){if(f.client.type.isWeb)return"/wizas/a/users/avatar/"+e+"?default=true&_"+(new Date).valueOf();if(f.client.type.isWin)try{var t=external.GetAvatarByUserGUID(e);return t?t:m}catch(e){console.error(e)}else f.client.type.isMac||f.client.type.isIOS||f.client.type.isAndroid;return m}function i(e){if(f.client.type.isWeb);else if(f.client.type.isWin)try{return external.GetAliasByUserGUID(e)}catch(e){console.error(e)}else f.client.type.isMac||f.client.type.isIOS||f.client.type.isAndroid;return null}function a(){return b?b:b=f.doc.getElementById(g.ID.AMEND_USER_INFO)}function l(){b=f.doc.createElement("meta"),b.id=g.ID.AMEND_USER_INFO,b.name=g.ID.AMEND_USER_INFO,f.doc.getElementsByTagName("HEAD")[0].insertBefore(b,null)}function s(){if(!C){var e,t,n;if(C={},E={},b=a())try{E=JSON.parse(b.content);for(e in E)E.hasOwnProperty(e)&&(t=E[e],t.user_guid=e,n=i(e),n?t.user_name=n:t.user_name=t.name,C[e]=new p(t))}catch(e){}}}function c(e){var t,n,r=e.hash,o=g.COLOR.length,i={};if(s(),C[r])return C[r].color;for(t in C)C.hasOwnProperty(t)&&(n=C[t].color,i[n]=!0);for(t=0;t<o;t++)if(n=g.COLOR[t],!i[n])return n;return g.COLOR[0]}function d(e){C[e.guid]=e,E[e.guid]={color:e.color,name:e.name}}function u(){b||l(),b.content=JSON.stringify(E)}var f=e("../common/env"),g=e("../common/const"),m=(e("../domUtils/domBase"),"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAExUlEQVRYR9WZz08bRxTHvya1CHbUSHXCiZzCIaaBBOUUEveQSORWYwwRxRCpqtIqjZL8XQkEUppAbQMX6hgh5UetRiFV4MABQXoK2AgUx1vNzs7u7Hpmf3m3Vc3Blm2Gz/vOd95784goiqLgf/aIhAVdrVaxu7sLKomC7u7uwKQJBPrFi5eoVvfx6VMdZONOnIhjf78KBQoINQEnrwcuD+DkyS9bhvcNfXR0hFKppEKqWqp8BE0l1N7XgPXvKOjq6kJfX29L4L6hCfDh4aEnYBbQjRuD+PhxD4nEV77gfUEvLy/rXm1S2GIJQ3VtJ9TdoFtDfuKxOK5fv+YJ3jM0BfZmCd4y5tcUPp3+Njzo1dVV1Go1X5Yw+Z1oTOLWVI91HMfg4KBrcE9KLy0tq+mrVUvwwGSxzs5ODAxcDgt6yXWWcLIEVd5QezgzFA704iKBdk5rQmCLJdRzwYEPD2fCgS4WF408LMkSooOmhsl5mBYcTmlFQTY7HA50oVi0LRxeLcHDj4QGXShKK50jsGpfsyWY2uR5dCQbjtL5QsHUSzgVDidL8AcxNOiVlRXUagdccTEfSqGfLVmCt4RRpBTcHB0JR+lS6Tn29va04iIBdsgSvCVoxlMQ/SKKTCYdPPT29jb+qFSEB5HvJbxYgnqctq2958+jpyfpCtx1RVxY+M1eYUsKYyrqAWmf85ZgwAx+bOxm8ND0D4rLOK+wXZbQg+F6bALfQAOj2Syi0agjuGul5+cXTA1+EJbg7UFeZ4bS6OjoCA762fy87udWsoTMHkT43PiYIzD5gmul19bW8OHD36Yy7tUSVg/T8q6VeCjIjX8XLDRZ/OkzojZNdX6zhNUSzOPEGrFYLFhotlpxcQkHBwdaZTS3l7LCYWeJeDyGoTBvLgy8XC5jl1jFppeQZQm/luC3wLWn+V9qNBqYm/u1qb3kewmZDXjVe5JJ9PdfdGWJlqHJAk9+mQOBl1nC6dCRTZrIuTt41qh8Kc0WmZmZ1dXmFbTzMCtOly71I3nunGeVPaU80eo7Ozv4vfRcvzY1WULrK8wBqW7HRG7cF3DL0GSBqenHRk9iKc3WQ8eGka0ABwZtpzADNZ4VTE7kfKscCPSjqWm9vZRnDGoJVv1uTf7H0A8fTen24DOGSGH23q3JiX9f6Xq9jnfv/sKfb954BmbTqYsX+nDmTBcSiYTnAFynvK2tLZDhef3zZ60S0huHLNXxHrZTnXwWiUTQffYsUqkrrgKQQpMLbD6fF+ZhN4WD9zB/cTC/ZsN3YwysN1CZNE6fOiUMwgT99u061tfXjRmb4IrkpnCIgOVBNAObdg/A1z1JfJO6qgegQ5fLqyDFwnqnY/M2L4WD75GZh5nCIqWlFqOyq7sdaWvDnZ9uq+A69Ozsk1AUtt4rhd2fNkpg4wWzULT9JZ/d/uF7tLe3U+iNjU1tPGAMBu1uzbJKZ1W4FUuIhpQX+nqRSl2l0O/fb6BSqZhbTX32xmUJm14iVGCN5VjbMfx850cK/erVa2xuburb4LaBl6U1mSVE6zpZwphhE4s0cP/eXQqdzxewX61Kcy6bS9ComPLm0ixKa34PXXMyoMDkoUNPP56Rt5fcITGUEgMH6mGLPdl/fh/cv4t/ANultPKz243RAAAAAElFTkSuQmCC"),p=function(e){e||(e={}),this.guid=e.user_guid||"",this.hash=r(this.guid),this.name=e.user_name||"",this.imgUrl=e.img_url?e.img_url:o(this.guid),this.color=e.color||c(this)},h=null,b=null,C=null,E=null,v={initUser:function(e){return s(),e?(h=new p(e),void d(h)):null},getCurUser:function(){return u(),h},getUserByGuid:function(e){return h&&e===h.guid?h:C&&C[e]?C[e]:(s(),C[e])},setUsersData:function(e){var t,n,r,o,i;if(e)for(t=0,n=e.length;t<n;t++)r=e[t],o=C[r.user_guid],i=E[r.user_guid],o&&r.user_name&&(o.name=r.user_name),o&&r.img_url&&(o.imgUrl=r.img_url),i&&r.user_name&&(i.name=r.user_name)}};t.exports=v},{"../common/const":14,"../common/env":16,"../domUtils/domBase":24}],7:[function(e,t,n){"use strict";var r=e("../../common/env"),o=e("../../common/const"),i=e("../../common/utils"),a=e("../../domUtils/domBase"),l=e("../../rangeUtils/rangeBase"),s={getAmendDoms:function(e){var t,n,r,l={},c={},d={insertList:[],deleteList:[],deletedInsertList:[]},u=[];if(e.selection)l[o.ATTR.SPAN_INSERT]="",d.insertList=s.getWizSpanFromRange(e.selectAll,l),d.deletedInsertList=a.removeListFilter(d.insertList,function(e){return e.getAttribute(o.ATTR.SPAN_DELETE)}),c[o.ATTR.SPAN_DELETE]="",d.deleteList=s.getWizSpanFromRange(e.selectAll,c),u=a.removeListFilter(d.deleteList,function(e){return e.getAttribute(o.ATTR.SPAN_INSERT)}),d.deletedInsertList=i.removeDup(d.deletedInsertList.concat(u));else for(t=0,n=e.domList.length;t<n;t++)r=e.domList[t],r.getAttribute(o.ATTR.SPAN_DELETE)&&r.getAttribute(o.ATTR.SPAN_INSERT)?d.deletedInsertList.push(r):r.getAttribute(o.ATTR.SPAN_DELETE)?d.deleteList.push(r):r.getAttribute(o.ATTR.SPAN_INSERT)&&d.insertList.push(r);return d},getSameTimeStampDom:function(e){function t(e,t,a){var l,c,d,u=n(e),f=e.getAttribute(o.ATTR.SPAN_TIMESTAMP),g=e.getAttribute(o.ATTR.SPAN_USERID);if(f)for(var m=r(e,t);m;)l=s.getWizInsertParent(m)||s.getWizDeleteParent(m),m=l,m&&m.getAttribute(o.ATTR.SPAN_USERID)!==g?m=null:m&&(c=m.getAttribute(o.ATTR.SPAN_TIMESTAMP),d=n(m),u===d&&i.isSameAmendTime(m.getAttribute(o.ATTR.SPAN_TIMESTAMP),f)?(t?a.splice(0,0,m):a.push(m),m=r(m,t)):m=null)}function n(e){return e.getAttribute(o.ATTR.SPAN_DELETE)&&e.getAttribute(o.ATTR.SPAN_INSERT)?1:e.getAttribute(o.ATTR.SPAN_INSERT)?2:e.getAttribute(o.ATTR.SPAN_DELETE)?3:0}function r(e,t){return t?a.getPreviousNode(e,!1,null):a.getNextNode(e,!1,null)}if(!e||1!=e.nodeType)return[];var l=[];return t(e,!0,l),l.push(e),t(e,!1,l),l},getSelectedAmendDoms:function(){function e(e,t,n){if(0===e.length||0===n)return null;var r=e[0];return r===t||a.contains(r,t)?(e.splice(0,1),{dom:t,offset:n}):null}function t(e,t,n){if(0===e.length)return null;var r=3===t.nodeType?t.length:t.childNodes.length;if(n===r)return null;var o=e[e.length-1];return o===t||a.contains(o,t)?(e.splice(e.length-1,1),{dom:t,offset:n}):null}var n,o,i,l,c=r.doc.getSelection(),d=c.getRangeAt(0),u=s.getAmendDoms({selection:!0,selectAll:!1});if(0===u.insertList.length&&0===u.deleteList.length&&0===u.deletedInsertList.length)return null;if(c.isCollapsed)return u;n=d.startContainer,i=d.startOffset,o=d.endContainer,l=d.endOffset;var f=e(u.deleteList,n,i);f||(f=e(u.insertList,n,i),f||(f=e(u.deletedInsertList,n,i)));var g={};return o===n&&f?(g.dom=f.dom,g.offset=l):(g=t(u.deleteList,o,l),g||(g=t(u.insertList,o,l),g||(g=t(u.deletedInsertList,o,l)))),u.start=f,u.end=g,u},getWizAmendImgParent:function(e){return a.getParentByFilter(e,function(e){return e&&1===e.nodeType&&e.getAttribute(o.ATTR.IMG)},!0)},getWizAmendParent:function(e){return a.getParentByFilter(e,function(e){return e&&1===e.nodeType&&(e.getAttribute(o.ATTR.SPAN_INSERT)||e.getAttribute(o.ATTR.SPAN_DELETE))},!0)},getWizDeleteParent:function(e){return a.getParentByFilter(e,function(e){return e&&1===e.nodeType&&e.getAttribute(o.ATTR.SPAN_DELETE)},!0)},getWizInsertParent:function(e){return a.getParentByFilter(e,function(e){return e&&1===e.nodeType&&e.getAttribute(o.ATTR.SPAN_INSERT)&&!e.getAttribute(o.ATTR.SPAN_DELETE)&&e.childNodes.length>0},!0)},getWizSpanFromRange:function(e,t){function n(e){if(!e||1!==e.nodeType)return!1;var n;for(n in t)if(t.hasOwnProperty(n)&&(!e.getAttribute(n)||t[n]&&e.getAttribute(n)!=t[n]))return!1;return!0}var o,i,s,c="span";if(!t)return[];for(o in t)t.hasOwnProperty(o)&&(c+=t[o]?"["+o+'="'+t[o]+'"]':"["+o+"]");var d,u,f,g,m,p,h,b,C,E=r.doc.getSelection(),v=[];if(e){var y=r.doc.querySelectorAll(c);for(o=0,i=y.length;o<i;o++)v.push(y[o]);return v}if(0===E.rangeCount)return[];if(E.isCollapsed)return u=l.getRangeAnchor(!1),d=a.getPreviousNode(u,!1,null),u&&(u=a.getParentByFilter(u,n,!0),u&&v.push(u)),v;if(d=l.getRangeAnchor(!0),u=l.getRangeAnchor(!1),!d||!u)return[];if(f=a.getParentByFilter(d,n,!0),g=a.getParentByFilter(u,n,!0),f&&f==g)return[f];for(m=a.getParentRoot([d,u]),p=m.querySelectorAll(c),h=a.getIndexList(d),b=a.getIndexList(u),f&&v.push(f),o=0,i=p.length;o<i;o++)s=p[o],C=a.getIndexList(s),a.compareIndexList(h,C)<=0&&a.compareIndexList(b,C)>=0&&v.push(s);return v},isAmendEdited:function(){var e=s.getAmendDoms({selection:!0,selectAll:!0});return!!e&&(e.deleteList.length>0||e.insertList.length>0||e.deletedInsertList.length>0)},isWizAmend:function(e){return s.getWizAmendParent(e)},isWizDelete:function(e){return!!s.getWizDeleteParent(e)},isWizInsert:function(e){return!!s.getWizInsertParent(e)}};t.exports=s},{"../../common/const":14,"../../common/env":16,"../../common/utils":20,"../../domUtils/domBase":24,"../../rangeUtils/rangeBase":38}],8:[function(e,t,n){"use strict";function r(){d&&d.parentNode!==c&&i(),u&&clearTimeout(u),u=setTimeout(o,100)}function o(){E=[];var e,t,n,r,o=f.doc.querySelectorAll("table");for(e=o.length-1;e>=0;e--)n=o[e],r=h.getContainer(n),r||(h.initTableContainer(n),r=h.getContainer(n)),t=r.querySelector("."+g.CLASS.TABLE_BODY),E.push({type:C.Table,target:t,top:r.offsetTop,height:r.offsetHeight});if(!f.client.type.isPhone&&!f.client.type.isPad){var a,l,s=f.doc.querySelectorAll("."+g.CLASS.CODE_MIRROR);for(e=s.length-1;e>=0;e--)a=s[e],l=m.getContainerFromChild(a),l||(m.fixCode(a),l=m.getContainerFromChild(a)),l&&(t=a.querySelector("."+g.CLASS.CODE_MIRROR_HSCROLL),E.push({type:C.Code,target:t,codeMirror:l.codeMirror,top:l.offsetTop,height:l.offsetHeight}))}i()}function i(){if(0!==E.length){var e,t,n=f.doc.documentElement.clientHeight,r=f.doc.body.scrollTop,o=r+n;for(e=E.length-1;e>=0;e--)if(t=E[e],t.top<o&&t.top+t.height>o&&t.target.offsetWidth<t.target.scrollWidth)return d&&d.curBlock&&d.curBlock.target===t.target?void l(t):(d&&a(),void s(t));a()}}function a(){d&&(v.unbindScroll(),d.curBlock=null,c.appendChild(d))}function l(e){var t;d?t=d.children[0]:(d=f.doc.createElement(g.TAG.TMP_TAG),t=f.doc.createElement("div"),d.appendChild(t),p.addClass(d,g.CLASS.BLOCK_SCROLL));var n=e.target.scrollWidth;p.css(t,{width:n+"px",height:"1px","background-color":"rgba(255, 255, 255, 0.2)"}),p.css(d,{"background-color":"rgba(255, 255, 255, 0.2)",height:"17px",width:e.target.offsetWidth+"px","overflow-x":"scroll","overflow-y":"hidden",position:"fixed",bottom:"0px","z-index":999}),d.scrollLeft=e.target.scrollLeft}function s(e){l(e),d.curBlock=e,p.after(d,e.target),v.bindScroll(),v.handler.onTxScroll()}var c,d,u,f=e("../common/env"),g=e("../common/const"),m=e("../codeUtils/codeUtils"),p=e("../domUtils/domExtend"),h=e("../tableUtils/tableUtils"),b=e("./blockUtils"),C={Table:"table",Code:"code"},E=[],v={bind:function(){v.unbind(),f.client.type.isIOS||f.client.type.isAndroid||(f.event.add(g.EVENT.ON_SCROLL,v.handler.onScroll),f.event.add(g.EVENT.ON_DOM_SUBTREE_MODIFIED,v.handler.updateRender),f.win.addEventListener("resize",v.handler.updateRender)),f.readonly||(f.client.type.isPhone||f.client.type.isPad?f.event.add(g.EVENT.ON_TOUCH_START,v.handler.onMouseDown):f.event.add(g.EVENT.ON_MOUSE_DOWN,v.handler.onMouseDown))},unbind:function(){a(),f.event.remove(g.EVENT.ON_SCROLL,v.handler.onScroll),f.event.remove(g.EVENT.ON_DOM_SUBTREE_MODIFIED,v.handler.updateRender),f.win.removeEventListener("resize",v.handler.updateRender),f.event.remove(g.EVENT.ON_TOUCH_START,v.handler.onMouseDown),f.event.remove(g.EVENT.ON_MOUSE_DOWN,v.handler.onMouseDown)},bindScroll:function(){v.unbindScroll(),d.addEventListener("scroll",v.handler.onSxScroll)},unbindScroll:function(){d.removeEventListener("scroll",v.handler.onSxScroll)},handler:{onMouseDown:function(e){var t="mousedown"!==e.type||0===e.button||1===e.button;t&&b.checkAndInsertEmptyLine(e)},onScroll:function(){r()},onSxScroll:function(){d.curBlock&&(d.curBlock.target.scrollLeft=d.scrollLeft)},onTxScroll:function(){d.curBlock&&(d.scrollLeft=d.curBlock.target.scrollLeft)},updateRender:function(){r()}}},y={on:function(){v.bind(),f.client.type.isIOS||f.client.type.isAndroid||(c||(c=f.doc.createElement("div")),r())},off:function(){v.unbind()}};t.exports=y},{"../codeUtils/codeUtils":12,"../common/const":14,"../common/env":16,"../domUtils/domExtend":25,"../tableUtils/tableUtils":44,"./blockUtils":9}],9:[function(e,t,n){"use strict";function r(e,t,n){var r,o,i=!1,a=!1,c=e?u.getFirstDeepChild(l.doc.body):u.getLastDeepChild(l.doc.body);if(o=u.getParentByClass(c,s.CLASS.CODE_CONTAINER))i=!0;else for(;c&&!u.canEdit(c);)c=e?u.getNextNodeCanEdit(c,!1):u.getPreviousNodeCanEdit(c,!1);return c&&(3==c.nodeType&&(c=c.parentNode),r=u.getOffset(c),o=u.getParentByFilter(c,n,!0),e&&t<r.top&&o?i=!0:!e&&t>r.top+c.offsetHeight&&o?a=!0:c=null),{container:o,isFirst:i,isLast:a}}function o(e){return u.hasClass(e,s.CLASS.CODE_CONTAINER)||u.hasClass(e,s.CLASS.TABLE_CONTAINER)}function i(e){return u.getParentByFilter(e,o,!0)}function a(e){return u.hasClass(e,s.CLASS.CODE_CONTAINER)||u.hasClass(e,s.CLASS.TABLE_CONTAINER)||u.hasClass(e,s.CLASS.TABLE_BODY)}var l=e("../common/env"),s=e("../common/const"),c=e("../common/utils"),d=e("../common/historyUtils"),u=e("../domUtils/domExtend"),f=e("../editor/commandExtend"),g=e("../tableUtils/tableZone"),m=e("../rangeUtils/rangeExtend"),p={checkAndInsertEmptyLine:function(e){var t,n,s,f,g=e.changedTouches?e.changedTouches[0]:null,m=g?g.target:e.target,h=c.getEventClientPos(e),b=l.doc.body.scrollTop+h.y,C=!1,E=!1;m===l.doc.body||m===l.doc.body.parentNode?(m===l.doc.body&&(s=r(!0,b,o),E=s.isFirst,n=s.container),E||(s=r(!1,b,o),C=s.isLast,n=s.container)):a(m)&&(n=i(m),f=0,n&&(f=b-u.getOffset(n).top),n&&f<15?(t=u.getPreviousNodeCanEdit(m,!1),t&&!i(t)||(E=!0)):n&&m.offsetHeight-f<15&&(t=u.getNextNodeCanEdit(m,!1),t&&!i(t)||(C=!0))),n&&(C||E)?(d.saveSnap(!1),p.insertEmptyLine(n,C)):t=null},insertBlock:function(e){var t,n,r,o,i=m.getRange();return i?(i=m.getRange(),t=m.getRangeDetail(i.startContainer,i.startOffset),n=t.container,r=u.getBlockParent(n,!0),u.hasClass(r,s.CLASS.TODO_LAYER)?(n=l.doc.createElement(r.tagName),u.after(n,r),n.appendChild(e),r=n):r&&u.isEmptyDom(r)||(f.execCommand("insertparagraph"),i=m.getRange(),n=i.startContainer,r=u.getBlockParent(n,!0)),u.isEmptyDom(r)&&u.isTag(r,"div")?(r.innerHTML="",r.appendChild(e)):(n=l.doc.createElement("div"),u.before(n,r),n.appendChild(e),u.isEmptyDom(r)&&u.remove(r),r=n)):(r=l.doc.createElement("div"),r.appendChild(e),l.doc.body.appendChild(r),o=l.doc.createElement("div"),o.appendChild(l.doc.createElement("br")),l.doc.body.appendChild(o)),r},insertEmptyLine:function(e,t){if(e){var n=l.doc.createElement("div"),r=l.doc.createElement("br");n.appendChild(r),u.before(n,e,t),g.clear(),m.setRange(r,0)}}};t.exports=p},{"../common/const":14,"../common/env":16,"../common/historyUtils":17,"../common/utils":20,"../domUtils/domExtend":25,"../editor/commandExtend":28,"../rangeUtils/rangeExtend":39,"../tableUtils/tableZone":45}],10:[function(e,t,n){"use strict";var r=e("../common/env"),o=e("../common/const"),i=e("../common/utils"),a=e("../common/dependLoader"),l=e("../common/historyUtils"),s=e("../blockUtils/blockUtils"),c=e("../domUtils/domExtend"),d=e("../rangeUtils/rangeExtend"),u=e("./codeUtils"),f=e("./codeStyle"),g={bind:function(){g.unbind(),r.event.add(o.EVENT.ON_SELECT_PLUGIN_CHANGE,g.handler.onChangeSelector),r.event.add(o.EVENT.BEFORE_GET_DOCHTML,g.handler.beforeGetDocHtml),r.event.add(o.EVENT.BEFORE_SAVESNAP,g.handler.onBeforeSaveSnap),r.event.add(o.EVENT.AFTER_RESTORE_HISTORY,g.handler.onAfterRestoreHistory),r.event.add(o.EVENT.ON_MOUSE_DOWN,g.handler.onMouseDown)},unbind:function(){r.event.remove(o.EVENT.ON_SELECT_PLUGIN_CHANGE,g.handler.onChangeSelector),r.event.remove(o.EVENT.BEFORE_GET_DOCHTML,g.handler.beforeGetDocHtml),r.event.remove(o.EVENT.BEFORE_SAVESNAP,g.handler.onBeforeSaveSnap),r.event.remove(o.EVENT.AFTER_RESTORE_HISTORY,g.handler.onAfterRestoreHistory),r.event.remove(o.EVENT.ON_MOUSE_DOWN,g.handler.onMouseDown)},handler:{beforeGetDocHtml:function(){u.saveToText(),f.clearStyle()},onAfterRestoreHistory:function(){var e,t,n,r,o=u.getContainerList();for(r=o.length-1;r>=0;r--)e=o[r],t=e.codeMirror,t||(u.fixCodeContainer(e),n=l.getCodeMirrorDoc(e.id),n&&(t=e.codeMirror,t.swapDoc(n)))},onBeforeSaveSnap:function(){var e,t,n,r=u.getContainerList();for(n=r.length-1;n>=0;n--)e=r[n],t=e.codeMirror,t&&(t.save(),c.setTextarea(t.getTextArea()))},onChangeSelector:function(e){var t;return c.hasClass(e,o.CLASS.CODE_TOOLS_MODE)?(t=u.getContainerFromChild(e),u.changeMode(t,e.value),void t.codeMirror.focus()):c.hasClass(e,o.CLASS.CODE_TOOLS_THEME)?(t=u.getContainerFromChild(e),f.insertTheme(e.value),u.changeTheme(t,e.value),void t.codeMirror.focus()):void 0},onMouseDown:function(e){var t=u.getToolsFromChild(e.target);t&&i.stopEvent(e)},onKeyDown:function(e){return!u.onKeyDown(e)||(i.stopEvent(e),!1)}}},m={loadDependency:function(e){"undefined"==typeof CodeMirror?a.loadJs(r.doc,a.getDependencyFiles(r.dependency,"js","codeMirror"),function(){e()}):e()},on:function(){g.bind(),f.initCommon(),u.oldPatch.fixOldCode(),u.fixCodeContainer()},off:function(){g.unbind(),u.clearCodeMirror()},insertCode:function(){l.saveSnap(!1);var e=d.getRange();if(u.canCreateCode()){var t,n,i,a,f,g="";if(e){if(!e.collapsed){for(a=r.doc.createElement("div"),f=e.cloneContents();f.firstChild;)a.appendChild(f.firstChild);a.style.position="absolute",a.style.top="0px",a.style.left="-10000px",a.style.height="1px",r.doc.body.appendChild(a),g=a.innerText,r.doc.body.removeChild(a),e.deleteContents()}t=d.getRangeDetail(e.startContainer,e.startOffset),t=c.getBlockParent(t.container,!0),t&&t!==r.doc.body&&c.isEmptyDom(t)&&c.isTag(t,"div")&&(n=t,t.innerHTML="")}i=r.doc.createElement("textarea"),c.setTextarea(i,g),n=n?n:r.doc.createElement("div"),n.appendChild(i),c.addClass(n,o.CLASS.CODE_CONTAINER),n.isNew=!0,n.parentNode||s.insertBlock(n),u.fixCodeContainer(n),n.isNew=!1,n.codeMirror.focus(),r.event.call(o.EVENT.UPDATE_RENDER)}},onKeyDown:g.handler.onKeyDown};t.exports=m},{"../blockUtils/blockUtils":9,"../common/const":14,"../common/dependLoader":15,"../common/env":16,"../common/historyUtils":17,"../common/utils":20,"../domUtils/domExtend":25,"../rangeUtils/rangeExtend":39,"./codeStyle":11,"./codeUtils":12}],11:[function(e,t,n){"use strict";var r=e("../common/env"),o=e("../common/const"),i=e("../common/wizStyle"),a=(e("../common/dependLoader"),e("../domUtils/domBase"),{tmp:{common:".wiz-code-tools {display:none;position: absolute; top: -32px; right: 0; opacity: .95; z-index: 10;}.CodeMirror-focused .wiz-code-tools {display:block;}.CodeMirror-sizer {border-right: 0 !important;}body pre.prettyprint {padding:0;}body pre.prettyprint code {white-space: pre;}body pre.prettyprint.linenums {box-shadow:none; overflow: auto;-webkit-overflow-scrolling: touch;}body pre.prettyprint.linenums ol.linenums {box-shadow: 40px 0 0 #FBFBFC inset, 41px 0 0 #ECECF0 inset; padding: 10px 10px 10px 40px !important;}",reader:".CodeMirror-cursors {visibility: hidden !important;}",phone:"."+o.CLASS.CODE_CONTAINER+"{margin-left:0; margin-right:0;}"},common:"."+o.CLASS.CODE_CONTAINER+'{position: relative; padding:8px 0; margin: 5px 25px 5px 5px;text-indent:0; text-align:left;}.CodeMirror {font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace; color: black; font-size: 10pt; font-size: 0.83rem}.CodeMirror-lines {padding: 4px 0;}.CodeMirror pre {padding: 0 4px;}.CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {background-color: white;}.CodeMirror-gutters {border-right: 1px solid #ddd; background-color: #f7f7f7; white-space: nowrap;}.CodeMirror-linenumbers {}.CodeMirror-linenumber {padding: 0 3px 0 5px; min-width: 20px; text-align: right; color: #999; white-space: nowrap;}.CodeMirror-guttermarker {color: black;}.CodeMirror-guttermarker-subtle {color: #999;}.CodeMirror-cursor {border-left: 1px solid black; border-right: none; width: 0;}.CodeMirror div.CodeMirror-secondarycursor {border-left: 1px solid silver;}.cm-fat-cursor .CodeMirror-cursor {width: auto; border: 0 !important; background: #7e7;}.cm-fat-cursor div.CodeMirror-cursors {z-index: 1;}.cm-animate-fat-cursor {width: auto; border: 0; -webkit-animation: blink 1.06s steps(1) infinite; -moz-animation: blink 1.06s steps(1) infinite; animation: blink 1.06s steps(1) infinite; background-color: #7e7;}@-moz-keyframes blink {  0% {}  50% { background-color: transparent; }  100% {}}@-webkit-keyframes blink {  0% {}  50% { background-color: transparent; }  100% {}}@keyframes blink {  0% {}  50% { background-color: transparent; }  100% {}}.CodeMirror-overwrite .CodeMirror-cursor {}.cm-tab { display: inline-block; text-decoration: inherit; }.CodeMirror-rulers {position: absolute; left: 0; right: 0; top: -50px; bottom: -20px; overflow: hidden;}.CodeMirror-ruler {border-left: 1px solid #ccc; top: 0; bottom: 0; position: absolute;}.cm-s-default .cm-header {color: blue;}.cm-s-default .cm-quote {color: #090;}.cm-negative {color: #d44;}.cm-positive {color: #292;}.cm-header, .cm-strong {font-weight: bold;}.cm-em {font-style: italic;}.cm-link {text-decoration: underline;}.cm-strikethrough {text-decoration: line-through;}.cm-s-default .cm-keyword {color: #708;}.cm-s-default .cm-atom {color: #219;}.cm-s-default .cm-number {color: #164;}.cm-s-default .cm-def {color: #00f;}.cm-s-default .cm-variable,.cm-s-default .cm-punctuation,.cm-s-default .cm-property,.cm-s-default .cm-operator {}.cm-s-default .cm-variable-2 {color: #05a;}.cm-s-default .cm-variable-3 {color: #085;}.cm-s-default .cm-comment {color: #a50;}.cm-s-default .cm-string {color: #a11;}.cm-s-default .cm-string-2 {color: #f50;}.cm-s-default .cm-meta {color: #555;}.cm-s-default .cm-qualifier {color: #555;}.cm-s-default .cm-builtin {color: #30a;}.cm-s-default .cm-bracket {color: #997;}.cm-s-default .cm-tag {color: #170;}.cm-s-default .cm-attribute {color: #00c;}.cm-s-default .cm-hr {color: #999;}.cm-s-default .cm-link {color: #00c;}.cm-s-default .cm-error {color: #f00;}.cm-invalidchar {color: #f00;}.CodeMirror-composing { border-bottom: 2px solid; }div.CodeMirror span.CodeMirror-matchingbracket {color: #0f0;}div.CodeMirror span.CodeMirror-nonmatchingbracket {color: #f22;}.CodeMirror-matchingtag { background: rgba(255, 150, 0, .3); }.CodeMirror-activeline-background {background: #e8f2ff;}.CodeMirror {position: relative; background: #f5f5f5;}.CodeMirror-scroll {overflow: hidden !important; margin-bottom: 0; margin-right: -30px; padding: 16px 30px 16px 0; outline: none; position: relative;}.CodeMirror-sizer {position: relative; border-right: 30px solid transparent;}.CodeMirror-vscrollbar, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {position: absolute; z-index: 6; display: none;}.CodeMirror-vscrollbar {right: 0; top: 0; overflow-x: hidden; overflow-y: scroll;}.CodeMirror-hscrollbar {bottom: 0; left: 0 !important; overflow-y: hidden; overflow-x: scroll;}.CodeMirror-scrollbar-filler {right: 0; bottom: 0;}.CodeMirror-gutter-filler {left: 0; bottom: 0;}.CodeMirror-gutters {position: absolute; left: 0; top: -5px; min-height: 100%; z-index: 3;}.CodeMirror-gutter {white-space: normal; height: inherit; display: inline-block; vertical-align: top; margin-bottom: -30px;}.CodeMirror-gutter-wrapper {position: absolute; z-index: 4; background: none !important; border: none !important;}.CodeMirror-gutter-background {position: absolute; top: 0; bottom: 0; z-index: 4;}.CodeMirror-gutter-elt {position: absolute; cursor: default; z-index: 4; text-align: center;}.CodeMirror-gutter-wrapper ::selection { background-color: transparent }.CodeMirror-gutter-wrapper ::-moz-selection { background-color: transparent }.CodeMirror-lines {cursor: text; min-height: 1px;}.CodeMirror pre {-moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; border-width: 0; background: transparent; font-family: inherit; font-size: inherit; margin: 0; white-space: pre; word-wrap: normal; line-height: inherit; color: inherit; z-index: 2; position: relative; overflow: visible; -webkit-tap-highlight-color: transparent; -webkit-font-variant-ligatures: contextual; font-variant-ligatures: contextual;}.CodeMirror-wrap pre {word-wrap: break-word; white-space: pre-wrap; word-break: normal;}.CodeMirror-linebackground {position: absolute; left: 0; right: 0; top: 0; bottom: 0; z-index: 0;}.CodeMirror-linewidget {position: relative; z-index: 2; overflow: auto;}.CodeMirror-widget {}.CodeMirror-rtl pre { direction: rtl; }.CodeMirror-code {outline: none;}.CodeMirror-scroll,.CodeMirror-sizer,.CodeMirror-gutter,.CodeMirror-gutters,.CodeMirror-linenumber {-moz-box-sizing: content-box; box-sizing: content-box;}.CodeMirror-measure {position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden;}.CodeMirror-cursor {position: absolute; pointer-events: none;}.CodeMirror-measure pre { position: static; }div.CodeMirror-cursors {visibility: hidden; position: relative; z-index: 3;}div.CodeMirror-dragcursors {visibility: visible;}.CodeMirror-focused div.CodeMirror-cursors {visibility: visible;}.CodeMirror-selected { background: #d9d9d9; }.CodeMirror-focused .CodeMirror-selected { background: #d7d4f0; }.CodeMirror-crosshair { cursor: crosshair; }.CodeMirror-line::selection, .CodeMirror-line > span::selection, .CodeMirror-line > span > span::selection { background: #d7d4f0; }.CodeMirror-line::-moz-selection, .CodeMirror-line > span::-moz-selection, .CodeMirror-line > span > span::-moz-selection { background: #d7d4f0; }.cm-searching {background: #ffa; background: rgba(255, 255, 0, .4);}.cm-force-border { padding-right: .1px; }@media print {  .CodeMirror div.CodeMirror-cursors {visibility: hidden;}}.cm-tab-wrap-hack:after { content: ""; }span.CodeMirror-selectedtext { background: none; }.CodeMirror-activeline-background, .CodeMirror-selected {transition: visibility 0ms 100ms;}.CodeMirror-blur .CodeMirror-activeline-background, .CodeMirror-blur .CodeMirror-selected {visibility:hidden;}.CodeMirror-blur .CodeMirror-matchingbracket {color:inherit !important;outline:none !important;text-decoration:none !important;}',theme:{"base16-dark":".cm-s-base16-dark.CodeMirror { background: #151515; color: #e0e0e0; }.cm-s-base16-dark div.CodeMirror-selected { background: #303030; }.cm-s-base16-dark .CodeMirror-line::selection, .cm-s-base16-dark .CodeMirror-line > span::selection, .cm-s-base16-dark .CodeMirror-line > span > span::selection { background: rgba(48, 48, 48, .99); }.cm-s-base16-dark .CodeMirror-line::-moz-selection, .cm-s-base16-dark .CodeMirror-line > span::-moz-selection, .cm-s-base16-dark .CodeMirror-line > span > span::-moz-selection { background: rgba(48, 48, 48, .99); }.cm-s-base16-dark .CodeMirror-gutters { background: #151515; border-right: 0px; }.cm-s-base16-dark .CodeMirror-guttermarker { color: #ac4142; }.cm-s-base16-dark .CodeMirror-guttermarker-subtle { color: #505050; }.cm-s-base16-dark .CodeMirror-linenumber { color: #505050; }.cm-s-base16-dark .CodeMirror-cursor { border-left: 1px solid #b0b0b0; }.cm-s-base16-dark span.cm-comment { color: #8f5536; }.cm-s-base16-dark span.cm-atom { color: #aa759f; }.cm-s-base16-dark span.cm-number { color: #aa759f; }.cm-s-base16-dark span.cm-property, .cm-s-base16-dark span.cm-attribute { color: #90a959; }.cm-s-base16-dark span.cm-keyword { color: #ac4142; }.cm-s-base16-dark span.cm-string { color: #f4bf75; }.cm-s-base16-dark span.cm-variable { color: #90a959; }.cm-s-base16-dark span.cm-variable-2 { color: #6a9fb5; }.cm-s-base16-dark span.cm-def { color: #d28445; }.cm-s-base16-dark span.cm-bracket { color: #e0e0e0; }.cm-s-base16-dark span.cm-tag { color: #ac4142; }.cm-s-base16-dark span.cm-link { color: #aa759f; }.cm-s-base16-dark span.cm-error { background: #ac4142; color: #b0b0b0; }.cm-s-base16-dark .CodeMirror-activeline-background { background: #202020; }.cm-s-base16-dark .CodeMirror-matchingbracket { text-decoration: underline; color: white !important; }","base16-light":".cm-s-base16-light.CodeMirror { background: #f5f5f5; color: #202020; }.cm-s-base16-light div.CodeMirror-selected { background: #e0e0e0; }.cm-s-base16-light .CodeMirror-line::selection, .cm-s-base16-light .CodeMirror-line > span::selection, .cm-s-base16-light .CodeMirror-line > span > span::selection { background: #e0e0e0; }.cm-s-base16-light .CodeMirror-line::-moz-selection, .cm-s-base16-light .CodeMirror-line > span::-moz-selection, .cm-s-base16-light .CodeMirror-line > span > span::-moz-selection { background: #e0e0e0; }.cm-s-base16-light .CodeMirror-gutters { background: #f5f5f5; border-right: 0px; }.cm-s-base16-light .CodeMirror-guttermarker { color: #ac4142; }.cm-s-base16-light .CodeMirror-guttermarker-subtle { color: #b0b0b0; }.cm-s-base16-light .CodeMirror-linenumber { color: #b0b0b0; }.cm-s-base16-light .CodeMirror-cursor { border-left: 1px solid #505050; }.cm-s-base16-light span.cm-comment { color: #8f5536; }.cm-s-base16-light span.cm-atom { color: #aa759f; }.cm-s-base16-light span.cm-number { color: #aa759f; }.cm-s-base16-light span.cm-property, .cm-s-base16-light span.cm-attribute { color: #90a959; }.cm-s-base16-light span.cm-keyword { color: #ac4142; }.cm-s-base16-light span.cm-string { color: #f4bf75; }.cm-s-base16-light span.cm-variable { color: #90a959; }.cm-s-base16-light span.cm-variable-2 { color: #6a9fb5; }.cm-s-base16-light span.cm-def { color: #d28445; }.cm-s-base16-light span.cm-bracket { color: #202020; }.cm-s-base16-light span.cm-tag { color: #ac4142; }.cm-s-base16-light span.cm-link { color: #aa759f; }.cm-s-base16-light span.cm-error { background: #ac4142; color: #505050; }.cm-s-base16-light .CodeMirror-activeline-background { background: #DDDCDC; }.cm-s-base16-light .CodeMirror-matchingbracket { text-decoration: underline; color: white !important; }",blackboard:".cm-s-blackboard.CodeMirror { background: #0C1021; color: #F8F8F8; }.cm-s-blackboard div.CodeMirror-selected { background: #253B76; }.cm-s-blackboard .CodeMirror-line::selection, .cm-s-blackboard .CodeMirror-line > span::selection, .cm-s-blackboard .CodeMirror-line > span > span::selection { background: rgba(37, 59, 118, .99); }.cm-s-blackboard .CodeMirror-line::-moz-selection, .cm-s-blackboard .CodeMirror-line > span::-moz-selection, .cm-s-blackboard .CodeMirror-line > span > span::-moz-selection { background: rgba(37, 59, 118, .99); }.cm-s-blackboard .CodeMirror-gutters { background: #0C1021; border-right: 0; }.cm-s-blackboard .CodeMirror-guttermarker { color: #FBDE2D; }.cm-s-blackboard .CodeMirror-guttermarker-subtle { color: #888; }.cm-s-blackboard .CodeMirror-linenumber { color: #888; }.cm-s-blackboard .CodeMirror-cursor { border-left: 1px solid #A7A7A7; }.cm-s-blackboard .cm-keyword { color: #FBDE2D; }.cm-s-blackboard .cm-atom { color: #D8FA3C; }.cm-s-blackboard .cm-number { color: #D8FA3C; }.cm-s-blackboard .cm-def { color: #8DA6CE; }.cm-s-blackboard .cm-variable { color: #FF6400; }.cm-s-blackboard .cm-operator { color: #FBDE2D; }.cm-s-blackboard .cm-comment { color: #AEAEAE; }.cm-s-blackboard .cm-string { color: #61CE3C; }.cm-s-blackboard .cm-string-2 { color: #61CE3C; }.cm-s-blackboard .cm-meta { color: #D8FA3C; }.cm-s-blackboard .cm-builtin { color: #8DA6CE; }.cm-s-blackboard .cm-tag { color: #8DA6CE; }.cm-s-blackboard .cm-attribute { color: #8DA6CE; }.cm-s-blackboard .cm-header { color: #FF6400; }.cm-s-blackboard .cm-hr { color: #AEAEAE; }.cm-s-blackboard .cm-link { color: #8DA6CE; }.cm-s-blackboard .cm-error { background: #9D1E15; color: #F8F8F8; }.cm-s-blackboard .CodeMirror-activeline-background { background: #3C3636; }.cm-s-blackboard .CodeMirror-matchingbracket { outline:1px solid grey;color:white !important; }",
eclipse:".cm-s-eclipse span.cm-meta { color: #FF1717; }.cm-s-eclipse span.cm-keyword { line-height: 1em; font-weight: bold; color: #7F0055; }.cm-s-eclipse span.cm-atom { color: #219; }.cm-s-eclipse span.cm-number { color: #164; }.cm-s-eclipse span.cm-def { color: #00f; }.cm-s-eclipse span.cm-variable { color: black; }.cm-s-eclipse span.cm-variable-2 { color: #0000C0; }.cm-s-eclipse span.cm-variable-3 { color: #0000C0; }.cm-s-eclipse span.cm-property { color: black; }.cm-s-eclipse span.cm-operator { color: black; }.cm-s-eclipse span.cm-comment { color: #3F7F5F; }.cm-s-eclipse span.cm-string { color: #2A00FF; }.cm-s-eclipse span.cm-string-2 { color: #f50; }.cm-s-eclipse span.cm-qualifier { color: #555; }.cm-s-eclipse span.cm-builtin { color: #30a; }.cm-s-eclipse span.cm-bracket { color: #cc7; }.cm-s-eclipse span.cm-tag { color: #170; }.cm-s-eclipse span.cm-attribute { color: #00c; }.cm-s-eclipse span.cm-link { color: #219; }.cm-s-eclipse span.cm-error { color: #f00; }.cm-s-eclipse .CodeMirror-activeline-background { background: #e8f2ff; }.cm-s-eclipse .CodeMirror-matchingbracket { outline:1px solid grey; color:black !important; }",material:".cm-s-material.CodeMirror {background-color: #263238; color: rgba(233, 237, 237, 1);}.cm-s-material .CodeMirror-gutters {background: #263238; color: rgb(83,127,126); border: none;}.cm-s-material .CodeMirror-guttermarker, .cm-s-material .CodeMirror-guttermarker-subtle, .cm-s-material .CodeMirror-linenumber { color: rgb(83,127,126); }.cm-s-material .CodeMirror-cursor { border-left: 1px solid #f8f8f0; }.cm-s-material div.CodeMirror-selected { background: rgba(255, 255, 255, 0.15); }.cm-s-material.CodeMirror-focused div.CodeMirror-selected { background: rgba(255, 255, 255, 0.10); }.cm-s-material .CodeMirror-line::selection, .cm-s-material .CodeMirror-line > span::selection, .cm-s-material .CodeMirror-line > span > span::selection { background: rgba(255, 255, 255, 0.10); }.cm-s-material .CodeMirror-line::-moz-selection, .cm-s-material .CodeMirror-line > span::-moz-selection, .cm-s-material .CodeMirror-line > span > span::-moz-selection { background: rgba(255, 255, 255, 0.10); }.cm-s-material .CodeMirror-activeline-background { background: rgba(0, 0, 0, 0); }.cm-s-material .cm-keyword { color: rgba(199, 146, 234, 1); }.cm-s-material .cm-operator { color: rgba(233, 237, 237, 1); }.cm-s-material .cm-variable-2 { color: #80CBC4; }.cm-s-material .cm-variable-3 { color: #82B1FF; }.cm-s-material .cm-builtin { color: #DECB6B; }.cm-s-material .cm-atom { color: #F77669; }.cm-s-material .cm-number { color: #F77669; }.cm-s-material .cm-def { color: rgba(233, 237, 237, 1); }.cm-s-material .cm-string { color: #C3E88D; }.cm-s-material .cm-string-2 { color: #80CBC4; }.cm-s-material .cm-comment { color: #546E7A; }.cm-s-material .cm-variable { color: #82B1FF; }.cm-s-material .cm-tag { color: #80CBC4; }.cm-s-material .cm-meta { color: #80CBC4; }.cm-s-material .cm-attribute { color: #FFCB6B; }.cm-s-material .cm-property { color: #80CBAE; }.cm-s-material .cm-qualifier { color: #DECB6B; }.cm-s-material .cm-variable-3 { color: #DECB6B; }.cm-s-material .cm-tag { color: rgba(255, 83, 112, 1); }.cm-s-material .cm-error {color: rgba(255, 255, 255, 1.0); background-color: #EC5F67;}.cm-s-material .CodeMirror-matchingbracket {text-decoration: underline; color: white !important;}",monokai:".cm-s-monokai.CodeMirror { background: #272822; color: #f8f8f2; }.cm-s-monokai div.CodeMirror-selected { background: #49483E; }.cm-s-monokai .CodeMirror-line::selection, .cm-s-monokai .CodeMirror-line > span::selection, .cm-s-monokai .CodeMirror-line > span > span::selection { background: rgba(73, 72, 62, .99); }.cm-s-monokai .CodeMirror-line::-moz-selection, .cm-s-monokai .CodeMirror-line > span::-moz-selection, .cm-s-monokai .CodeMirror-line > span > span::-moz-selection { background: rgba(73, 72, 62, .99); }.cm-s-monokai .CodeMirror-gutters { background: #272822; border-right: 0px; }.cm-s-monokai .CodeMirror-guttermarker { color: white; }.cm-s-monokai .CodeMirror-guttermarker-subtle { color: #d0d0d0; }.cm-s-monokai .CodeMirror-linenumber { color: #d0d0d0; }.cm-s-monokai .CodeMirror-cursor { border-left: 1px solid #f8f8f0; }.cm-s-monokai span.cm-comment { color: #75715e; }.cm-s-monokai span.cm-atom { color: #ae81ff; }.cm-s-monokai span.cm-number { color: #ae81ff; }.cm-s-monokai span.cm-property, .cm-s-monokai span.cm-attribute { color: #a6e22e; }.cm-s-monokai span.cm-keyword { color: #f92672; }.cm-s-monokai span.cm-builtin { color: #66d9ef; }.cm-s-monokai span.cm-string { color: #e6db74; }.cm-s-monokai span.cm-variable { color: #f8f8f2; }.cm-s-monokai span.cm-variable-2 { color: #9effff; }.cm-s-monokai span.cm-variable-3 { color: #66d9ef; }.cm-s-monokai span.cm-def { color: #fd971f; }.cm-s-monokai span.cm-bracket { color: #f8f8f2; }.cm-s-monokai span.cm-tag { color: #f92672; }.cm-s-monokai span.cm-header { color: #ae81ff; }.cm-s-monokai span.cm-link { color: #ae81ff; }.cm-s-monokai span.cm-error { background: #f92672; color: #f8f8f0; }.cm-s-monokai .CodeMirror-activeline-background { background: #373831; }.cm-s-monokai .CodeMirror-matchingbracket {text-decoration: underline; color: white !important;}","tomorrow-night-eighties":".cm-s-tomorrow-night-eighties.CodeMirror { background: #000000; color: #CCCCCC; }.cm-s-tomorrow-night-eighties div.CodeMirror-selected { background: #2D2D2D; }.cm-s-tomorrow-night-eighties .CodeMirror-line::selection, .cm-s-tomorrow-night-eighties .CodeMirror-line > span::selection, .cm-s-tomorrow-night-eighties .CodeMirror-line > span > span::selection { background: rgba(45, 45, 45, 0.99); }.cm-s-tomorrow-night-eighties .CodeMirror-line::-moz-selection, .cm-s-tomorrow-night-eighties .CodeMirror-line > span::-moz-selection, .cm-s-tomorrow-night-eighties .CodeMirror-line > span > span::-moz-selection { background: rgba(45, 45, 45, 0.99); }.cm-s-tomorrow-night-eighties .CodeMirror-gutters { background: #000000; border-right: 0px; }.cm-s-tomorrow-night-eighties .CodeMirror-guttermarker { color: #f2777a; }.cm-s-tomorrow-night-eighties .CodeMirror-guttermarker-subtle { color: #777; }.cm-s-tomorrow-night-eighties .CodeMirror-linenumber { color: #515151; }.cm-s-tomorrow-night-eighties .CodeMirror-cursor { border-left: 1px solid #6A6A6A; }.cm-s-tomorrow-night-eighties span.cm-comment { color: #d27b53; }.cm-s-tomorrow-night-eighties span.cm-atom { color: #a16a94; }.cm-s-tomorrow-night-eighties span.cm-number { color: #a16a94; }.cm-s-tomorrow-night-eighties span.cm-property, .cm-s-tomorrow-night-eighties span.cm-attribute { color: #99cc99; }.cm-s-tomorrow-night-eighties span.cm-keyword { color: #f2777a; }.cm-s-tomorrow-night-eighties span.cm-string { color: #ffcc66; }.cm-s-tomorrow-night-eighties span.cm-variable { color: #99cc99; }.cm-s-tomorrow-night-eighties span.cm-variable-2 { color: #6699cc; }.cm-s-tomorrow-night-eighties span.cm-def { color: #f99157; }.cm-s-tomorrow-night-eighties span.cm-bracket { color: #CCCCCC; }.cm-s-tomorrow-night-eighties span.cm-tag { color: #f2777a; }.cm-s-tomorrow-night-eighties span.cm-link { color: #a16a94; }.cm-s-tomorrow-night-eighties span.cm-error { background: #f2777a; color: #6A6A6A; }.cm-s-tomorrow-night-eighties .CodeMirror-activeline-background { background: #343600; }.cm-s-tomorrow-night-eighties .CodeMirror-matchingbracket { text-decoration: underline; color: white !important; }"}}),l={clearStyle:function(){var e,t,n,a=r.doc.getElementsByName(o.NAME.CODE_STYLE);for(n=a.length-1;n>=0;n--)e=a[n],t=e.id.replace(o.ID.CODE_STYLE+"-",""),r.doc.querySelector("."+o.CLASS.CODE_CONTAINER+"[data-theme="+t+"]")||i.removeStyleById(e.id);var l=r.doc.querySelectorAll("."+o.CLASS.CODE_CONTAINER);0===l.length&&i.removeStyleById(o.ID.CODE_STYLE)},initCommon:function(){i.replaceStyleById(o.ID.CODE_STYLE,a.common,!1),l.insertTemp()},insertCommon:function(){var e=r.doc.getElementById(o.ID.CODE_STYLE);e||i.replaceStyleById(o.ID.CODE_STYLE,a.common,!1)},insertTemp:function(){i.insertStyle({name:o.NAME.TMP_STYLE},a.tmp.common),(r.client.type.isPhone||r.client.type.isPad)&&i.insertStyle({name:o.NAME.TMP_STYLE},a.tmp.phone),r.readonly&&i.insertStyle({name:o.NAME.TMP_STYLE},a.tmp.reader)},insertTheme:function(e){a.theme[e]&&!r.doc.querySelector("#"+o.ID.CODE_STYLE+"-"+e)&&i.insertStyle({id:o.ID.CODE_STYLE+"-"+e,name:o.NAME.CODE_STYLE},a.theme[e])}};t.exports=l},{"../common/const":14,"../common/dependLoader":15,"../common/env":16,"../common/wizStyle":21,"../domUtils/domBase":24}],12:[function(e,t,n){"use strict";var r=e("../common/env"),o=e("../common/const"),i=e("../common/utils"),a=e("../common/historyUtils"),l=e("../domUtils/domExtend"),s=e("../domUtils/selectPlugin"),c=e("../rangeUtils/rangeExtend"),d=e("./codeStyle"),u={MODE:{APL:{cm:"text/apl",file:"apl",same:["apollo"]},C:{cm:"text/x-csrc",file:"clike",same:[]},"C++":{cm:"text/x-c++src",file:"clike",same:["cpp"]},"C#":{cm:"text/x-csharp",file:"clike",same:["cs"]},CSS:{cm:"text/css",file:"css",same:[]},Dart:{cm:"application/dart",file:["clike","dart"],same:[]},Erlang:{cm:"text/x-erlang",file:"erlang",same:[]},Go:{cm:"text/x-go",file:"go",same:[]},HTML:{cm:"text/html",file:[["xml","css","javascript","vbscript"],["htmlmixed"]],same:[]},Java:{cm:"text/x-java",file:"clike",same:[]},JavaScript:{cm:"text/javascript",file:"javascript",same:["js"]},JSX:{cm:"text/jsx",file:[["xml","javascript"],["jsx"]],same:[]},Lisp:{cm:"text/x-common-lisp",file:"commonlisp",same:[]},Lua:{cm:"text/x-lua",file:"lua",same:[]},"Octave (MATLAB)":{cm:"text/x-octave",file:"octave",same:["matlab","octave"]},"Objective-C":{cm:"text/x-objectivec",file:"clike",same:[]},Pascal:{cm:"text/x-pascal",file:"pascal",same:[]},Perl:{cm:"text/x-perl",file:"perl",same:[]},PHP:{cm:"application/x-httpd-php",file:"php",same:[]},Python:{cm:"text/x-python",file:"python",same:["py"]},Ruby:{cm:"text/x-ruby",file:"ruby",same:["rb"]},Shell:{cm:"text/x-sh",file:"shell",same:["sh"]},SQL:{cm:"text/x-sql",file:"sql",same:[]},Swift:{cm:"text/x-swift",file:"swift",same:[]},VBScript:{cm:"text/vbscript",file:"vbscript",same:["basic","vb"]},Verilog:{cm:"text/x-verilog",file:"verilog",same:[]},VHDL:{cm:"text/x-vhdl",file:"vhdl",same:[]},XML:{cm:"application/xml",file:"xml",same:[]},XSL:{cm:"application/xml",file:"xml",same:[]},YAML:{cm:"text/x-yaml",file:"yaml",same:[]}},THEME:{default:{name:"L1 (default)",same:["L1"]},"base16-light":{name:"L2 (base16-light)",same:["L2"]},eclipse:{name:"L3 (eclipse)",same:["L3"]},"base16-dark":{name:"D1 (base16-dark)",same:["D1"]},blackboard:{name:"D2 (blackboard)",same:["D2"]},material:{name:"D3 (material)",same:["D3"]},monokai:{name:"D4 (monokai)",same:["D4"]},"tomorrow-night-eighties":{name:"D5 (tomorrow)",same:["D5"]}}},f=[],g=[],m={},p={};!function(){var e,t,n;for(e in u.MODE)if(u.MODE.hasOwnProperty(e))for(f.push({text:e,value:e}),t=u.MODE[e].same,m[e.toLowerCase()]=e,n=0;n<t.length;n++)m[t[n].toLowerCase()]=e;for(e in u.THEME)if(u.THEME.hasOwnProperty(e))for(g.push({text:u.THEME[e].name,value:e}),t=u.THEME[e].same,p[e.toLowerCase()]=e,n=0;n<t.length;n++)p[t[n].toLowerCase()]=e}();var h={mode:"wiz-code-mode",theme:"wiz-code-theme"},b={canCreateCode:function(){var e=c.getRange();return!(!e||b.getContainerFromChild(e.startContainer)||l.getParentByClass(e.startContainer,o.CLASS.TABLE_CONTAINER,!0))},changeMode:function(e,t){if(e){var n=e.codeMirror;n&&(n.setOption("mode",u.MODE[t].cm),l.attr(e,{"data-mode":t}),r.win.localStorage&&!r.readonly&&r.win.localStorage.setItem(h.mode,t))}},changeTheme:function(e,t){if(e){t=t||"default";var n=e.codeMirror;n&&(d.insertTheme(t),n.setOption("theme",t),l.attr(e,{"data-theme":t}),r.win.localStorage&&!r.readonly&&r.win.localStorage.setItem(h.theme,t))}},clearCodeMirror:function(){var e,t,n,r=b.getContainerList();for(n=r.length-1;n>=0;n--)e=r[n],e.codeMirror&&(t=e.codeMirror,t.setOption("readOnly",!0),t.setOption("styleActiveLine",!1),t.getDoc().clearHistory())},fixCodeContainer:function(e){var t,n,o=e?[e]:b.getContainerList();for(n=o.length-1;n>=0;n--)t=o[n],t.removeAttribute("style"),t.removeAttribute("id"),t.removeAttribute("class"),b.fixCodeContainerParent(t),r.options.codeNoIDE?b.initCodeNoIDE(t):b.initCodeMirror(t)},fixCodeContainerParent:function(e){var t,n;t=l.getParentList(e),t.length>0&&(n=l.splitDomSingle(t[0],e),l.before(e,n),l.remove(n))},fixCode:function(e){if(!e)return null;var t=e.parentNode;return l.hasClass(t,o.CLASS.CODE_CONTAINER)?null:(t!==r.doc.body&&1===t.childNodes.length||(t=r.doc.createElement("div"),l.before(t,e),t.appendChild(e)),t)},focusToFirst:function(e){e.focus(),e.setCursor({line:0,ch:0})},focusToLast:function(e){e.focus(),e.setCursor({line:e.lastLine(),ch:e.getLineHandle(e.lastLine()).text.length})},getContainerFromChild:function(e){return l.getParentByClass(e,o.CLASS.CODE_CONTAINER,!0)},getToolsFromChild:function(e){return l.getParentByClass(e,o.CLASS.CODE_TOOLS,!0)},getContainerList:function(){return r.doc.querySelectorAll("."+o.CLASS.CODE_CONTAINER)},getCmMode:function(e){var t=(e.getAttribute("data-mode")||"").toLowerCase(),n="";return e.isNew&&r.win.localStorage&&!r.readonly&&(n=(r.win.localStorage.getItem(h.mode)||"").toLowerCase()),m[t]||m[n]||"JavaScript"},getCmTheme:function(e){var t=(e.getAttribute("data-theme")||"").toLowerCase(),n="";return e.isNew&&r.win.localStorage&&!r.readonly&&(n=(r.win.localStorage.getItem(h.theme)||"").toLowerCase()),p[t]||p[n]||"default"},getCmWrapper:function(e){return e.querySelector("."+o.CLASS.CODE_MIRROR)},initCodeNoIDE:function(e){if(e){b.removeCmWrapper(e);var t,n,o=e.querySelector("textarea"),i="";o&&(i=o.textContent,t=r.doc.createElement("pre"),n=r.doc.createElement("code"),t.appendChild(n),n.textContent=i,l.before(t,o),l.remove(o))}},removeCmWrapper:function(e){if(e.id){var t=r.doc.body.querySelector("."+o.CLASS.CODE_MIRROR+"[data-id="+e.id+"]");l.remove(t)}},initCodeMirror:function(e){if(e){d.insertCommon();var t,n,s,f,g,m,p;if(e.id||(e.id="wiz_cm_"+(new Date).valueOf()+"_"+Math.floor(1e4*Math.random())),l.addClass(e,o.CLASS.CODE_CONTAINER),l.attr(e,{contenteditable:"false"}),m=b.getCmMode(e),p=b.getCmTheme(e),e.codeMirror)return s=e.codeMirror,void(r.readonly?(s.setOption("matchBrackets",!1),s.setOption("readOnly",!r.client.type.isPhone&&!r.client.type.isPad||"nocursor"),s.setOption("styleActiveLine",!1),s.getDoc().clearHistory()):(s.setOption("matchBrackets",!0),s.setOption("readOnly",!1),s.setOption("styleActiveLine",!0)));for(b.removeCmWrapper(e);e.lastChild&&!l.isTag(e.lastChild,"textarea");)e.removeChild(e.lastChild);n=e.querySelector("textarea"),l.setTextarea(n,i.replaceSpecialChar(n.value)),t={fixedGutter:!1,indentUnit:4,lineWrapping:!0,scrollbarStyle:"null",lineNumbers:!0,matchBrackets:!r.readonly,mode:u.MODE[m].cm,extraKeys:{Tab:function(e){var t=Array(e.getOption("indentUnit")+1).join(" ");e.replaceSelection(t)},"Ctrl-Z":function(){a.undo()},"Cmd-Z":function(){a.undo()},"Ctrl-Y":function(){a.redo()},"Shift-Cmd-Z":function(){a.redo()},"Cmd-Y":function(){a.redo()}}},r.readonly?(t.readOnly=!r.client.type.isPhone&&!r.client.type.isPad||"nocursor",t.styleActiveLine=!1):(t.readOnly=!1,t.styleActiveLine=!0),s=CodeMirror.fromTextArea(n,t),e.codeMirror=s,e.mode=m,s.display.wrapper.setAttribute("data-id",e.id),f=e.querySelector("."+o.CLASS.CODE_MIRROR),g=r.doc.createElement(o.TAG.CODE_MIRROR),l.before(g,f),g.appendChild(f),b.changeMode(e,m),b.changeTheme(e,p);var h,C="";s.on("keydown",function(e,t){var n=t.keyCode||t.which;h=37===n||38===n?-1:39===n||40===n?1:0}),s.on("beforeSelectionChange",function(t,n){var o,i,t,a=n.ranges[0],s=a.anchor,d=a.head,u=[s.line,s.ch,d.line,d.ch].join(".");if("+move"===n.origin&&s.line==d.line&&s.ch==d.ch&&u===C)if(h===-1){for(o=l.getPreviousNode(e);o&&!l.isTag(o,"br")&&l.isEmptyDom(o);)o=l.getPreviousNode(o);o&&(i=b.getContainerFromChild(o),i?(t=i.codeMirror,b.focusToLast(t)):(r.doc.body.setAttribute("contenteditable",!0),c.setRange(o,l.getEndOffset(o))))}else if(1===h){for(o=l.getNextNode(e);o&&!l.isTag(o,"br")&&l.isEmptyDom(o);)o=l.getNextNode(o);o&&(i=b.getContainerFromChild(o),i?(t=i.codeMirror,b.focusToFirst(t)):(r.doc.body.setAttribute("contenteditable",!0),c.setRange(o,0)))}C=u}),s.on("beforeChange",function(t,n){"redo"!==n.origin&&"undo"!==n.origin&&a.saveSnap(!1,{type:o.HISTORY.TYPE.CODE_MIRROR,cmContainerId:e.id})}),s.on("change",function(e,t){/^(redo|undo|paste)$/i.test(t.origin)&&e.setSize()}),s.on("copy",function(e,t){(r.client.type.isPhone||r.client.type.isPad)&&r.readonly&&(t.codemirrorIgnore=!0)}),s.on("focus",function(e,t){var n=b.getContainerFromChild(e.display.wrapper);b.initTools(n)}),s.on("blur",function(e,t){});var E,v=e.querySelector(".CodeMirror-sizer");v&&(E=v.nextElementSibling,E&&(E.style.height="13px"))}},initTools:function(e){if(e&&!r.readonly&&!r.client.type.isPhone&&!r.client.type.isPad){var t,n,i=b.getCmWrapper(e),a=e.querySelector("."+o.CLASS.CODE_TOOLS),c=b.getCmMode(e),d=e.getAttribute("data-theme");a||(a=r.doc.createElement(o.TAG.TMP_TAG),t=s.create(f,o.CLASS.CODE_TOOLS_MODE,c),n=s.create(g,o.CLASS.CODE_TOOLS_THEME,d),a.appendChild(t),a.appendChild(n),l.addClass(t,o.CLASS.CODE_TOOLS_MODE),l.addClass(n,o.CLASS.CODE_TOOLS_THEME),l.addClass(a,o.CLASS.CODE_TOOLS)),i.appendChild(a)}},insertCodeSrc:function(e,t){var n=e.codeMirror;n&&n.replaceSelection(t,"end")},onKeyDown:function(e){var t=c.getRange(),n=r.doc.getSelection();if(!t||!t.collapsed)return!1;var o,i,s,d,u,f,g=e.keyCode||e.which,m=c.getRangeDetail(t.startContainer,t.startOffset),p=!1,h=!1,C=null,E=null,v=null;if(8===g&&0===m.offset&&(s=l.getPreviousNode(m.container,!1),v=b.getContainerFromChild(s)),46===g&&(l.isTag(m.container,"br")||m.offset===l.getEndOffset(m.container))&&(s=l.getNextNode(m.container,!1),v=b.getContainerFromChild(s),v&&l.isTag(m.container,"br")))return l.remove(m.container),b.focusToFirst(v.codeMirror),!0;if(v)return a.saveSnap(!1),l.remove(v),!0;switch(g){case 37:e.ctrlKey||e.metaKey||(u=!0,n.modify("move","backward","character")),d={x:-1,y:0};break;case 38:e.ctrlKey||e.metaKey||(u=!0,n.modify("move","backward","line")),d={x:0,y:-1};break;case 39:e.ctrlKey||e.metaKey||(u=!0,n.modify("move","forward","character")),d={x:1,y:0};break;case 40:e.ctrlKey||e.metaKey||(u=!0,n.modify("move","forward","line")),d={x:0,y:1}}if(u){if(t=c.getRange(),o=c.getRangeDetail(t.startContainer,t.startOffset),C=m.container,E=o.container,o.container===m.container&&o.offset!==m.offset||(o.container!==m.container?d.x>0||d.y>0?h=!0:p=!0:(d.x>0||d.y>0?h=!0:p=!0,E=r.doc.body)),h){for(i=l.getNextNode(C,!1,E);i&&i!==E&&!l.isTag(i,"br")&&l.isEmptyDom(i);)i=l.getNextNode(i,!1,E);i&&(i=l.getNextBlock(i))}else if(p){for(i=l.getPreviousNode(C,!1,E);i&&i!==E&&!l.isTag(i,"br")&&l.isEmptyDom(i);)i=l.getPreviousNode(i,!1,E);i&&(i=l.getPrevBlock(i))}i&&(v=b.getContainerFromChild(i),f=v&&v.codeMirror,f?(f.focus(),d.x>0||d.y>0?b.focusToFirst(f):b.focusToLast(f)):v=null),v||(d.x<0?n.modify("move","forward","character"):d.y<0?n.modify("move","forward","line"):d.x>0?n.modify("move","backward","character"):d.y>0&&n.modify("move","backward","line"))}return!!v},saveToText:function(){var e,t,n,r=b.getContainerList();for(n=r.length-1;n>=0;n--)e=r[n],t=e.codeMirror,t&&t.save()},pastePatch:{fix:function(){var e,t,n=r.doc.querySelectorAll("."+o.CLASS.CODE_CONTAINER_PASTE);for(e=n.length;e>=0;e--)t=n[e],l.removeClass(t,o.CLASS.CODE_CONTAINER_PASTE),b.fixCodeContainer(t)},ready:function(e,t){var n,i,a,s,c,d,u,f,g,m,p,h,C=e.querySelectorAll("."+o.CLASS.CODE_MIRROR);for(f=C.length-1;f>=0;f--){for(s=C[f],a=b.getContainerFromChild(s),a||(a=s),p=[],c=s.querySelectorAll("."+o.CLASS.CODE_MIRROR_LINE),g=0;g<c.length;g++)m=c[g],h=m.innerText||m.textContent,p.push(h.replace(o.FILL_CHAR_REG,""));n=r.doc.createElement("div"),t?n.innerHTML="<br/>"+p.join("<br/>")+"<br/><br/>":(d=a.getAttribute("data-mode"),u=a.getAttribute("data-theme"),i=r.doc.createElement("textarea"),i.textContent=p.join("\n"),l.addClass(n,o.CLASS.CODE_CONTAINER_PASTE),n.appendChild(i),d&&n.setAttribute("data-mode",d),u&&n.setAttribute("data-theme",u)),l.before(n,a),l.remove(a)}}},oldPatch:{oldCodeReady:function(){function e(e,t){var n,a,s,c,d,u;for(n=e.querySelectorAll(t),a=n.length-1;a>=0;a--)s=n[a],i.isEmpty(s.innerText)&&(d=l.getParentByClass(s,o.CLASS.CODE_CONTAINER_OLD,!1),d&&(c=l.splitDomSingle(d,s),u=r.doc.createElement("div"),u.appendChild(s),l.before(u,c),l.remove(c)))}var t,n,a;for(t=r.doc.querySelectorAll("."+o.CLASS.CODE_CONTAINER_OLD),a=t.length-1;a>=0;a--)n=t[a],e(n,"a");for(t=r.doc.querySelectorAll("."+o.CLASS.CODE_CONTAINER_OLD),a=t.length-1;a>=0;a--)n=t[a],e(n,"img")},fixOldCode:function(){var e,t,n,i,a,s,c,d=[];if(b.oldPatch.oldCodeReady(),e=r.doc.querySelectorAll("."+o.CLASS.CODE_CONTAINER_OLD),e.length>50)return d;for(c=e.length-1;c>=0;c--)t=e[c],i=b.fixCode(t),a=b.oldPatch.getSrc(t),n=b.oldPatch.getMode(t),i.removeChild(t),s=r.doc.createElement("textarea"),s.value=a,s.style.display="none",i.appendChild(s),l.addClass(i,o.CLASS.CODE_CONTAINER),n&&l.attr(i,{"data-mode":n}),d.push(i);return d},getMode:function(e){var t,n,r=/language-([\w]+)/i,o=/lang-([\w]+)/i,i=e.querySelector("code");return i&&i.className&&(t=i.className.match(r))?n=t[1]:e.className&&(t=e.className.match(o))&&(n=t[1]),n&&(n=m[n.toLowerCase()]),n},getSrc:function(e){if(!e)return"";var t,n,r,o=e.querySelectorAll("code");for(n=0,r=o.length;n<r;n++)t=o[n],t.innerText||(t.innerText="\n");return(e.innerText||e.textContent||"").replace(/\n$/,"")}},highlight:{clear:function(e){var t=e.codeMirror;if(t){var n=e.state;n||(n={},e.state=n),t.operation(function(){n.lastQuery=n.query||null,n.query&&(n.query=n.queryText=null,t.removeOverlay(n.overlay))})}},clearAll:function(){var e,t,n=b.getContainerList();for(e=0;e<n.length;e++)t=n[e],b.highlight.clear(t)},overlay:function(e){return e=new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"gi"),{token:function(t){e.lastIndex=t.pos;var n=e.exec(t.string);return n&&n.index===t.pos?(t.pos+=n[0].length||1,"searching"):void(n?t.pos=n.index:t.skipToEnd())}}},search:function(e,t){if(!e.state||!e.state.query||e.state.query.toLowerCase()!==t.toLowerCase()){var n=e.codeMirror;if(n){b.highlight.clear(e);var r=e.state;t=t.toLowerCase(),r.query=t,n.removeOverlay(r.overlay),r.overlay=b.highlight.overlay(r.query),n.addOverlay(r.overlay)}}}}};t.exports=b},{"../common/const":14,"../common/env":16,"../common/historyUtils":17,"../common/utils":20,"../domUtils/domExtend":25,"../domUtils/selectPlugin":26,"../rangeUtils/rangeExtend":39,"./codeStyle":11}],13:[function(e,t,n){"use strict";var r,o={},i=o.Base64,a="2.1.8";"undefined"!=typeof t&&t.exports&&(r=e("buffer").Buffer);var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=function(e){for(var t={},n=0,r=e.length;n<r;n++)t[e.charAt(n)]=n;return t}(l),c=String.fromCharCode,d=function(e){if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?c(192|t>>>6)+c(128|63&t):c(224|t>>>12&15)+c(128|t>>>6&63)+c(128|63&t)}var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return c(240|t>>>18&7)+c(128|t>>>12&63)+c(128|t>>>6&63)+c(128|63&t)},u=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,f=function(e){return e.replace(u,d)},g=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0),r=[l.charAt(n>>>18),l.charAt(n>>>12&63),t>=2?"=":l.charAt(n>>>6&63),t>=1?"=":l.charAt(63&n)];return r.join("")},m=o.btoa?function(e){return o.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,g)},p=r?function(e){return(e.constructor===r.constructor?e:new r(e)).toString("base64")}:function(e){return m(f(e))},h=function(e,t){return t?p(String(e)).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):p(String(e))},b=function(e){return h(e,!0)},C=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),E=function(e){switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),n=t-65536;return c((n>>>10)+55296)+c((1023&n)+56320);case 3:return c((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return c((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},v=function(e){return e.replace(C,E)},y=function(e){var t=e.length,n=t%4,r=(t>0?s[e.charAt(0)]<<18:0)|(t>1?s[e.charAt(1)]<<12:0)|(t>2?s[e.charAt(2)]<<6:0)|(t>3?s[e.charAt(3)]:0),o=[c(r>>>16),c(r>>>8&255),c(255&r)];return o.length-=[0,0,2,1][n],o.join("")},T=o.atob?function(e){return o.atob(e)}:function(e){return e.replace(/[\s\S]{1,4}/g,y)},S=r?function(e){return(e.constructor===r.constructor?e:new r(e,"base64")).toString()}:function(e){return v(T(e))},A=function(e){return S(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},x=function(){var e=o.Base64;return o.Base64=i,e};if(o.Base64={VERSION:a,atob:T,btoa:m,fromBase64:A,toBase64:h,utob:f,encode:h,encodeURI:b,btou:v,decode:A,noConflict:x},"function"==typeof Object.defineProperty){var O=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};o.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",O(function(){return A(this)})),Object.defineProperty(String.prototype,"toBase64",O(function(e){return h(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",O(function(){return h(this,!0)}))}}t.exports=o.Base64},{buffer:2}],14:[function(e,t,n){"use strict";var r="​",o={AMEND_TIME_SPACE:18e4,AMEND_BATCH_TIME_SPACE:3e4,COMPOSITION_START:!1,FILL_CHAR:r,FILL_CHAR_REG:new RegExp(r,"ig"),AMEND:{INFO_SPACE:0,INFO_TIMER:300},ATTR:{IMG:"data-wiz-img",IMG_MASK:"data-wiz-img-mask",IMG_RATE:"data-wiz-img-rate",IMG_EDITING:"data-wiz-img-editing",SPAN:"data-wiz-span",SPAN_USERID:"data-wiz-user-id",SPAN_INSERT:"data-wiz-insert",SPAN_DELETE:"data-wiz-delete",SPAN_PASTE:"data-wiz-paste",SPAN_PASTE_TYPE:"data-wiz-paste-type",SPAN_PASTE_ID:"data-wiz-paste-id",SPAN_TIMESTAMP:"data-wiz-amend-time",TODO_ID:"wiz_todo_id",TODO_CHECK:"data-wiz-check"},CLASS:{BLOCK_SCROLL:"wiz-block-scroll",CODE_CONTAINER:"wiz-code-container",CODE_CONTAINER_PASTE:"wiz-code-container-paste",CODE_CONTAINER_OLD:"prettyprint",CODE_MIRROR:"CodeMirror",CODE_MIRROR_LINE:"CodeMirror-line",CODE_MIRROR_MEASURE:"CodeMirror-measure",CODE_MIRROR_GUTTER:"CodeMirror-gutter-wrapper",CODE_MIRROR_HSCROLL:"CodeMirror-scroll",CODE_TOOLS:"wiz-code-tools",CODE_TOOLS_MODE:"wiz-code-tools-mode",CODE_TOOLS_THEME:"wiz-code-tools-theme",IMG_ATTACHMENT:"wiz-img-attachment",IMG_NOT_DRAG:"wiz-img-cannot-drag",IMG_RESIZE_ACTIVE:"wiz-img-resize-active",IMG_RESIZE_CONTAINER:"wiz-img-resize-container",IMG_RESIZE_HANDLE:"wiz-img-resize-handle",ORDER_LIST_LEVEL:["wiz-list-level3","wiz-list-level1","wiz-list-level2"],SELECTED_CELL:"wiz-selected-cell",SELECTED_CELL_MULTI:"wiz-selected-cell-multi",SELECT_PLUGIN_CONTAINER:"wiz-select-plugin-container",SELECT_PLUGIN_HEADER:"wiz-select-plugin-header",SELECT_PLUGIN_HEADER_TEXT:"wiz-select-plugin-header-text",SELECT_PLUGIN_OPTIONS:"wiz-select-plugin-options",SELECT_PLUGIN_OPTIONS_ITEM:"wiz-select-plugin-options-item",TABLE_CONTAINER:"wiz-table-container",TABLE_TOOLS:"wiz-table-tools",TABLE_BODY:"wiz-table-body",TABLE_MENU_BUTTON:"wiz-table-menu-button",TABLE_MENU_ITEM:"wiz-table-menu-item",TABLE_MENU_SUB:"wiz-table-menu-sub",TABLE_MOVING:"wiz-table-moving",TODO_ACCOUNT:"wiz-todo-account",TODO_AVATAR:"wiz-todo-avatar",TODO_CHECKBOX:"wiz-todo-checkbox",TODO_CHECK_IMG_OLD:"wiz-todo-img",TODO_DATE:"wiz-todo-dt",TODO_LAYER:"wiz-todo-layer",TODO_MAIN:"wiz-todo-main",TODO_LABEL_OLD:"wiz-todo-label",TODO_CHECKED:"wiz-todo-checked",TODO_UNCHECKED:"wiz-todo-unchecked",TODO_CHECKED_OLD:"wiz-todo-label-checked",TODO_UNCHECKED_OLD:"wiz-todo-label-unchecked",TODO_TAIL_OLD:"wiz-todo-tail",TODO_USER_AVATAR:"wiz-todo-avatar-",TODO_USER_INFO:"wiz-todo-completed-info"},CLIENT_EVENT:{WizEditorPaste:"wizEditorPaste",WizEditorClickImg:"wizEditorClickImg",WizReaderClickImg:"wizReaderClickImg",WizMarkdownRender:"wizMarkdownRender",WizEditorTrackEvent:"wizEditorTrackEvent"},COLOR:["#CB3C3C","#0C9460","#FF3399","#FF6005","#8058BD","#009999","#8AA725","#339900","#CC6600","#3BBABA","#D4CA1A","#2389B0","#006699","#FF8300","#2C6ED5","#FF0000","#B07CFF","#CC3399","#EB4847","#3917E6"],CSS:{IMG:{SPAN:{position:"relative",display:"inline-block"},MASK:{position:"absolute",width:"100% !important",height:"100% !important",top:"0",left:"0",opacity:".5",filter:"alpha(opacity=50)",border:"2px solid","box-sizing":"border-box","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box"}},IMG_DELETED:{background:"#fdc6c6 url(data:image/gif;base64,R0lGODlhDwAPAIABAIcUFP///yH5BAEKAAEALAAAAAAPAA8AAAIajI8IybadHjxyhjox1I0zH1mU6JCXCSpmUAAAOw==)","border-color":"#E47070"},IMG_INSERT:{background:"#ccffcc","border-color":"#00AA00"},TODO_LIST:{IMG_WIDTH:40},Z_INDEX:{amendInfo:150,tableBorder:105,tableColRowLine:120,tableRangeDot:110,tableTDBefore:100,tableTools:130,tableToolsArrow:10}},EVENT:{BEFORE_GET_DOCHTML:"BEFORE_GET_DOCHTML",BEFORE_SAVESNAP:"BEFORE_SAVESNAP",AFTER_INSERT_DOM:"AFTER_INSERT_DOM",AFTER_RESTORE_HISTORY:"AFTER_RESTORE_HISTORY",EXEC_COMMEND:"EXEC_COMMEND",ON_DBLCLICK:"ON_DBLCLICK",ON_CLICK:"ON_CLICK",ON_COMPOSITION_START:"ON_COMPOSITION_START",ON_COMPOSITION_END:"ON_COMPOSITION_END",ON_COPY:"ON_COPY",ON_CUT:"ON_CUT",ON_DOM_SUBTREE_MODIFIED:"ON_DOM_SUBTREE_MODIFIED",ON_DRAG_START:"ON_DRAG_START",ON_DRAG_ENTER:"ON_DRAG_ENTER",ON_DROP:"ON_DROP",ON_EXEC_COMMAND:"ON_EXEC_COMMAND",ON_KEY_DOWN:"ON_KEY_DOWN",ON_KEY_UP:"ON_KEY_UP",ON_MOUSE_DOWN:"ON_MOUSE_DOWN",ON_MOUSE_MOVE:"ON_MOUSE_MOVE",ON_MOUSE_OVER:"ON_MOUSE_OVER",ON_MOUSE_UP:"ON_MOUSE_UP",ON_ORIENTATION_CHANGE:"ON_ORIENTATION_CHANGE",ON_PASTE:"ON_PASTE",ON_SCROLL:"ON_SCROLL",ON_SELECT_PLUGIN_CHANGE:"ON_SELECT_PLUGIN_CHANGE",ON_SELECTION_CHANGE:"ON_SELECTION_CHANGE",ON_SELECT_START:"ON_SELECT_START",ON_TOUCH_START:"ON_TOUCH_START",ON_TOUCH_END:"ON_TOUCH_END",UPDATE_RENDER:"UPDATE_RENDER"},HISTORY:{TYPE:{CODE_MIRROR:"CODE_MIRROR",COMMON:"COMMON"}},ID:{AMEND_INFO:"wiz-amend-info",AMEND_INFO_SINGLE:"wiz-amend-info-single",AMEND_INFO_MULTI:"wiz-amend-info-multi",AMEND_INFO_NAME:"wiz-amend-info-name",AMEND_INFO_IMG:"wiz-amend-info-image",AMEND_INFO_CONTENT:"wiz-amend-info-content",AMEND_INFO_TIME:"wiz-amend-info-time",AMEND_INFO_TOOLS:"wiz-amend-info-tools",AMEND_INFO_ACCEPT:"wiz-amend-info-accept",AMEND_INFO_REFUSE:"wiz-amend-info-refuse",AMEND_USER_INFO:"wiz-amend-user",CODE_STYLE:"wiz_code_style",FORMAT_PAINTER_STYLE:"wiz_format_painter_style",IFRAME_FOR_SAVE:"wiz-iframe-for-save",TABLE_RANGE_BORDER:"wiz-table-range-border",TABLE_ROW_LINE:"wiz-table-row-line",TABLE_COL_LINE:"wiz-table-col-line",TODO_STYLE:"wiz_todo_style",TODO_STYLE_OLD:"wiz_todo_style_id",TODO_AVATAR_STYLE:"wiz_todo_style_avatar_",WIZ_DEFAULT_STYLE:"wiz_custom_css"},NAME:{CODE_STYLE:"wiz_code_style",STYLE_FOR_LOAD:"wiz_style_for_load",TMP_STYLE:"wiz_tmp_editor_style",UNSAVE_STYLE:"wiz_unsave_style"},NOTE_TYPE:{COMMON:"common",MARKDOWN:"markdown",MATHJAX:"mathjax"},TAG:{CODE_MIRROR:"wiz_code_mirror",TMP_TAG:"wiz_tmp_tag",TMP_PLUGIN_TAG:"wiz_tmp_plugin_tag",TMP_HIGHLIGHT_TAG:"wiz_tmp_highlight_tag"},TYPE:{IMG_DELETE:"delete",IMG_INSERT:"insert",PASTE:{START:"start",END:"end",CONTENT:"content"},POS:{upLeft:"up-left",downLeft:"down-left",leftUp:"left-up",rightUp:"right-up",upRight:"up-right",downRight:"down-right",leftDown:"left-down",rightDown:"right-down"},TABLE:{COPY:"copy",PASTE:"paste",CLEAR_CELL:"clearCell",MERGE_CELL:"mergeCell",SPLIT_CELL:"splitCell",INSERT_ROW_UP:"insertRowUp",INSERT_ROW_DOWN:"insertRowDown",INSERT_COL_LEFT:"insertColLeft",INSERT_COL_RIGHT:"insertColRight",DELETE_ROW:"deleteRow",DELETE_COL:"deleteCol",SET_CELL_BG:"setCellBg",SET_CELL_ALIGN:"setCellAlign",DISTRIBUTE_COLS:"distributeCols",DELETE_TABLE:"deleteTable"},TODO:"tasklist"}};t.exports=o},{}],15:[function(e,t,n){"use strict";function r(e,t,n){a.load(e,t,n)}function o(e,t,n){var o=0,i=t.length,a=function a(){o<i?r(e,t[o++],a):n&&n()};return a}var i=e("./utils"),a=e("./scriptLoader"),l={getDependencyFiles:function(e,t,n){var r,o,i,a,l,s,c,d=[];for(r=0,o=e[t][n].length;r<o;r++)if(i=e[t][n][r],"css"==t)d.push(e.files[t][i]);else{
for(c=[],a=0,l=i.length;a<l;a++)s=i[a],c.push(e.files[t][s]);d.push(c)}return d},loadJs:function(e,t,n){var r=o(e,t,n);r()},loadCss:function(e,t){var n,r;for(n=0,r=t.length;n<r;n++)i.loadSingleCss(e,t[n])}};t.exports=l},{"./scriptLoader":19,"./utils":20}],16:[function(e,t,n){"use strict";var r=e("./const"),o=e("./lang"),i=e("./base64"),a=o.initLang,l={},s="wiznotecmd://",c={options:{document:null,autoFocus:!0,lang:"en",clientType:"",noteType:"common",userInfo:null,usersData:[],userNameEncoder:"",dependencyUrl:"",indexFilesPath:"",indexFilesFullPath:"",maxRedo:100,noAmend:!1,codeNoIDE:!1,table:{colWidth:120,colWidthMin:30,rowHeightMin:33},timeout:{markdown:3e4,mathJax:3e4},callback:{markdown:null,mathJax:null,redo:null},pc:{pluginModified:!1}},init:function(e,t){function n(e,t){if(t){var r;for(r in e)e.hasOwnProperty(r)&&"undefined"!=typeof t[r]&&(/^(table|timeout|callback)$/.test(r)?n(e[r],t[r]):e[r]=t[r])}}n(c.options,t);var r,o,l=c.options.document||window.document;c.doc=l,c.win=c.doc.defaultView,a(c.options.lang),c.client.setType(c.options.clientType);var s,d=c.doc.body.className.split(" ");for(r=d.length-1;r>=0;r--)s=d[r],s&&!/^wiz-/gi.test(s)||d.splice(r,1);c.doc.body.className=d.join(" ");var u=decodeURIComponent(location.pathname),f=u.lastIndexOf("/")+1,g=u.lastIndexOf(".");if(c.options.indexFilesPath=u.substring(f,g)+"_files",c.options.indexFilesFullPath=location.protocol+"//"+u.substr(0,f)+c.options.indexFilesPath+"/","base64"===c.options.userNameEncoder&&(o=c.options.userInfo,o&&o.user_name&&(o.user_name=i.decode(o.user_name)),c.options.userData))for(r=0;r<c.options.usersData.length;r++)o=c.options.usersData[r],o.user_name=i.decode(o.user_name)},win:null,doc:null,readonly:null,dependency:{files:{css:{fonts:"{dependencyUrl}/fonts.css",github2:"{dependencyUrl}/github2.css",wizToc:"{dependencyUrl}/wizToc.css"},cursor:{formatPainter:"{dependencyUrl}/format-painter-wiz.cur"},js:{codemirror:"{dependencyUrl}/codemirror/codemirror.js",cmActiveLine:"{dependencyUrl}/codemirror/addon/selection/active-line.js",cmMatchBrackets:"{dependencyUrl}/codemirror/addon/edit/matchbrackets.js",cmMode:"{dependencyUrl}/codemirror/mode/mode.js",flowchart:"{dependencyUrl}/flowchart.js",jquery:"{dependencyUrl}/jquery-1.11.3.js",mathJax:"{dependencyUrl}/mathjax/MathJax.js?config=TeX-AMS-MML_SVG",prettify:"{dependencyUrl}/prettify.js",raphael:"{dependencyUrl}/raphael.js",sequence:"{dependencyUrl}/sequence-diagram.js",underscore:"{dependencyUrl}/underscore.js"},init:function(){function e(e){var n;for(n in e)e.hasOwnProperty(n)&&(e[n]=e[n].replace("{dependencyUrl}",t))}var t=c.options.dependencyUrl.replace(/\\/g,"/");e(c.dependency.files.css),e(c.dependency.files.cursor),e(c.dependency.files.js)}},css:{fonts:["fonts"],markdown:["github2","wizToc"]},js:{codeMirror:[["codemirror"],["cmActiveLine","cmMatchBrackets","cmMode"]],markdown:[["jquery"],["prettify","raphael","underscore"],["flowchart","sequence"]],mathJax:[["jquery"],["mathJax"]]}},client:{type:{isWeb:function(){return location&&0===location.protocol.indexOf("http")}(),isWin:!1,isMac:!1,isLinux:!1,isIOS:!1,isAndroid:!1,isPad:!1,isPhone:!1},sendCmdToWiznote:function(){},setType:function(e){if(e){if(e=e.toLowerCase(),e.indexOf("windows")>-1)c.client.type.isWin=!0,c.client.sendCmdToWiznote=function(e,t){e==r.CLIENT_EVENT.WizReaderClickImg&&c.win.external.OnClickedImage(t.src,JSON.stringify(t.imgList))};else if(e.indexOf("ios")>-1)c.client.type.isIOS=!0,c.client.sendCmdToWiznote=function(e,t){var n;e==r.CLIENT_EVENT.WizReaderClickImg&&delete t.imgList,n=s+e;var o,i=[];if(t){for(o in t)t.hasOwnProperty(o)&&i.push(o+"="+encodeURIComponent(t[o]));n+="?"+i.join("&")}var a=c.doc.createElement(r.TAG.TMP_TAG),l=c.doc.createElement("iframe");l.setAttribute("src",n),a.style.display="none",a.appendChild(l),c.doc.body.appendChild(a),a.parentNode.removeChild(a),l=null,a=null};else if(e.indexOf("android")>-1)c.client.type.isAndroid=!0,c.client.sendCmdToWiznote=function(e,t){e==r.CLIENT_EVENT.WizReaderClickImg?c.win.WizNote.onClickImg(t.src,t.imgList.join(",")):e==r.CLIENT_EVENT.WizEditorClickImg&&c.win.WizNote.onEditorClickImage(t.src)};else if(e.indexOf("mac")>-1){var t=c.win.navigator.userAgent;/Mac/i.test(t)||(c.client.type.isLinux=!0),c.client.type.isMac=!0,c.client.sendCmdToWiznote=function(e,t){e==r.CLIENT_EVENT.WizReaderClickImg&&c.win.WizExplorerApp.onClickedImage(t.src,JSON.stringify(t.imgList))}}(c.client.type.isIOS||c.client.type.isAndroid)&&(e.indexOf("pad")>-1?c.client.type.isPad=!0:c.client.type.isPhone=!0)}}},event:{add:function(e,t){function n(e,t){if(!e||!t)return!1;var n,r,o=l[e];if(!o||0===o.length)return!1;for(n=0,r=o.length;n<r;n++)if(o[n]===t)return!0;return!1}if(e&&t&&!n(e,t)){var r=l[e];r||(r=[]),r.push(t),l[e]=r}},call:function(e){var t,n,r=[],o=l[e];if(o&&0!==o.length){for(t=1,n=arguments.length;t<n;t++)r.push(arguments[t]);for(t=0,n=o.length;t<n;t++)o[t].apply(this,r)}},remove:function(e,t){if(e&&t){var n,r,o=l[e];if(o&&0!==o.length)for(n=0,r=o.length;n<r;n++)o[n]===t&&o.splice(n,1)}}}};t.exports=c},{"./base64":13,"./const":14,"./lang":18}],17:[function(e,t,n){"use strict";function r(e){var t=null,n=a.doc.querySelector("#"+e);return n&&n.codeMirror&&(t=n.codeMirror),t}function o(){return a.doc.querySelectorAll("."+l.CLASS.CODE_CONTAINER)}function i(){var e,t,n,r=o();for(n=r.length-1;n>=0;n--)e=r[n],t=e.codeMirror,t&&(f[e.id]=t.getDoc().copy(!0))}var a=e("./env"),l=e("./const"),s=e("./utils"),c=e("./../domUtils/domExtend"),d=e("./../rangeUtils/rangeExtend"),u=100,f={},g={enable:!1,callback:null,stack:[],stackIndex:0,init:function(){g.stack=[],g.stackIndex=0},start:function(e,t){e&&e>0&&(u=e),g.enable=!0,g.init(),m.bind(),t&&(g.callback=t)},stop:function(){g.enable=!1,g.init(),m.unbind()},applyCallback:function(){var e;g.callback&&(e=g.getUndoState(),g.callback(e))},getCodeMirrorDoc:function(e){var t=f[e]||null;return t&&(t=t.copy(!0)),t},getUndoState:function(){return{undoCount:g.stack.length,undoIndex:g.stackIndex}},undo:function(){if(!g.enable||g.stackIndex<=0||0===g.stack.length)return void(g.stackIndex=0);g.stackIndex>=g.stack.length&&g.saveSnap(!0);var e=g.stack[--g.stackIndex];e.nextChange.type===l.HISTORY.TYPE.CODE_MIRROR?g.restoreCodeMirror("undo",e):(i(),g.restoreSnap(e.snap)),a.event.call(l.EVENT.AFTER_RESTORE_HISTORY,{type:e.nextChange.type}),g.applyCallback(),e.type===l.HISTORY.TYPE.COMMON&&c.focus()},redo:function(){if(g.enable&&!(g.stackIndex>=g.stack.length-1)){var e=g.stack[++g.stackIndex];e.type===l.HISTORY.TYPE.CODE_MIRROR?g.restoreCodeMirror("redo",e):(i(),g.restoreSnap(e.snap)),a.event.call(l.EVENT.AFTER_RESTORE_HISTORY,{type:e.type}),g.applyCallback(),e.type===l.HISTORY.TYPE.COMMON&&c.focus()}},saveSnap:function(e,t){if(g.enable&&(!l.COMPOSITION_START||t&&t.type!==l.HISTORY.TYPE.COMMON)){a.event.call(l.EVENT.BEFORE_SAVESNAP);var n={type:l.HISTORY.TYPE.COMMON};t&&t.type===l.HISTORY.TYPE.CODE_MIRROR&&(n.type=l.HISTORY.TYPE.CODE_MIRROR,n.cmContainerId=t.cmContainerId);var o,i,s,c,d,f,m,p={nextChange:n};if(d=g.stackIndex>0?g.stack[g.stackIndex-1]:null,d&&d.nextChange.type==l.HISTORY.TYPE.CODE_MIRROR){if(c=d.cmContainerId,s=d.nextChange.cmContainerId,p.type=l.HISTORY.TYPE.CODE_MIRROR,p.cmContainerId=s,i=r(s)){if(g.stackIndex>=0&&g.stack.splice(g.stackIndex,g.stack.length-g.stackIndex),p.nextChange.type===l.HISTORY.TYPE.COMMON&&(p.snap=g.snapshot()),p.cmHistory=i.historySize(),c===s&&d.cmHistory.undo===p.cmHistory.undo&&d.cmHistory.redo===p.cmHistory.redo)return d.nextChange=p.nextChange,p.snap&&(d.snap=p.snap),void(e&&g.stackIndex--);g.stack.push(p),e||g.stackIndex++}}else p.type=l.HISTORY.TYPE.COMMON,o={add:!0,replace:!1,direct:0},f=g.snapshot(),!e&&d&&d.type==l.HISTORY.TYPE.COMMON&&(o=g.canSave(f,d.snap)),(o.add||o.replace)&&(f.direct=o.direct,g.stackIndex>=0&&g.stack.splice(g.stackIndex,g.stack.length-g.stackIndex),o.add?(p.snap=f,g.stack.push(p),e||g.stackIndex++):o.replace&&(m=d.snap,f.focus.startOffset=m.focus.startOffset,d.snap=f));g.stack.length>u&&(g.stack.shift(),g.stackIndex--),g.applyCallback()}},restoreCodeMirror:function(e,t){if(g.enable&&t){var n,o;n="undo"==e?t.nextChange.cmContainerId:t.cmContainerId,o=r(n),o&&("redo"===e?o.redo():o.undo())}},restoreSnap:function(e){if(g.enable&&e){var t,n,r;t=a.doc.getSelection(),a.doc.body.innerHTML=e.content;try{n=c.getFromIndexList(e.focus.start),t.collapse(n.dom,n.offset),e.focus.isCollapsed?d.setRange(n.dom,n.offset,n.dom,n.offset):(r=c.getFromIndexList(e.focus.end),d.setRange(n.dom,n.offset,r.dom,r.offset)),d.caretFocus()}catch(e){}}},canSave:function(e,t){function n(e,t){if(e.isCollapsed!=t.isCollapsed)return 0;if(e.start.length!=t.start.length||e.end.length!=t.end.length)return 0;var n=r(e.start,t.start);return n<1?n:n=r(e.end,t.end)}function r(e,t){var n,r,o=1;for(n=0,r=e.length-1;n<r;n++)if(e[n]!=t[n]){o=0;break}return o&&e[r]<t[r]&&(o=-1),o}var o={add:!1,replace:!1,direct:0};return(e.content.length!=t.content.length||e.content.localeCompare(t.content))&&(o.direct=n(e.focus,t.focus),0===o.direct||o.direct!==t.direct||!/^\s*$/g.test(e.focus.lastChar+t.focus.lastChar)&&/\s/.test(t.focus.lastChar)||Math.abs(e.focus.startOffset-t.focus.startOffset)>20?o.add=!0:o.replace=!0),o},snapshot:function(){var e=a.doc.getSelection(),t=a.doc.body.innerHTML,n={isCollapsed:!0,start:[],end:[],lastChar:null,startOffset:-1},r={content:t,focus:n};if(0===e.rangeCount)return n.start.push(0),r;var o=e.getRangeAt(0);return n.start=c.getIndexList(o.startContainer),n.start.push(o.startOffset),n.isCollapsed=e.isCollapsed,e.isCollapsed?3===o.startContainer.nodeType&&o.startOffset>0&&(n.lastChar=o.startContainer.nodeValue.charAt(o.startOffset-1),n.startOffset=o.startOffset):(n.end=c.getIndexList(o.endContainer),n.end.push(o.endOffset)),r}},m={bind:function(){m.unbind(),a.event.add(l.EVENT.ON_KEY_DOWN,m.onKeyDown)},unbind:function(){a.event.remove(l.EVENT.ON_KEY_DOWN,m.onKeyDown)},onKeyDown:function(e){var t=e.keyCode||e.which;return e.ctrlKey&&90==t||e.metaKey&&90==t&&!e.shiftKey?(g.undo(),void s.stopEvent(e)):void((e.ctrlKey&&89==t||e.metaKey&&89==t||e.metaKey&&90==t&&e.shiftKey)&&(g.redo(),s.stopEvent(e)))}};t.exports=g},{"./../domUtils/domExtend":25,"./../rangeUtils/rangeExtend":39,"./const":14,"./env":16,"./utils":20}],18:[function(e,t,n){"use strict";function r(e){e||(e="en"),e=e.toLowerCase().replace("_","-"),o[e]?i=e:e="en";var t;for(t in o[e])o[e].hasOwnProperty(t)&&(a[t]=o[e][t])}var o={},i="en",a={};o.en={version:"en",Month:["Jan.","Feb.","Mar.","Apr.","May","June","July","Agu.","Sep.","Oct.","Nov.","Dec."],Amend:{Edit:"Inserted contents",Delete:"Deleted contents",BtnAccept:"Accept",BtnRefuse:"Reject",Accept:"Accept all changes? Or partially select the changes which need to be accepted.",Refuse:"Reject all changes? Or partially select the changes which need to be rejected.",MultiInfo:"Multiple changes are selected",UserNameDefault:"someone"},Table:{Copy:"Copy",Paste:"Paste",ClearCell:"Clear",MergeCell:"Merge Cells",SplitCell:"Unmerge Cells",InsertRowUp:"Add Row Above",InsertRowDown:"Add Row Below",InsertColLeft:"Add Column Before",InsertColRight:"Add Column After",DeleteRow:"Delete Row",DeleteCol:"Delete Column",SetCellBg:"Color Fill",CellAlign:"Arrange",DeleteTable:"Delete Table",DistributeCols:"Average Column Width"},Err:{Copy_Null:"Copy of deleted changes not allowed",Cut_Null:"Cut of deleted changes not allowed"}},o["zh-cn"]={version:"zh-cn",Date:{Year:"年",Month:"月",Day:"日"},Amend:{Edit:"插入了内容",Delete:"删除了内容",BtnAccept:"接受修订",BtnRefuse:"拒绝修订",Accept:"是否确认接受全部修订内容？ 如需接受部分内容请使用鼠标进行选择",Refuse:"是否确认拒绝全部修订内容？ 如需拒绝部分内容请使用鼠标进行选择",MultiInfo:"您选中了多处修订",UserNameDefault:"有人"},Table:{Copy:"复制",Paste:"粘贴",ClearCell:"清空单元格",MergeCell:"合并单元格",SplitCell:"拆分单元格",InsertRowUp:"上插入行",InsertRowDown:"下插入行",InsertColLeft:"左插入列",InsertColRight:"右插入列",DeleteRow:"删除当前行",DeleteCol:"删除当前列",SetCellBg:"单元格底色",CellAlign:"单元格对齐方式",DeleteTable:"删除表格",DistributeCols:"平均分配各列"},Err:{Copy_Null:"无法复制已删除的内容",Cut_Null:"无法剪切已删除的内容"}},o["zh-tw"]={version:"zh-tw",Date:{Year:"年",Month:"月",Day:"日"},Amend:{Edit:"插入了內容",Delete:"刪除了內容",BtnAccept:"接受修訂",BtnRefuse:"拒絕修訂",Accept:"是否確認接受全部修訂內容？ 如需接受部分內容請使用滑鼠進行選擇",Refuse:"是否確認拒絕全部修訂內容？ 如需拒絕部分內容請使用滑鼠進行選擇",MultiInfo:"您選中了多處修訂",UserNameDefault:"有人"},Table:{Copy:"複製",Paste:"粘貼",ClearCell:"清空儲存格",MergeCell:"合併儲存格",SplitCell:"拆分儲存格",InsertRowUp:"上插入行",InsertRowDown:"下插入行",InsertColLeft:"左插入列",InsertColRight:"右插入列",DeleteRow:"刪除當前行",DeleteCol:"刪除當前列",SetCellBg:"儲存格底色",CellAlign:"儲存格對齊方式",DeleteTable:"刪除表格",DistributeCols:"平均分配各列"},Err:{Copy_Null:"無法複製已刪除的內容",Cut_Null:"無法剪切已刪除的內容"}},t.exports.getLang=function(){return a},t.exports.initLang=function(e){r(e)}},{}],19:[function(e,t,n){"use strict";function r(e,t){return l[e]||(l[e]=0),l[e]++,function(){l[e]--,0===l[e]&&(l[e]=null,t&&t())}}function o(e){return"wiz_js_"+e}function i(e){if(e){var t={version:e.version,jsStr:e.jsStr};localStorage.setItem(e.id,JSON.stringify(t))}}var a={appendJsCode:function(e,t,n){var r=e.createElement("script");r.type=n,r.text=t,e.getElementsByTagName("head")[0].appendChild(r)},load:function(e,t,n){if(e&&t){var a,l,s,c,d=(new Date).valueOf(),u=!0;for(a=0,l=t.length;a<l;a++)if("string"==typeof t[a])s=this.loadSingleJs(e,t[a]),s!==!0&&(s.onload=r(d,n),u=!1);else{var f=t[a].link,g=o(t[a].id),m=t[a].version;if(window.localStorage){var p=JSON.parse(localStorage.getItem(g));p&&p.version==m?(s=this.inject(e,p.jsStr,g),s!==!0&&(c=r(d,n),setTimeout(function(){c()},10),u=!1)):(u=!1,c=r(d,n),$.ajax({url:f,context:{id:g,version:m},success:function(t){i({id:this.id,version:this.version,jsStr:t}),s=wizUI.scriptLoader.inject(e,t,this.id),s!==!0&&setTimeout(function(){c()},10)},error:function(){c()}}))}else s=this.loadSingleJs(e,t[a].link),s!==!0&&(s.onload=r(d,n),u=!1)}u&&n()}},loadSingleJs:function(e,t){var n="wiz_"+t;if(e.getElementById(n))return!0;var r=e.createElement("script");return r.type="text/javascript",r.setAttribute("charset","utf-8"),r.src=t.replace(/\\/g,"/"),r.id=n,e.getElementsByTagName("head")[0].insertBefore(r,null),r},inject:function(e,t,n){if(!e||e.getElementById(n))return!0;var r=e.createElement("script");return r.type="text/javascript",r.id=n,r.text=t,e.getElementsByTagName("head")[0].insertBefore(r,null),r}},l={};t.exports=a},{}],20:[function(e,t,n){"use strict";var r=e("./const");try{"abc".localeCompare("abcd")}catch(e){String.prototype.localeCompare=function(e){return this.toString()==e?0:this.toString()>e?1:-1}}var o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;"wiz".trim||(String.prototype.trim=function(){return this.replace(o,"")});var i=/[\-\[\]{}()*+?.,\\\^$|#\s]/g;try{"abc".escapeRegex("abcd")}catch(e){String.prototype.escapeRegex=function(){return this.toString().replace(i,"\\$&")}}Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1});var a={checkNonTxtKey:function(e){var t=e.keyCode||e.which;return!(!e.ctrlKey&&!e.metaKey)||!(t>=48&&t<=57||t>=65&&t<=90||t>=96&&t<=107||t>=109&&t<=111||t>=186&&t<=192||t>=219&&t<=222||229==t||0===t||13==t||32==t)},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isEmpty:function(e){if(!e)return!0;var t=/\r?\n/gi,n=new RegExp("[\r\n"+r.FILL_CHAR+"]","ig"),o=t.test(e),i=e.replace(n,""),a=0===e.replace(n,"").trim().length;return 0===i.length||o&&a},isSameAmendTime:function(e,t){if(!e||!t)return!1;var n=a.getDateForTimeStr(e),o=a.getDateForTimeStr(t);return Math.abs(n-o)<=r.AMEND_BATCH_TIME_SPACE},checkChar:function(e,t){var n,r,o,i;for(n=0,r=t.length;n<r;n++){if(o=t[n][0],i=t[n].length>1?t[n][1]:null,null===i&&e==o)return!0;if(null!==i&&e>=o&&e<=i)return!0}return!1},compareVersion:function(e,t){e=e.split("."),t=t.split(".");var n,r,o,i;for(n=0,r=e.length;n<r;n++){if(o=parseInt(e[n],10),i=t[n]?parseInt(t[n],10):-1,o<i)return-1;if(o>i)return 1}return e.length<t.length?-1:0},isCJK:function(e){var t=[[12352,12687],[13056,13183],[13312,15661],[19968,40959],[63744,64255],[44032,55215]];return a.checkChar(e,t)},isSpace:function(e){var t=[[9,13],[32],[160]];return a.checkChar(e,t)},isAlpha:function(e){var t=[[48,57],[65,90],[97,122],[192,214],[216,246],[248,256]];return a.checkChar(e,t)},getWordCount:function(e){var t={nWords:0,nChars:0,nCharsWithSpace:0,nNonAsianWords:0,nAsianChars:0};if(!e)return t;var n,r,o,i=!1,l=!1;for(t.nCharsWithSpace=e.length,t.nChars=t.nCharsWithSpace,n=0,r=e.length;n<r;n++)o=e.charCodeAt(n),i=!1,a.isCJK(o)?t.nAsianChars++:a.isSpace(o)?t.nChars--:a.isAlpha(o)&&(i=!0),i&&!l?l=!0:i||(l&&t.nNonAsianWords++,l=!1);return i&&l&&t.nNonAsianWords++,t.nWords=t.nNonAsianWords+t.nAsianChars,t},getEventClientPos:function(e){return{x:e.changedTouches?e.changedTouches[0].clientX:e.clientX,y:e.changedTouches?e.changedTouches[0].clientY:e.clientY}},getHash:function(e){var t,n,r=1315423911;for(t=e.length-1;t>=0;t--)n=e.charCodeAt(t),r^=(r<<5)+n+(r>>2);return 2147483647&r},getTime:function(){function e(e){var t=e.toString();return 1==t.length?"0"+t:t}var t=new Date;return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+" "+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())},getDateForTimeStr:function(e){return new Date(Date.parse(e.replace(/-/g,"/")))},listToMap:function(e){if(!e)return{};e=a.isArray(e)?e:e.split(",");var t,n,r,o={};for(t=0,n=e.length;t<n;t++)r=e[t],o[r.toUpperCase()]=o[r]=1;return o},rgb2Hex:function(e){function t(e,t){return e+Math.floor((255-e)*(1-t))}function n(e){var t=e.toString(16);return 1===t.length?"0"+t:t}if(!e)return"";var r=e.replace(/.*\((.*)\)/gi,"$1").split(",");if(r.length<3)return"";var o=parseInt(r[0],10),i=parseInt(r[1],10),a=parseInt(r[2],10),l=4===r.length?parseFloat(r[3]):1;return 0===l?"":"#"+n(t(o,l))+n(t(i,l))+n(t(a,l))},removeDup:function(e){var t,n,r,o=[];for(t=0,n=e.length;t<n;t++)r=e[t],o.indexOf(r)<0&&o.push(r);return o},replaceSpecialChar:function(e){return e=e.replace(new RegExp(String.fromCharCode(160),"g")," ").replace(String.fromCharCode(65279),"")},stopEvent:function(e){e&&(e.stopPropagation(),e.preventDefault())},WizEditorTmpName:"wiz_tmp_editor_style",loadSingleCss:function(e,t){var n="wiz_"+t;if(e.getElementById(n))return!0;var r=e.createElement("link");return r.rel="stylesheet",r.setAttribute("charset","utf-8"),r.setAttribute("name",this.WizEditorTmpName),r.href=t.replace(/\\/g,"/"),e.getElementsByTagName("head")[0].insertBefore(r,null),r},appendCssCode:function(e,t,n){var r=e.createElement("style");r.type=n,r.text=t,r.setAttribute("name",this.WizEditorTmpName),e.getElementsByTagName("head")[0].appendChild(r)},getInnerText:function(e){var t="",n=function(e){return e?e.replace(/ +/gm," ").replace(/[\t]+/gm,"").replace(/[ ]+$/gm,"").replace(/^[ ]+/gm,"").replace(/\n+/gm,"\n").replace(/\n+$/,"").replace(/^\n+/,"").replace(/NEWLINE/gm,"\n"):""},r=function(e){var t=function(e){return!/[^\t\n\r ]/.test(e.nodeValue)},n=[],r=function e(r){for(var o=0;o<r.childNodes.length;o++){var i=r.childNodes[o];3==i.nodeType&&t(i)?n.push(i):i.hasChildNodes()&&e(i)}};r(e);for(var o=0;o<n.length;o++)n[o].parentNode.removeChild(n[o])},o=function(e,t){if(e.style[t])return e.style[t];var n=e.currentStyle||e.ownerDocument.defaultView.getComputedStyle(e,null);return"SCRIPT"==e.tagName?"none":n[t]?"block"==n[t]&&"TD"==e.tagName?"feaux-inline":n[t]:"LI,P,TR".indexOf(e.tagName)>-1?"block":e.style[t]},i="table-row,block,list-item",a=function(e){var t=o(e,"display")||"feaux-inline";return i.indexOf(t)>-1},l=function e(n){if(/pre/.test(o(n,"whiteSpace")))return t+=n.innerHTML.replace(/\t/g," "),"";var r=o(n,"display");if("none"==r)return"";var i=a(n)?"\n":" ";t+=i;for(var l=0;l<n.childNodes.length;l++){var s=n.childNodes[l];3==s.nodeType&&(t+=s.nodeValue),s.childNodes.length&&e(s)}return t+=i},s=e.cloneNode(!0);return s.innerHTML=s.innerHTML.replace(/<br[\/]?>/gi,"NEWLINE"),r(s),n(l(s))},markdownPreProcess:function(e){var t=$(e);t.find(".wiz-table-container").each(function(e){var t=$(this),n=$("<span></span>");n.text(t[0].outerHTML),n.insertAfter(t);var r=$("<br/>");r.insertAfter(t),t.remove()}),t.find("label.wiz-todo-label").each(function(e){var t=$(this),n=$(".wiz-todo-img",this);if(0!==n.length){var r=$("<span></span>");r.text(t[0].outerHTML),r.insertAfter(t),t.remove()}}),t.find(".wiz-todo-layer").each(function(e){var t=$(this),n=$(".wiz-todo-checkbox",this);if(0!==n.length){var r=$("<span></span>");r.text(t[0].outerHTML),r.insertAfter(t),t.remove()}}),t.find("a").each(function(e,t){var n=$(t),r=n.attr("href");if(r&&/^(wiz|wiznote):/.test(r)){var o=$("<span></span>");o.text(n[0].outerHTML),o.insertAfter(n),n.remove()}}),t.find("img").each(function(e){var t=$(this),n=$("<span></span>");n.text(t[0].outerHTML),n.insertAfter(t),t.remove()}),t.find("p").each(function(){var e=$(this);e.replaceWith($("<div>"+this.innerHTML+"</div>"))})}};t.exports=a},{"./const":14}],21:[function(e,t,n){"use strict";var r=e("./env"),o=e("./const"),i=e("../domUtils/domBase"),a={iosPhone:"body {overflow-y:scroll;-webkit-overflow-scrolling: touch;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}body[contenteditable=true], .wiz-template-editable {padding-bottom: 44px !important;}td,th {position:static;}th:before,td:before,th:after,td:after {display:none;}",iosPad:"body {min-width: 90%;max-width: 100%;min-height: 100%;background: #ffffff;overflow-y:scroll;-webkit-overflow-scrolling: touch;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}body[contenteditable=true], .wiz-template-editable {padding-bottom: 44px !important;}td,th {position:static;}th:before,td:before,th:after,td:after {display:none;}",imageResize:".wiz-img-resize-handle {position: absolute;z-index: 1000;border: 1px solid black;background-color: white;}.wiz-img-resize-handle {width:5px;height:5px;}.wiz-img-resize-handle.lt {cursor: nw-resize;}.wiz-img-resize-handle.tm {cursor: n-resize;}.wiz-img-resize-handle.rt {cursor: ne-resize;}.wiz-img-resize-handle.lm {cursor: w-resize;}.wiz-img-resize-handle.rm {cursor: e-resize;}.wiz-img-resize-handle.lb {cursor: sw-resize;}.wiz-img-resize-handle.bm {cursor: s-resize;}.wiz-img-resize-handle.rb {cursor: se-resize;}",selectPlugin:".wiz-select-plugin-container {position:relative;display:inline-block;width:160px;height:28px;border-radius:4px;padding:0;margin-left:5px;cursor:pointer;}.wiz-select-plugin-container, .wiz-select-plugin-options {box-sizing:border-box;background:white;border:1px solid #e7e7e7;color:#333;box-shadow: 1px 1px 5px #d0d0d0;}.wiz-select-plugin-options {display:none;}.wiz-select-plugin-header {line-height:28px;font-size:14px;padding: 0 0 0 5px;overflow:hidden;margin-right:27px;white-space:nowrap;}.wiz-select-plugin-header i {position:absolute;top:0;right:0;line-height:26px;padding:0 6px;border-left:1px solid #e7e7e7;box-sizing:border-box;}.wiz-select-plugin-options {background:white;list-style:none;padding:0px;white-space:nowrap;max-height:200px;min-width:160px;max-width:260px;overflow-x:hidden;overflow-y:auto;position:absolute;top:30px;right:-1px;}.wiz-select-plugin-options:hover .wiz-select-plugin-options-item.selected {background:white;color:inherit;}.wiz-select-plugin-options-item {font-size:11px;padding:0 5px;height:20px;line-height:20px;}.wiz-select-plugin-options-item.selected {background:#448aff;color:white;}.wiz-select-plugin-options-item:hover {background:#448aff !important;color:white !important;}.wiz-select-plugin-container.active .wiz-select-plugin-options {display:block;}",table:"."+o.CLASS.TABLE_BODY+"."+o.CLASS.TABLE_MOVING+" *, ."+o.CLASS.TABLE_BODY+"."+o.CLASS.TABLE_MOVING+" *:before, ."+o.CLASS.TABLE_BODY+"."+o.CLASS.TABLE_MOVING+" *:after {cursor:default !important;}td,th {position:relative;}#wiz-table-range-border {display: none;width: 0;height: 0;position: absolute;top: 0;left: 0; z-index:"+o.CSS.Z_INDEX.tableBorder+"}#wiz-table-col-line, #wiz-table-row-line {display: none;background-color: #448aff;position: absolute;z-index:"+o.CSS.Z_INDEX.tableColRowLine+";}#wiz-table-col-line {width: 1px;cursor:col-resize;}#wiz-table-row-line {height: 1px;cursor:row-resize;}#wiz-table-range-border_start, #wiz-table-range-border_range {display: none;width: 0;height: 0;position: absolute;}#wiz-table-range-border_start_top, #wiz-table-range-border_range_top {height: 2px;background-color: #448aff;position: absolute;top: 0;left: 0;}#wiz-table-range-border_range_top {height: 1px;}#wiz-table-range-border_start_right, #wiz-table-range-border_range_right {width: 2px;background-color: #448aff;position: absolute;top: 0;}#wiz-table-range-border_range_right {width: 1px;}#wiz-table-range-border_start_bottom, #wiz-table-range-border_range_bottom {height: 2px;background-color: #448aff;position: absolute;top: 0;}#wiz-table-range-border_range_bottom {height: 1px;}#wiz-table-range-border_start_left, #wiz-table-range-border_range_left {width: 2px;background-color: #448aff;position: absolute;top: 0;left: 0;}#wiz-table-range-border_range_left {width: 1px;}#wiz-table-range-border_start_dot, #wiz-table-range-border_range_dot {width: 5px;height: 5px;border: 2px solid rgb(255, 255, 255);background-color: #448aff;cursor: crosshair;position: absolute;z-index:"+o.CSS.Z_INDEX.tableRangeDot+";}.wiz-table-tools {display: block;background-color:#fff;position: absolute;left: 0px;border: 1px solid #ddd;-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px;z-index:"+o.CSS.Z_INDEX.tableTools+';}.wiz-table-tools ul {list-style: none;padding: 0;width:auto;}.wiz-table-tools .wiz-table-menu-item {position: relative;float: left;margin:5px 2px 5px 8px;clear: initial;}.wiz-table-tools .wiz-table-menu-item .wiz-table-menu-button {font-size:15px;width:20px;height:20px;line-height:20px;cursor: pointer;position:relative;}.wiz-table-tools i.editor-icon{font-size: 15px;color: #455a64;}.wiz-table-tools .wiz-table-menu-item .wiz-table-menu-button i#wiz-menu-bg-demo{position: absolute;top:1px;left:0;}.wiz-table-tools .wiz-table-menu-sub {position: absolute;display: none;width: 125px;padding: 5px 0;background: #fff;border-radius: 3px;border: 1px solid #E0E0E0;top:28px;left:-9px;box-shadow: 1px 1px 5px #d0d0d0;}.wiz-table-tools .wiz-table-menu-sub > div{font-size:15px;}.wiz-table-tools .wiz-table-menu-item.active .wiz-table-menu-sub {display: block}.wiz-table-tools .wiz-table-menu-sub:before, .wiz-table-tools .wiz-table-menu-sub:after {position: absolute;content: " ";border-style: solid;border-color: transparent;border-bottom-color: #cccccc;left: 22px;margin-left: -14px;top: -8px;border-width: 0 8px 8px 8px;z-index:'+o.CSS.Z_INDEX.tableToolsArrow+';}.wiz-table-tools .wiz-table-menu-sub:after {border-bottom-color: #ffffff;top: -7px;}.wiz-table-tools .wiz-table-menu-sub-item {padding: 4px 12px;font-size: 14px;}.wiz-table-tools .wiz-table-menu-sub-item.split {border-top: 1px solid #E0E0E0;}.wiz-table-tools .wiz-table-menu-sub-item:hover {background-color: #ececec;}.wiz-table-tools .wiz-table-menu-sub-item.disabled {color: #bbbbbb;cursor: default;}.wiz-table-tools .wiz-table-menu-sub-item.disabled:hover {background-color: transparent;}.wiz-table-tools .wiz-table-menu-item.wiz-table-cell-bg:hover .wiz-table-color-pad {display: block;}.wiz-table-tools .wiz-table-color-pad {display: none;padding: 10px;box-sizing: border-box;width: 85px;height: 88px;background-color: #fff;cursor: default;}.wiz-table-tools .wiz-table-color-pad > div{font-size:15px;}.wiz-table-tools .wiz-table-color-pad .wiz-table-color-pad-item {display: inline-block;width: 15px;height: 15px;margin-right: 9px;position: relative;}.wiz-table-tools .wiz-table-color-pad .wiz-table-color-pad-item i.pad-demo {position: absolute;top:3px;left:0;}.wiz-table-tools .wiz-table-color-pad .wiz-table-color-pad-item .icon-oblique_line{color: #cc0000;}.wiz-table-tools .wiz-table-color-pad .wiz-table-color-pad-item:last-child {margin-right: 0;}.wiz-table-tools .wiz-table-color-pad .wiz-table-color-pad-item.active i.editor-icon.icon-box {color: #448aff;}.wiz-table-tools .wiz-table-cell-align {display: none;padding: 10px;box-sizing: border-box;width: 85px;height: 65px;background-color: #fff;cursor: default;}.wiz-table-tools .wiz-table-cell-align .wiz-table-cell-align-item {display: inline-block;width: 15px;height: 15px;margin-right: 9px;position: relative;}.wiz-table-tools .wiz-table-cell-align .wiz-table-cell-align-item:last-child {margin-right:0}.wiz-table-tools .wiz-table-cell-align .wiz-table-cell-align-item i.valign{position: absolute;top:3px;left:0;color: #d2d2d2;}.wiz-table-tools .wiz-table-cell-align-item.active i.editor-icon.valign {color: #a1c4ff;}.wiz-table-tools .wiz-table-cell-align-item.active i.editor-icon.icon-box,.wiz-table-tools .wiz-table-cell-align-item.active i.editor-icon.align {color: #448aff;}.wiz-table-tools .wiz-table-color-pad .wiz-table-color-pad-item:last-child,.wiz-table-tools .wiz-table-cell-align .wiz-table-cell-align-item:last-child {margin-right: 0;}th.wiz-selected-cell-multi, td.wiz-selected-cell-multi {background: rgba(0,102,255,.05);}th:before,td:before,#wiz-table-col-line:before,#wiz-table-range-border_start_right:before,#wiz-table-range-border_range_right:before{content: " ";position: absolute;top: 0;bottom: 0;right: -5px;width: 9px;cursor: col-resize;background: transparent;z-index:'+o.CSS.Z_INDEX.tableTDBefore+';}th:after,td:after,#wiz-table-row-line:before,#wiz-table-range-border_start_bottom:before,#wiz-table-range-border_range_bottom:before{content: " ";position: absolute;left: 0;right: 0;bottom: -5px;height: 9px;cursor: row-resize;background: transparent;z-index:'+o.CSS.Z_INDEX.tableTDBefore+";}"},l={ios:"img {max-width: 100%;height: auto !important;margin: 0px auto;cursor: pointer;}"},s={body:"html {height:100%;} body {min-height:100%;box-sizing:border-box;word-wrap: break-word !important;}a {word-wrap: break-word;}img::selection {background-color: rgba(0, 0, 255, 0.3);}",blockScroll:".wiz-block-scroll::-webkit-scrollbar {width: 7px;height: 7px;}.wiz-block-scroll::-webkit-scrollbar-thumb {background-color: #7f7f7f;border-radius: 7px;}.wiz-block-scroll::-webkit-scrollbar-button {display: none;}",table:"."+o.CLASS.TABLE_CONTAINER+" {border:0px !important;}."+o.CLASS.TABLE_BODY+" {border:0px !important;position:relative;margin:10px 0;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;}."+o.CLASS.TABLE_BODY+" table {margin:0;outline:none;}td,th {outline:none;}"},c='Helvetica, "Hiragino Sans GB", "微软雅黑", "Microsoft YaHei UI", SimSun, SimHei, arial, sans-serif;',d={common:"html, body {font-size: 12pt;}body {font-family: "+c+"line-height: 1.6;margin: 0 auto;padding: 20px 16px;padding: 1.25rem 1rem;}h1, h2, h3, h4, h5, h6 {margin:20px 0 10px;margin:1.25rem 0 0.625rem;padding: 0;font-weight: bold;}h1 {font-size:20pt;font-size:1.67rem;}h2 {font-size:18pt;font-size:1.5rem;}h3 {font-size:15pt;font-size:1.25rem;}h4 {font-size:14pt;font-size:1.17rem;}h5 {font-size:12pt;font-size:1rem;}h6 {font-size:12pt;font-size:1rem;color: #777777;margin: 1rem 0;}div, p, ul, ol, dl, li {margin:0;}blockquote, table, pre, code {margin:8px 0;}ul, ol {padding-left:32px;padding-left:2rem;}ol.wiz-list-level1 > li {list-style-type:decimal;}ol.wiz-list-level2 > li {list-style-type:lower-latin;}ol.wiz-list-level3 > li {list-style-type:lower-roman;}blockquote {padding:0 12px;padding:0 0.75rem;}blockquote > :first-child {margin-top:0;}blockquote > :last-child {margin-bottom:0;}img {border:0;max-width:100%;height:auto !important;margin:2px 0;}table {border-collapse:collapse;border:1px solid #bbbbbb;}td, th {padding:4px 8px;border-collapse:collapse;border:1px solid #bbbbbb;min-height:28px;word-break:break-all;box-sizing: border-box;}.wiz-hide {display:none !important;}"},u={insertDefaultStyle:function(e,t){if(u.replaceStyleById(o.ID.WIZ_DEFAULT_STYLE,d.common,e),t){var n,r,i=!1;if("string"==typeof t)n=t,i=!0;else{n="html, body{";for(r in t)t.hasOwnProperty(r)&&(n+="font-family"===r.toLowerCase()?r+":"+t[r]+","+c+";":r+":"+t[r]+";",i=!0);n+="}"}i&&u.insertStyle({name:o.NAME.TMP_STYLE},n)}},insertCustomStyle:function(e,t,n){if(e&&t){var r={id:e};n&&(r.name=o.NAME.TMP_STYLE),u.insertStyle(r,t)}},insertStyle:function(e,t){var n=r.doc.createElement("style");return e.name&&n.setAttribute("name",e.name),e.id&&(n.setAttribute("id",e.id),
u.removeStyleById(e.id)),r.doc.getElementsByTagName("HEAD")[0].insertBefore(n,null),n.innerHTML=t,n},insertTmpEditorStyle:function(){u.insertStyle({name:o.NAME.TMP_STYLE},s.body+s.table+a.imageResize+a.selectPlugin+a.table),r.client.type.isIOS&&r.client.type.isPhone?u.insertStyle({name:o.NAME.TMP_STYLE},a.iosPhone):r.client.type.isIOS&&r.client.type.isPad&&u.insertStyle({name:o.NAME.TMP_STYLE},a.iosPad),r.client.type.isMac&&u.insertStyle({name:o.NAME.TMP_STYLE},s.blockScroll)},insertTmpReaderStyle:function(){u.insertStyle({name:o.NAME.TMP_STYLE},s.body+s.table+s.code+l.code),r.client.type.isIOS&&u.insertStyle({name:o.NAME.TMP_STYLE},l.ios),r.client.type.isMac&&u.insertStyle({name:o.NAME.TMP_STYLE},s.blockScroll)},removeFormat:function(e,t,n){function a(e){return!!e&&1===e.nodeType&&(i.isTag(e,[o.TAG.TMP_TAG,o.TAG.TMP_PLUGIN_TAG])||e.getAttribute("name")===o.NAME.TMP_STYLE||/^wiz[_-]/i.test(e.id)||/(^| )wiz[_-]/i.test(e.className))}function l(e){if(e&&!i.hasClass(e,o.CLASS.CODE_CONTAINER)){a(e)||(e.removeAttribute("style"),e.style.cssText&&(e.style.cssText=""));var t=e.children;if(t)for(var n=0;n<t.length;n++)1===t[n].nodeType&&l(t[n])}}function s(e){if(e&&!i.hasClass(e,o.CLASS.CODE_CONTAINER)){a(e)||i.attr(e,{class:null});var t=e.children;if(t)for(var n=0;n<t.length;n++)1===t[n].nodeType&&s(t[n])}}var c,d,u,f,g,m;try{if(e&&r.doc.execCommand("SelectAll"),t&&r.doc.execCommand("RemoveFormat"),e&&(d=r.doc.documentElement,d&&n&&(s(d),l(d))),n){for(u=r.doc.getElementsByTagName("link"),c=u.length-1;c>=0;c--)f=u[c],"stylesheet"!==f.getAttribute("rel")||a(f)||f.remove();for(g=r.doc.getElementsByTagName("style"),c=g.length-1;c>=0;c--)m=g[c],a(m)||m.remove()}}catch(e){return void console.error(e)}},removeStyleById:function(e){var t=r.doc.getElementById(e);t&&i.isTag(t,["style","link"])&&i.remove(t)},removeStyleByName:function(e){var t,n,o=r.doc.getElementsByName(e);for(t=o.length-1;t>=0;t--)n=o[t],n&&i.isTag(n,["style","link"])&&i.remove(n)},replaceStyleById:function(e,t,n){n=!!n;var o=r.doc.getElementById(e);o||n||(o=r.doc.createElement("style"),o.id=e,r.doc.getElementsByTagName("HEAD")[0].insertBefore(o,null)),o&&(o.innerHTML=t)}};t.exports=u},{"../domUtils/domBase":24,"./const":14,"./env":16}],22:[function(e,t,n){"use strict";var r=e("../common/env"),o={ClickAcceptFromAmendInfo:"ClickAcceptFromAmendInfo",ClickRefuseFromAmendInfo:"ClickRefuseFromAmendInfo"},i={save:function(e){if(r.client.type.isWin)try{external&&external.LogAction&&external.LogAction(e)}catch(e){console.error(e.toString())}}},a={ActionId:o,save:i.save};t.exports=a},{"../common/env":16}],23:[function(e,t,n){"use strict";!function e(t,n,r){function o(a,l){if(!n[a]){if(!t[a]){var s="function"==typeof _require&&_require;if(!l&&s)return s(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[a]={exports:{}};t[a][0].call(d.exports,function(e){var n=t[a][1][e];return o(n?n:e)},d,d.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof _require&&_require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){function r(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]}}function o(e,t,n){}function i(e,t,n){}function a(e,t,n){}function l(e,t,n){}function s(e){return e.replace(x,"&lt;").replace(O,"&gt;")}function c(e,t,n,r){if(n=p(n),"href"===t||"src"===t){if(n=S.trim(n),"#"===n)return"#";if("http://"!==n.substr(0,7)&&"https://"!==n.substr(0,8)&&"mailto:"!==n.substr(0,7)&&"#"!==n[0]&&"/"!==n[0])return""}else if("background"===t){if(R.lastIndex=0,R.test(n))return""}else if("style"===t){if(I.lastIndex=0,I.test(n))return"";if(k.lastIndex=0,k.test(n)&&(R.lastIndex=0,R.test(n)))return"";r!==!1&&(r=r||A,n=r.process(n))}return n=h(n)}function d(e){return e.replace(_,"&quot;")}function u(e){return e.replace(N,'"')}function f(e){return e.replace(w,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))})}function g(e){return e.replace(D,":").replace(L," ")}function m(e){for(var t="",n=0,r=e.length;n<r;n++)t+=e.charCodeAt(n)<32?" ":e.charAt(n);return S.trim(t)}function p(e){return e=u(e),e=f(e),e=g(e),e=m(e)}function h(e){return e=d(e),e=s(e)}function b(){return""}function C(e,t){function n(t){return!!r||S.indexOf(e,t)!==-1}"function"!=typeof t&&(t=function(){});var r=!Array.isArray(e),o=[],i=!1;return{onIgnoreTag:function(e,r,a){if(n(e)){if(a.isClosing){var l="[/removed]",s=a.position+l.length;return o.push([i!==!1?i:a.position,s]),i=!1,l}return i||(i=a.position),"[removed]"}return t(e,r,a)},remove:function(e){var t="",n=0;return S.forEach(o,function(r){t+=e.slice(n,r[0]),n=r[1]}),t+=e.slice(n)}}}function E(e){return e.replace(M,"")}function v(e){var t=e.split("");return t=t.filter(function(e){var t=e.charCodeAt(0);return 127!==t&&(!(t<=31)||(10===t||13===t))}),t.join("")}var y=e("cssfilter").FilterCSS,T=e("cssfilter").getDefaultWhiteList,S=e("./util"),A=new y,x=/</g,O=/>/g,_=/"/g,N=/&quot;/g,w=/&#([a-zA-Z0-9]*);?/gim,D=/&colon;?/gim,L=/&newline;?/gim,R=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,I=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,k=/u\s*r\s*l\s*\(.*/gi,M=/<!--[\s\S]*?-->/g;n.whiteList=r(),n.getDefaultWhiteList=r,n.onTag=o,n.onIgnoreTag=i,n.onTagAttr=a,n.onIgnoreTagAttr=l,n.safeAttrValue=c,n.escapeHtml=s,n.escapeQuote=d,n.unescapeQuote=u,n.escapeHtmlEntities=f,n.escapeDangerHtml5Entities=g,n.clearNonPrintableCharacter=m,n.friendlyAttrValue=p,n.escapeAttrValue=h,n.onIgnoreTagStripAll=b,n.StripTagBody=C,n.stripCommentTag=E,n.stripBlankChar=v,n.cssFilter=A,n.getDefaultCSSWhiteList=T},{"./util":4,cssfilter:8}],2:[function(e,t,n){function r(e,t){var n=new a(t);return n.process(e)}var o=e("./default"),i=e("./parser"),a=e("./xss");n=t.exports=r,n.FilterXSS=a;for(var l in o)n[l]=o[l];for(var l in i)n[l]=i[l];"undefined"!=typeof window&&(window.filterXSS=t.exports)},{"./default":1,"./parser":3,"./xss":5}],3:[function(e,t,n){function r(e){var t=e.indexOf(" ");if(t===-1)var n=e.slice(1,-1);else var n=e.slice(1,t+1);return n=u.trim(n).toLowerCase(),"/"===n.slice(0,1)&&(n=n.slice(1)),"/"===n.slice(-1)&&(n=n.slice(0,-1)),n}function o(e){return"</"===e.slice(0,2)}function i(e,t,n){"user strict";var i="",a=0,l=!1,s=!1,c=0,d=e.length,u="",f="";for(c=0;c<d;c++){var g=e.charAt(c);if(l===!1){if("<"===g){l=c;continue}}else if(s===!1){if("<"===g){i+=n(e.slice(a,c)),l=c,a=c;continue}if(">"===g){i+=n(e.slice(a,l)),u=e.slice(l,c+1),f=r(u),i+=t(l,i.length,f,u,o(u)),a=c+1,l=!1;continue}if(('"'===g||"'"===g)&&"="===e.charAt(c-1)){s=g;continue}}else if(g===s){s=!1;continue}}return a<e.length&&(i+=n(e.substr(a))),i}function a(e,t){"user strict";function n(e,n){if(e=u.trim(e),e=e.replace(f,"").toLowerCase(),!(e.length<1)){var r=t(e,n||"");r&&o.push(r)}}for(var r=0,o=[],i=!1,a=e.length,c=0;c<a;c++){var g,m,p=e.charAt(c);if(i!==!1||"="!==p)if(i===!1||c!==r||'"'!==p&&"'"!==p||"="!==e.charAt(c-1))if(/\s|\n|\t/.test(p)){if(i===!1){if(m=l(e,c),m===-1){g=u.trim(e.slice(r,c)),n(g),i=!1,r=c+1;continue}c=m-1;continue}if(m=s(e,c-1),m===-1){g=u.trim(e.slice(r,c)),g=d(g),n(i,g),i=!1,r=c+1;continue}}else;else{if(m=e.indexOf(p,c+1),m===-1)break;g=u.trim(e.slice(r+1,m)),n(i,g),i=!1,c=m,r=c+1}else i=e.slice(r,c),r=c+1}return r<e.length&&(i===!1?n(e.slice(r)):n(i,d(u.trim(e.slice(r))))),u.trim(o.join(" "))}function l(e,t){for(;t<e.length;t++){var n=e[t];if(" "!==n)return"="===n?t:-1}}function s(e,t){for(;t>0;t--){var n=e[t];if(" "!==n)return"="===n?t:-1}}function c(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]}function d(e){return c(e)?e.substr(1,e.length-2):e}var u=e("./util"),f=/[^a-zA-Z0-9_:\.\-]/gim;n.parseTag=i,n.parseAttr=a},{"./util":4}],4:[function(e,t,n){t.exports={indexOf:function(e,t){var n,r;if(Array.prototype.indexOf)return e.indexOf(t);for(n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},forEach:function(e,t,n){var r,o;if(Array.prototype.forEach)return e.forEach(t,n);for(r=0,o=e.length;r<o;r++)t.call(n,e[r],r,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")}}},{}],5:[function(e,t,n){function r(e){return void 0===e||null===e}function o(e){var t=e.indexOf(" ");if(t===-1)return{html:"",closing:"/"===e[e.length-2]};e=f.trim(e.slice(t+1,-1));var n="/"===e[e.length-1];return n&&(e=f.trim(e.slice(0,-1))),{html:e,closing:n}}function i(e){var t={};for(var n in e)t[n]=e[n];return t}function a(e){e=i(e||{}),e.stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=s.onIgnoreTagStripAll),e.whiteList=e.whiteList||s.whiteList,e.onTag=e.onTag||s.onTag,e.onTagAttr=e.onTagAttr||s.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||s.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||s.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||s.safeAttrValue,e.escapeHtml=e.escapeHtml||s.escapeHtml,this.options=e,e.css===!1?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new l(e.css))}var l=e("cssfilter").FilterCSS,s=e("./default"),c=e("./parser"),d=c.parseTag,u=c.parseAttr,f=e("./util");a.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,n=t.options,i=n.whiteList,a=n.onTag,l=n.onIgnoreTag,c=n.onTagAttr,g=n.onIgnoreTagAttr,m=n.safeAttrValue,p=n.escapeHtml,h=t.cssFilter;n.stripBlankChar&&(e=s.stripBlankChar(e)),n.allowCommentTag||(e=s.stripCommentTag(e));var b=!1;if(n.stripIgnoreTagBody){var b=s.StripTagBody(n.stripIgnoreTagBody,l);l=b.onIgnoreTag}var C=d(e,function(e,t,n,s,d){var b={sourcePosition:e,position:t,isClosing:d,isWhite:n in i},C=a(n,s,b);if(!r(C))return C;if(b.isWhite){if(b.isClosing)return"</"+n+">";var E=o(s),v=i[n],y=u(E.html,function(e,t){var o=f.indexOf(v,e)!==-1,i=c(n,e,t,o);if(!r(i))return i;if(o)return t=m(n,e,t,h),t?e+'="'+t+'"':e;var i=g(n,e,t,o);return r(i)?void 0:i}),s="<"+n;return y&&(s+=" "+y),E.closing&&(s+=" /"),s+=">"}var C=l(n,s,b);return r(C)?p(s):C},p);return b&&(C=b.remove(C)),C},t.exports=a},{"./default":1,"./parser":3,"./util":4,cssfilter:8}],6:[function(e,t,n){function r(e){return void 0===e||null===e}function o(e){var t={};for(var n in e)t[n]=e[n];return t}function i(e){e=o(e||{}),e.whiteList=e.whiteList||a.whiteList,e.onAttr=e.onAttr||a.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||a.onIgnoreAttr,this.options=e}var a=e("./default"),l=e("./parser");e("./util");i.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,n=t.options,o=n.whiteList,i=n.onAttr,a=n.onIgnoreAttr,s=l(e,function(e,t,n,l,s){var c=o[n],d=!1;c===!0?d=c:"function"==typeof c?d=c(l):c instanceof RegExp&&(d=c.test(l)),d!==!0&&(d=!1);var u={position:t,sourcePosition:e,source:s,isWhite:d};if(d){var f=i(n,l,u);return r(f)?n+":"+l:f}var f=a(n,l,u);if(!r(f))return f});return s},t.exports=i},{"./default":7,"./parser":9,"./util":10}],7:[function(e,t,n){function r(){var e={};return e["align-content"]=!1,e["align-items"]=!1,e["align-self"]=!1,e["alignment-adjust"]=!1,e["alignment-baseline"]=!1,e.all=!1,e["anchor-point"]=!1,e.animation=!1,e["animation-delay"]=!1,e["animation-direction"]=!1,e["animation-duration"]=!1,e["animation-fill-mode"]=!1,e["animation-iteration-count"]=!1,e["animation-name"]=!1,e["animation-play-state"]=!1,e["animation-timing-function"]=!1,e.azimuth=!1,e["backface-visibility"]=!1,e.background=!0,e["background-attachment"]=!0,e["background-clip"]=!0,e["background-color"]=!0,e["background-image"]=!0,e["background-origin"]=!0,e["background-position"]=!0,e["background-repeat"]=!0,e["background-size"]=!0,e["baseline-shift"]=!1,e.binding=!1,e.bleed=!1,e["bookmark-label"]=!1,e["bookmark-level"]=!1,e["bookmark-state"]=!1,e.border=!0,e["border-bottom"]=!0,e["border-bottom-color"]=!0,e["border-bottom-left-radius"]=!0,e["border-bottom-right-radius"]=!0,e["border-bottom-style"]=!0,e["border-bottom-width"]=!0,e["border-collapse"]=!0,e["border-color"]=!0,e["border-image"]=!0,e["border-image-outset"]=!0,e["border-image-repeat"]=!0,e["border-image-slice"]=!0,e["border-image-source"]=!0,e["border-image-width"]=!0,e["border-left"]=!0,e["border-left-color"]=!0,e["border-left-style"]=!0,e["border-left-width"]=!0,e["border-radius"]=!0,e["border-right"]=!0,e["border-right-color"]=!0,e["border-right-style"]=!0,e["border-right-width"]=!0,e["border-spacing"]=!0,e["border-style"]=!0,e["border-top"]=!0,e["border-top-color"]=!0,e["border-top-left-radius"]=!0,e["border-top-right-radius"]=!0,e["border-top-style"]=!0,e["border-top-width"]=!0,e["border-width"]=!0,e.bottom=!1,e["box-decoration-break"]=!0,e["box-shadow"]=!0,e["box-sizing"]=!0,e["box-snap"]=!0,e["box-suppress"]=!0,e["break-after"]=!0,e["break-before"]=!0,e["break-inside"]=!0,e["caption-side"]=!1,e.chains=!1,e.clear=!0,e.clip=!1,e["clip-path"]=!1,e["clip-rule"]=!1,e.color=!0,e["color-interpolation-filters"]=!0,e["column-count"]=!1,e["column-fill"]=!1,e["column-gap"]=!1,e["column-rule"]=!1,e["column-rule-color"]=!1,e["column-rule-style"]=!1,e["column-rule-width"]=!1,e["column-span"]=!1,e["column-width"]=!1,e.columns=!1,e.contain=!1,e.content=!1,e["counter-increment"]=!1,e["counter-reset"]=!1,e["counter-set"]=!1,e.crop=!1,e.cue=!1,e["cue-after"]=!1,e["cue-before"]=!1,e.cursor=!1,e.direction=!1,e.display=!0,e["display-inside"]=!0,e["display-list"]=!0,e["display-outside"]=!0,e["dominant-baseline"]=!1,e.elevation=!1,e["empty-cells"]=!1,e.filter=!1,e.flex=!1,e["flex-basis"]=!1,e["flex-direction"]=!1,e["flex-flow"]=!1,e["flex-grow"]=!1,e["flex-shrink"]=!1,e["flex-wrap"]=!1,e.float=!1,e["float-offset"]=!1,e["flood-color"]=!1,e["flood-opacity"]=!1,e["flow-from"]=!1,e["flow-into"]=!1,e.font=!0,e["font-family"]=!0,e["font-feature-settings"]=!0,e["font-kerning"]=!0,e["font-language-override"]=!0,e["font-size"]=!0,e["font-size-adjust"]=!0,e["font-stretch"]=!0,e["font-style"]=!0,e["font-synthesis"]=!0,e["font-variant"]=!0,e["font-variant-alternates"]=!0,e["font-variant-caps"]=!0,e["font-variant-east-asian"]=!0,e["font-variant-ligatures"]=!0,e["font-variant-numeric"]=!0,e["font-variant-position"]=!0,e["font-weight"]=!0,e.grid=!1,e["grid-area"]=!1,e["grid-auto-columns"]=!1,e["grid-auto-flow"]=!1,e["grid-auto-rows"]=!1,e["grid-column"]=!1,e["grid-column-end"]=!1,e["grid-column-start"]=!1,e["grid-row"]=!1,e["grid-row-end"]=!1,e["grid-row-start"]=!1,e["grid-template"]=!1,e["grid-template-areas"]=!1,e["grid-template-columns"]=!1,e["grid-template-rows"]=!1,e["hanging-punctuation"]=!1,e.height=!0,e.hyphens=!1,e.icon=!1,e["image-orientation"]=!1,e["image-resolution"]=!1,e["ime-mode"]=!1,e["initial-letters"]=!1,e["inline-box-align"]=!1,e["justify-content"]=!1,e["justify-items"]=!1,e["justify-self"]=!1,e.left=!1,e["letter-spacing"]=!0,e["lighting-color"]=!0,e["line-box-contain"]=!1,e["line-break"]=!1,e["line-grid"]=!1,e["line-height"]=!1,e["line-snap"]=!1,e["line-stacking"]=!1,e["line-stacking-ruby"]=!1,e["line-stacking-shift"]=!1,e["line-stacking-strategy"]=!1,e["list-style"]=!0,e["list-style-image"]=!0,e["list-style-position"]=!0,e["list-style-type"]=!0,e.margin=!0,e["margin-bottom"]=!0,e["margin-left"]=!0,e["margin-right"]=!0,e["margin-top"]=!0,e["marker-offset"]=!1,e["marker-side"]=!1,e.marks=!1,e.mask=!1,e["mask-box"]=!1,e["mask-box-outset"]=!1,e["mask-box-repeat"]=!1,e["mask-box-slice"]=!1,e["mask-box-source"]=!1,e["mask-box-width"]=!1,e["mask-clip"]=!1,e["mask-image"]=!1,e["mask-origin"]=!1,e["mask-position"]=!1,e["mask-repeat"]=!1,e["mask-size"]=!1,e["mask-source-type"]=!1,e["mask-type"]=!1,e["max-height"]=!0,e["max-lines"]=!1,e["max-width"]=!0,e["min-height"]=!0,e["min-width"]=!0,e["move-to"]=!1,e["nav-down"]=!1,e["nav-index"]=!1,e["nav-left"]=!1,e["nav-right"]=!1,e["nav-up"]=!1,e["object-fit"]=!1,e["object-position"]=!1,e.opacity=!1,e.order=!1,e.orphans=!1,e.outline=!1,e["outline-color"]=!1,e["outline-offset"]=!1,e["outline-style"]=!1,e["outline-width"]=!1,e.overflow=!1,e["overflow-wrap"]=!1,e["overflow-x"]=!1,e["overflow-y"]=!1,e.padding=!0,e["padding-bottom"]=!0,e["padding-left"]=!0,e["padding-right"]=!0,e["padding-top"]=!0,e.page=!1,e["page-break-after"]=!1,e["page-break-before"]=!1,e["page-break-inside"]=!1,e["page-policy"]=!1,e.pause=!1,e["pause-after"]=!1,e["pause-before"]=!1,e.perspective=!1,e["perspective-origin"]=!1,e.pitch=!1,e["pitch-range"]=!1,e["play-during"]=!1,e.position=!1,e["presentation-level"]=!1,e.quotes=!1,e["region-fragment"]=!1,e.resize=!1,e.rest=!1,e["rest-after"]=!1,e["rest-before"]=!1,e.richness=!1,e.right=!1,e.rotation=!1,e["rotation-point"]=!1,e["ruby-align"]=!1,e["ruby-merge"]=!1,e["ruby-position"]=!1,e["shape-image-threshold"]=!1,e["shape-outside"]=!1,e["shape-margin"]=!1,e.size=!1,e.speak=!1,e["speak-as"]=!1,e["speak-header"]=!1,e["speak-numeral"]=!1,e["speak-punctuation"]=!1,e["speech-rate"]=!1,e.stress=!1,e["string-set"]=!1,e["tab-size"]=!1,e["table-layout"]=!1,e["text-align"]=!0,e["text-align-last"]=!0,e["text-combine-upright"]=!0,e["text-decoration"]=!0,e["text-decoration-color"]=!0,e["text-decoration-line"]=!0,e["text-decoration-skip"]=!0,e["text-decoration-style"]=!0,e["text-emphasis"]=!0,e["text-emphasis-color"]=!0,e["text-emphasis-position"]=!0,e["text-emphasis-style"]=!0,e["text-height"]=!0,e["text-indent"]=!0,e["text-justify"]=!0,e["text-orientation"]=!0,e["text-overflow"]=!0,e["text-shadow"]=!0,e["text-space-collapse"]=!0,e["text-transform"]=!0,e["text-underline-position"]=!0,e["text-wrap"]=!0,e.top=!1,e.transform=!1,e["transform-origin"]=!1,e["transform-style"]=!1,e.transition=!1,e["transition-delay"]=!1,e["transition-duration"]=!1,e["transition-property"]=!1,e["transition-timing-function"]=!1,e["unicode-bidi"]=!1,e["vertical-align"]=!1,e.visibility=!1,e["voice-balance"]=!1,e["voice-duration"]=!1,e["voice-family"]=!1,e["voice-pitch"]=!1,e["voice-range"]=!1,e["voice-rate"]=!1,e["voice-stress"]=!1,e["voice-volume"]=!1,e.volume=!1,e["white-space"]=!1,e.widows=!1,e.width=!0,e["will-change"]=!1,e["word-break"]=!0,e["word-spacing"]=!0,e["word-wrap"]=!0,e["wrap-flow"]=!1,e["wrap-through"]=!1,e["writing-mode"]=!1,e["z-index"]=!1,e}function o(e,t,n){}function i(e,t,n){}n.whiteList=r(),n.getDefaultWhiteList=r,n.onAttr=o,n.onIgnoreAttr=i},{}],8:[function(e,t,n){function r(e,t){var n=new i(t);return n.process(e)}var o=e("./default"),i=e("./css");n=t.exports=r,n.FilterCSS=i;for(var a in o)n[a]=o[a];"undefined"!=typeof window&&(window.filterCSS=t.exports)},{"./css":6,"./default":7}],9:[function(e,t,n){function r(e,t){function n(){if(!i){var n=o.trim(e.slice(a,l)),r=n.indexOf(":");if(r!==-1){var c=o.trim(n.slice(0,r)),d=o.trim(n.slice(r+1));if(c){var u=t(a,s.length,c,d,n);u&&(s+=u+"; ")}}}a=l+1}e=o.trimRight(e),";"!==e[e.length-1]&&(e+=";");for(var r=e.length,i=!1,a=0,l=0,s="";l<r;l++){var c=e[l];if("/"===c&&"*"===e[l+1]){var d=e.indexOf("*/",l+2);if(d===-1)break;l=d+1,a=l+1,i=!1}else"("===c?i=!0:")"===c?i=!1:";"===c?i||n():"\n"===c&&n()}return o.trim(s)}var o=e("./util");t.exports=r},{"./util":10}],10:[function(e,t,n){t.exports={indexOf:function(e,t){var n,r;if(Array.prototype.indexOf)return e.indexOf(t);for(n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},forEach:function(e,t,n){var r,o;if(Array.prototype.forEach)return e.forEach(t,n);for(r=0,o=e.length;r<o;r++)t.call(n,e[r],r,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}}},{}]},{},[2]),t.exports=filterXSS},{}],24:[function(e,t,n){"use strict";var r=e("./../common/env"),o=e("./../common/const"),i=e("./../common/utils"),a=12,l={pt2px:function e(){var e,t=document.createElement("span");return t.style.visibility="hidden",t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.fontSize=a+"pt",r.doc.body.appendChild(t),e=window.getComputedStyle(t).fontSize,e=parseInt(e,10)/a,r.doc.body.removeChild(t),l.pt2px=function(){return e},e},getRootSizeRate:function(){if(!r.doc.getElementById(o.ID.WIZ_DEFAULT_STYLE))return 1;var e=r.win.getComputedStyle(r.doc.body.parentNode),t=parseFloat(e.fontSize);return parseFloat(t)/l.pt2px()/a},addClass:function(e,t){if(e){e.nodeType&&(e=[e]);var n,r;for(n=e.length-1;n>=0;n--)r=e[n],1!==r.nodeType||l.hasClass(r,t)||(r.className=(r.className+" "+t).trim())}},appendStyle:function(e,t){if(e){var n,r,o,i=e.split(";");for(n=0,r=i.length;n<r;n++)i[n].indexOf(":")>0&&(o=i[n].split(":"),t[o[0].trim()]=o[1].trim())}},attr:function(e,t){var n,r;if(e&&t&&1===e.nodeType)for(n in t)t.hasOwnProperty(n)&&"string"==typeof n&&(r=t[n],r?e.setAttribute(n,r):e.removeAttribute(n))},canEdit:function(e){var t=["script","style"];return e&&(1==e.nodeType||3==e.nodeType)&&(l.isTag(e,"br")||!l.isEmptyDom(e))&&!l.getParentByTagName(e,o.TAG.TMP_TAG,!0,null)&&!(1===e.nodeType&&l.isTag(e,t)||3===e.nodeType&&e.parentNode&&l.isTag(e.parentNode,t))},childNodesFilter:function(e){if(e&&1===e.nodeType){var t,n;for(t=e.childNodes.length-1;t>=0;t--)n=e.childNodes[t],1==n.nodeType?(/link|style|script|meta/gi.test(n.nodeName)&&e.removeChild(n),l.childNodesFilter(n)):3!=n.nodeType&&e.removeChild(n)}},clearStyle:function(e,t,n){function r(e,n){e.style[t]="",l.isTag(e,"font")&&"color"===n&&e.removeAttribute("color")}if(r(e,t),!n)for(;e&&!l.isBlock(e);)r(e,t),e=e.parentNode},clearStyleFromHtml:function(e,t){var n,r=/(<[^<>]* style=(['"]))((\r?\n|(?!(\2|[<>])).)*)/gi;t=t?t:[];var o,i;for(n=0;n<t.length;n++)o=t[n],i=o.indexOf("*"),t[n]=i>=0?o.substr(0,i).escapeRegex():o.escapeRegex()+"$";var a=t.length>0?new RegExp("^("+t.join("|")+")","i"):null;return e=e.replace(r,function(e,t,n,r){var o,i,s,c,d,u,f=[t],g=!0,m=r.split(";");for(d=0,u=m.length;d<u;d++){if(o=m[d],i=o.indexOf(":"),s="",c="",i>-1)s=o.substr(0,i).trim(),c=o.substr(i+1).trim();else if(!g&&o){f.push(o,";");continue}s&&a&&a.test(s)?(/^font-size$/i.test(s)&&(c=l.getFontSizeRem(c,{useRootSize:!0})),!c||/^(inherit|initial|transparent)$/i.test(c)?g=!1:(f.push(s,":",c,";"),g=!1)):g=!0}return f.join("")})},clone:function(e,t){var n,o,i,a,s,c,d;if(!e)return null;if(t)if(3===e.nodeType)n=r.doc.createTextNode("");else{for(n=r.doc.createElement(e.tagName),i=e.attributes,a={},s=0,c=i.length;s<c;s++)d=i[s],/^id$/i.test(d.nodeName)||(a[d.nodeName]=d.nodeValue);l.attr(n,a)}else 3===e.nodeType?n=r.doc.createTextNode(e.nodeValue):(o=r.doc.createElement("div"),o.innerHTML=e.outerHTML,n=o.childNodes[0]);return n},compareIndexList:function(e,t){var n,r,o,i=Math.min(e.length,t.length);for(n=0;n<i;n++){if(r=e[n],o=t[n],r<o)return-1;if(r>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0},contains:function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))},convertImageToBase64:function(e,t,n,o){var i=r.doc.createElement("img");i.onload=function(){var e=r.doc.createElement("canvas");e.width=t,e.height=n;var a=e.getContext("2d"),l=t/i.width,s=n/i.height,c=Math.max(l,s);a.scale(c,c),a.drawImage(i,0,0),o(e.toDataURL()),i=null,e=null},i.src=e},createSpan:function(){var e=r.doc.createElement("span");return e.setAttribute(o.ATTR.SPAN,o.ATTR.SPAN),e},css:function(e,t){if(e&&t&&!l.isTag(e,"br")){var n,r,o={};for(n in t)t.hasOwnProperty(n)&&"string"==typeof n&&(r=t[n],r||0===r?o[n]=r:l.clearStyle(e,n,!1));for(n in o)o.hasOwnProperty(n)&&"string"==typeof n&&(r=o[n],r||0===r?r.toString().indexOf("!important")>0?(l.clearStyle(e,n,!0),e.style.cssText+=n+":"+r):"font-size"==n.toLowerCase()?(l.clearStyle(e,n,!0),r=l.getFontSizeRem(r),r&&(e.style.cssText+=n+":"+r)):e.style[n]=r:l.clearStyle(e,n,!1))}},focus:function(){r.win.WizTemplate?r.win.WizTemplate.focus():r.doc.body.focus()},getBlockParent:function(e,t){return e?l.getParentByFilter(e,function(e){return l.isBlock(e)},t):null},getComputedStyle:function(e,t,n){if(!e||3==e.nodeType||!t)return"";for(var o;!o;)if(1===e.nodeType){var a=r.win.getComputedStyle(e,null);if(o=a[t]||"",/^rgba?\(.*\)$/i.test(o)&&(o=i.rgb2Hex(o)),e==r.doc.body||!n||o)break;e=e.parentNode}else e=e.parentNode;return o},getDocType:function(e){var t=e.doctype;return t=(!t||t.systemId||t.publicId)&&t?'<!DOCTYPE HTML PUBLIC "'+t.publicId+'" "'+t.systemId+'" >':"<!DOCTYPE HTML>"},getEndOffset:function(e){return e?3==e.nodeType?e.nodeValue.length:e.childNodes.length:0},getFirstDeepChild:function(e){if(!e)return null;for(var t=e;t&&t.childNodes&&t.childNodes.length>0;){for(t=t.childNodes[0];t&&1===t.nodeType&&/^wiz_/gi.test(t.tagName);)t=t.nextSibling;t&&(e=t)}return e},getFontSizeRem:function(e,t){var e=e.trim(),n=parseFloat(e);if(e.indexOf("%")>-1)return Math.round(n/100*1e3)/1e3+"rem";if(/^smaller$/i.test(e))return"0.83rem";if(/^small$/i.test(e))return"0.8125rem";if(/^x-small$/i.test(e))return"0.75rem";if(/^xx-small$/i.test(e))return"0.75rem";if(/^larger$/i.test(e))return"1.2rem";if(/^large$/i.test(e))return"1.125rem";if(/^x-large$/i.test(e))return"1.5rem";if(/^xx-large$/i.test(e))return"2rem";if(/^medium$/i.test(e))return"1rem";if(!/pt|px/i.test(e))return isNaN(n)?null:n+"rem";var o={useRootSize:!(!t||!t.useRootSize)},i=r.win.getComputedStyle(r.doc.body.parentNode),s=parseFloat(i.fontSize),c=o.useRootSize?a*l.getRootSizeRate():a;return isNaN(s)||isNaN(n)||0==s?null:(n/=/pt/i.test(e)?c:s,Math.round(1e3*n)/1e3+"rem")},getFromIndexList:function(e){if(!e||0===e.length)return null;var t,n,o,i;o=r.doc.body;try{for(t=0,n=e.length-1;t<n;t++)o=o.childNodes[e[t]];return i=e[t],{dom:o,offset:i}}catch(e){return null}},getLastDeepChild:function(e){if(!e)return null;for(var t=e;t&&t.childNodes&&t.childNodes.length>0;){for(t=t.childNodes[t.childNodes.length-1];t&&1===t.nodeType&&/^wiz_/gi.test(t.tagName);)t=t.previousSibling;t&&(e=t)}return e},getImageData:function(e){var t=l.getImageSize(e.src),n=r.doc.createElement("canvas");n.width=t.width,n.height=t.height;var o=n.getContext("2d");o.drawImage(e,0,0);var i=n.toDataURL("image/png");return i.replace(/^data:image\/(png|jpg);base64,/,"")},getImageSize:function(e){var t=new Image;t.src=e;var n=t.height,r=t.width;return{width:r,height:n}},getIndex:function(e){if(!e||!e.parentNode)return-1;for(var t=0,n=e;n=n.previousSibling;)++t;return t},getIndexList:function(e){for(var t=e,n=[];t&&!l.isBody(t);)n.splice(0,0,l.getIndex(t)),t=t.parentNode;return n},getListA2B:function(e){function t(e,t){e.push(t)}var n,r=e.startDom,i=e.startOffset,a=e.endDom,s=e.endOffset,c=!!e.noSplit,d=!1,u=!1;1===r.nodeType&&i>0&&i<r.childNodes.length&&(r=r.childNodes[i],i=0),1===a.nodeType&&s>0&&s<a.childNodes.length&&(a=a.childNodes[s],s=0),r!==a&&0===s&&(a=l.getPreviousNode(a,!1,r),a||(a=r),s=l.isSelfClosingTag(a)?1:l.getEndOffset(a)),r===a&&i!==s?(n=3===r.nodeType,!n||r.parentNode.getAttribute(o.ATTR.SPAN_DELETE)||c?1===r.nodeType&&r.childNodes.length>0&&!l.isSelfClosingTag(r)&&(r=r.childNodes[i],a=a.childNodes[s-1],d=!0,u=!0):(r=l.splitRangeText(r,i,s,!1),a=r,d=!0,u=!0)):r!==a&&(3!==r.nodeType||r.parentNode.getAttribute(o.ATTR.SPAN_DELETE)||c?1===r.nodeType&&r.childNodes.length>0&&i<r.childNodes.length&&(r=r.childNodes[i],d=!0):(r=l.splitRangeText(r,i,null,!1),d=!0),3===a.nodeType&&s>0&&!a.parentNode.getAttribute(o.ATTR.SPAN_DELETE)&&!c?(a=l.splitRangeText(a,0,s,!0),u=!0):!l.isSelfClosingTag(a)&&1===a.nodeType&&s>0&&(a=l.getLastDeepChild(a.childNodes[s-1]),u=!0)),d&&(i=0),u&&(s=l.getEndOffset(a));var f=r,g=[];for(i===r.length&&(f=l.getNextNode(f,!1,a));f&&(r!==a||i!==s);){if(f===a||f===a.parentNode){t(g,a);break}if(l.isBody(f)){t(g,f);break}t(g,f),f=l.getNextNode(f,!1,a)}var m=l.getPreviousNode(g[0],!1,null),p=l.getNextNode(g[g.length-1],!1,null);m&&1===m.nodeType&&m.firstChild&&(m=m.firstChild),p&&1===p.nodeType&&p.lastChild&&(p=p.lastChild);var h=l.getEndOffset(m),b=0;return{list:g,startDom:r,startOffset:i,endDom:a,endOffset:s,startDomBak:m,startOffsetBak:h,endDomBak:p,endOffsetBak:b}},getListFromTagAndIndex:function(e,t,n,r){var o,a,s,c=[],d=t.querySelectorAll(e);for(o=0;o<d.length;o++)s=d[o],a=l.getIndexList(s).join("."),i.compareVersion(a,n)>-1&&i.compareVersion(a,r)<1&&c.push(s);return c},getNextNodeCanEdit:function(e,t,n){for(e=l.getNextNode(e,t,n);e&&!l.canEdit(e);)e=l.getNextNode(e,t,n);return e},getNextNode:function(e,t,n){function r(e){return e?t?e.nextElementSibling:e.nextSibling:null}function o(e){return e?t?e.firstElementChild:e.firstChild:null}var i=e;if(!e||e==n)return null;if(t=!!t,!r(e)&&!e.parentNode)return null;if(r(e))e=r(e);else for(;e.parentNode;){if(e=e.parentNode,l.isBody(e)){e=null;break}if(e===n)break;if(r(e)){e=r(e);break}}if(e===n)return e;var a;if(a=o(e),e&&a)for(;a&&(e=a,e!==n);)a=o(a);return e===i?null:e},getOffset:function(e){var t={top:0,left:0};if(e.offsetParent)for(;e.offsetParent;)t.top+=e.offsetTop,t.left+=e.offsetLeft,e=e.offsetParent;else t.left+=e.offsetLeft,t.top+=e.offsetTop;return t},getPageScroll:function(){var e={};return"undefined"!=typeof r.win.pageYOffset?(e.left=r.win.pageXOffset,e.top=r.win.pageYOffset):"undefined"!=typeof r.doc.compatMode&&"BackCompat"!=r.doc.compatMode?(e.left=r.doc.documentElement.scrollLeft,e.top=r.doc.documentElement.scrollTop):"undefined"!=typeof r.doc.body&&(e.left=r.doc.body.scrollLeft,e.top=r.doc.body.scrollTop),e},getParentByFilter:function(e,t,n){if(e&&!l.isBody(e))for(e=n?e:e.parentNode;e;){if(!t||t(e))return e;if(l.isBody(e))return null;e=e.parentNode}return null},getParentByClass:function(e,t,n){return l.getParentByFilter(e,function(e){return l.hasClass(e,t)},n)},getParentByTagName:function(e,t,n,r){return e?(t=i.listToMap(i.isArray(t)?t:[t]),l.getParentByFilter(e,function(e){return t[e.tagName]&&!(r&&r(e))},n)):null},getParentRoot:function(e){if(!e||0===e.length)return null;var t,n,o,i,a=[];for(i=1==e[0].nodeType?e[0]:e[0].parentNode;i&&!l.isBody(i);)a.push(i),i=i.parentNode;for(t=1,n=e.length;t<n;t++)for(i=e[t];i;){if(l.isBody(i))return r.doc.body;if(o=a.indexOf(i),o>-1){a.splice(0,o);break}i=i.parentNode}return 0===a.length?r.doc.body:a[0]},getParentList:function(e){for(var t=[],n=e.parentNode;n&&n!==r.doc.body;)t.splice(0,0,n),n=n.parentNode;return t},getPosition:function(e){return e?{top:e.offsetTop,left:e.offsetLeft,height:e.offsetHeight,width:e.offsetWidth}:null},getPreviousNode:function(e,t,n){function r(e){return t?e.previousElementSibling:e.previousSibling}function o(e){return t?e.lastElementChild:e.lastChild}var i=e;if(!e||e==n)return null;if(t=!!t,r(e))e=r(e);else for(;e.parentNode;){if(e=e.parentNode,l.isBody(e)){e=null;break}if(e==n)break;if(r(e)){e=r(e);break}}if(!e)return null;if(e===n&&(3===e.nodeType||1===e.nodeType&&0===e.childNodes.length))return e;var a;if(a=o(e),e&&a)for(;a&&(e=a,e!==n||3!==e.nodeType&&(1!==e.nodeType||0!==e.childNodes.length));)a=o(a);return e===i?null:e},getPreviousNodeCanEdit:function(e,t,n){for(e=l.getPreviousNode(e,t,n);e&&!l.canEdit(e);)e=l.getPreviousNode(e,t,n);return e},getTab:function(){var e=r.doc.createElement("span");return e.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;",e.childNodes[0]},getTdIndex:function(e){return{x:e.cellIndex,y:e.parentNode.rowIndex,maxX:e.parentNode.cells.length,maxY:e.parentNode.parentNode.rows.length}},getWindowSize:function(){return{width:r.doc.documentElement.clientWidth,height:r.doc.documentElement.clientHeight}},getWizAmendParent:function(e){return l.getParentByFilter(e,function(e){return e&&1===e.nodeType&&(e.getAttribute(o.ATTR.SPAN_INSERT)||e.getAttribute(o.ATTR.SPAN_DELETE));
},!0)},hasClass:function(e,t){return!(!e||1!==e.nodeType)&&(" "+e.className+" ").indexOf(" "+t+" ")>-1},after:function(e,t){l.before(e,t,!0)},before:function(e,t,n){if(n=!!n,t&&e){var o,a,l,s=t===r.doc.body,c=s?t:t.parentNode,d=s?n?null:r.doc.body.childNodes[0]:n?t.nextSibling:t;if(i.isArray(e))for(l=d,o=e.length-1;o>=0;o--)a=e[o],c.insertBefore(a,l),l=a;else c.insertBefore(e,d)}},isBlock:function(e){if(!e)return!1;if(l.isWizDom(e))return!0;var t=l.getComputedStyle(e,"display",!1);return!!t&&!/^(inline|inline\-block|inline\-table|none)$/i.test(t)},isWizDom:function(e){return 1===e.nodeType&&/^wiz_/i.test(e.tagName)},isBody:function(e){return e&&e==r.doc.body},isEmptyDom:function(e){if(!e)return!1;var t,n,r;if(3===e.nodeType)return r=e.nodeValue,i.isEmpty(r);if(1!==e.nodeType)return!0;if(0===e.childNodes.length)return l.isTag(e,"br")||!l.isSelfClosingTag(e);for(t=0,n=e.childNodes.length;t<n;t++)if(!l.isEmptyDom(e.childNodes[t]))return!1;return!0},isFillChar:function(e,t){return 3===e.nodeType&&!e.nodeValue.replace(new RegExp((t?"^":"")+o.FILL_CHAR),"").length},isInlineDom:function(e){return!l.isBlock(e)},isSelfClosingTag:function(e){var t=/^(area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;return e&&1===e.nodeType&&t.test(e.tagName)},isSameSpan:function(e,t){return!!e&&!!t&&1==e.nodeType&&1==t.nodeType&&l.isTag(e,"span")&&e.tagName==t.tagName&&e.getAttribute(o.ATTR.SPAN)==o.ATTR.SPAN&&l.isSameStyle(e,t)&&l.isSameAttr(e,t)},isSameAttr:function(e,t){var n=e.attributes,r=t.attributes;if(n.length!=r.length)return!1;var a,l,s;for(a=0,l=n.length;a<l;a++)if(s=n[a],"style"!=s.name)if(s.name!==o.ATTR.SPAN_TIMESTAMP){if(!r[s.name]||r[s.name].value!=s.value)return!1}else if(!i.isSameAmendTime(s.value,r[s.name].value))return!1;return!0},isSameStyle:function(e,t){var n={},r={};l.appendStyle(e.getAttribute("style"),n),l.appendStyle(t.getAttribute("style"),r);var o;for(o in n)if(n.hasOwnProperty(o)){if(r[o]!==n[o])return!1;delete n[o],delete r[o]}for(o in r)if(r.hasOwnProperty(o))return!1;return!0},isTag:function(e,t){if(i.isArray(t)||(t=[t]),!e||1!==e.nodeType)return!1;var n,r,o=e.tagName.toLowerCase();for(n=0,r=t.length;n<r;n++)if(o===t[n].toLowerCase())return!0;return!1},isUsableTextNode:function(e){return 3==e.nodeType&&!i.isEmpty(e.nodeValue)},isWizSpan:function(e){return!!e&&!!e.getAttribute(o.ATTR.SPAN)},mergeAtoB:function(e,t,n){l.mergeStyleAToB(e,t,n),l.mergeAttrAtoB(e,t,n)},mergeAttrAtoB:function(e,t,n){if(1==e.nodeType&&1==t.nodeType){var r,o,i,a=e.attributes,l=t.attributes;for(r=0,o=a.length;r<o;r++)i=a[r],"style"!=i.name&&(l[i.name]&&!n||t.setAttribute(i.name,i.value))}},mergeStyleAToB:function(e,t,n){if(1==e.nodeType&&1==t.nodeType){var r=e.getAttribute("style"),o=t.getAttribute("style")||"";if(r){var i={};n?(l.appendStyle(o,i),l.appendStyle(r,i)):(l.appendStyle(r,i),l.appendStyle(o,i));var a=[];for(var s in i)i.hasOwnProperty(s)&&a.push(s+":"+i[s]);t.setAttribute("style",a.join(";"))}}},packageByDiv:function(e){var t,n;for(t=e;t;){if(l.isBlock(t)){n=t,t=null;break}if(l.isTag(t.parentNode,["body","td","th"]))break;t=t.parentNode}if(n)return n;for(var o,i=t,a=t;i&&(o=i.previousSibling,o&&!l.isBlock(o));)i=o;for(;a&&(o=a.nextSibling,o&&!l.isBlock(o));)a=o;n=r.doc.createElement("div"),l.before(n,i);var s,c,o=i;do s=o.nextSibling,n.appendChild(o),c=o===a,o=s;while(!c);return n},peelDom:function(e,t){if(e&&3!==e.nodeType){var n,r,o,i={start:null,end:null};for(n=e.childNodes,o=n.length-1;o>=0;o--)r=n[o],t&&!t(r)||(l.after(r,e),i.start?i.end=r:(i.start=r,i.end=r));return l.remove(e),i}},peelTag:function(e){var t,n,o=r.doc.querySelectorAll(e);for(t=o.length-1;t>=0;t--){for(n=o[t];n.firstChild;)l.before(n.firstChild,n);l.remove(n)}},peelTagFromHtml:function(e,t){var n=new RegExp("<"+t+"( [^>]*)?>|</"+t+">","ig");return e.replace(n,"")},replaceTagName:function(e,t){if(!l.isTag(e,t)){var n=l.hasClass(e,o.CLASS.TODO_LAYER),i=r.doc.createElement(t);for(l.after(i,e);e.firstChild;)i.appendChild(e.firstChild);n&&(e.className&&(i.className=e.className),e.id&&(i.id=e.id)),l.remove(e)}},removeClass:function(e,t){if(e){e.nodeType&&(e=[e]),i.isArray(t)||(t=[t]);var n,r,o,a;for(n=e.length-1;n>=0;n--)if(o=e[n],1===o.nodeType){for(o.className=" "+o.className+" ",r=t.length;r>=0;r--)a=t[r],o.className=o.className.replace(" "+a+" "," ");o.className=o.className.trim()}}},remove:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},removeByName:function(e){var t,n,o=r.doc.getElementsByName(e);for(t=o.length-1;t>=0;t--)n=o[t],l.remove(n)},removeByTag:function(e){var t,n,o=r.doc.getElementsByTagName(e);for(t=o.length-1;t>=0;t--)n=o[t],l.remove(n)},removeByTagFromHtml:function(e,t){var n=new RegExp("<"+t+"( [^>]*)?>((?!</"+t+">).|\r|\n)*?</"+t+">","ig");return e.replace(n,"")},removeStyleByIdFromHtml:function(e,t){var n="("+t.join("|")+")",r=new RegExp("<style( ([^<>])+[ ]+|[ ]+)id *= *(['\"])"+n+"\\3[^<>]*>[^<]*</style>","ig"),o=new RegExp("<link( ([^<>])+[ ]+|[ ]+)id *= *(['\"])"+n+"\\3[^<>]*>","ig");return e.replace(r,"").replace(o,"")},removeStyleByNameFromHtml:function(e,t){var n="("+t.join("|")+")",r=new RegExp("<style( ([^<>])+[ ]+|[ ]+)name *= *(['\"])"+n+"\\3[^<>]*>[^<]*</style>","ig"),o=new RegExp("<link( ([^<>])+[ ]+|[ ]+)name *= *(['\"])"+n+"\\3[^<>]*>","ig");return e.replace(r,"").replace(o,"")},removeViewportFromHtml:function(e,t){if(r.doc.querySelector("head meta[name=viewport]")){var n=new RegExp("<meta( ([^<>])+[ ]+|[ ]+)name *= *(['\"])viewport\\3[^<>]*>","i");return e.replace(n,"")}return e},removeListFilter:function(e,t){var n,r,o=[];if(!e||!t)return o;for(n=e.length-1;n>=0;n--)r=e[n],t(r)&&o.unshift(e.splice(n,1)[0]);return o},search:function(e,t,n){var r,o,i,a=e.querySelectorAll(t);for(n=n?n:[],r=0,o=a.length;r<o;r++)i=a[r],n.push(i)},setContenteditable:function(e,t){!e&&r.win.WizTemplate?r.win.WizTemplate.setContenteditable(t):(e||(e=r.doc.body),e.setAttribute("contenteditable",t?"true":"false"))},setLayout:function(e){var t,n,i,a,s=e.layerObj,c=e.target,d=e.layout,u=!!e.fixed,f=!!e.noSpace,g=!!e.reverse,m=l.getPosition(s),p=c.nodeType?l.getPosition(c):c,h=l.getPageScroll(),b=r.doc.documentElement.clientWidth,C=r.doc.documentElement.clientHeight,E=window.getComputedStyle?r.win.getComputedStyle(r.doc.body,null)["margin-top"]:0,v="50%",y="30%",T=0,S=-m.width/2;E&&(E=parseInt(E),isNaN(E)&&(E=0)),u?(t=0,n=b-5,i=0+E,a=C):(t=0+h.left,n=b+h.left-5,i=0+(h.top<=E?0:Math.abs(h.top-E))+E,a=C+h.top),p&&d&&(T=0,S=0,d==o.TYPE.POS.upLeft||d==o.TYPE.POS.upRight?y=p.top-m.height-(f?0:o.AMEND.INFO_SPACE):d==o.TYPE.POS.downLeft||d==o.TYPE.POS.downRight?y=p.top+p.height+(f?0:o.AMEND.INFO_SPACE):d==o.TYPE.POS.leftUp||d==o.TYPE.POS.leftDown?v=p.left-m.width-(f?0:o.AMEND.INFO_SPACE):d!=o.TYPE.POS.rightUp&&d!=o.TYPE.POS.rightDown||(v=p.left+p.width+(f?0:o.AMEND.INFO_SPACE)),d==o.TYPE.POS.upLeft||d==o.TYPE.POS.downLeft?(v=p.left,u&&(v-=h.left)):d==o.TYPE.POS.upRight||d==o.TYPE.POS.downRight?(v=p.left+p.width-m.width,u&&(v-=h.left)):d==o.TYPE.POS.leftUp||d==o.TYPE.POS.rightUp?(y=p.top,u&&(y-=h.top)):d!=o.TYPE.POS.leftDown&&d!=o.TYPE.POS.rightDown||(y=p.top+p.height-m.height,u&&(y-=h.top)),v+m.width>n&&(v=n-m.width),v<t&&(v=t),y+m.height>a&&(y=a-m.height),g&&y<i&&(y=p.top+p.height),(y<i||y+m.height>a)&&(y=i)),l.css(s,{left:v+"px",top:y+"px","margin-top":T+"px","margin-left":S+"px"})},setTextarea:function(e,t){var n=void 0===e.textContent?"innerText":"textContent";return t?void(e[n]=i.replaceSpecialChar(t)):void(e.value!==e[n]&&(e[n]=e.value))},splitRangeText:function(e,t,n,o){if(!l.isUsableTextNode(e))return e;var i,a,s,c=e.nodeValue;return i=e.parentNode,a=l.createSpan(),!t&&!n||0===t&&n===e.nodeValue.length?i.childNodes.length>1||l.isTag(i,["td","th"])?(o?i.insertBefore(a,e):i.insertBefore(a,e.nextSibling),a.appendChild(e)):a=i:0===t?(a.textContent=c.substring(t,n),i.insertBefore(a,e),e.nodeValue=c.substring(n)):n&&n!==e.nodeValue.length?(s=r.doc.createTextNode(c.substring(n)),a.textContent=c.substring(t,n),i.insertBefore(a,e.nextSibling),i.insertBefore(s,a.nextSibling),e.nodeValue=c.substring(0,t)):(a.textContent=c.substring(t),i.insertBefore(a,e.nextSibling),e.nodeValue=c.substring(0,t)),a}};t.exports=l},{"./../common/const":14,"./../common/env":16,"./../common/utils":20}],25:[function(e,t,n){"use strict";var r=e("./../common/env"),o=e("./../common/const"),i=e("./../common/utils"),a=e("./domBase");a.clearChild=function(e,t){if(e){var n,r=t.indexOf(e)>=0;if(!(r||3!==e.nodeType||a.isUsableTextNode(e)||a.getParentByTagName(e,"pre",!1)))return void a.remove(e);if(!r&&3===e.nodeType)return n=e.nodeValue.replace(o.FILL_CHAR_REG,""),void(n!==e.nodeValue&&(e.nodeValue=n));if(!r&&1===e.nodeType){var i,l,s=e.childNodes;for(i=s.length-1;i>=0;i--)l=s[i],a.clearChild(l,t);a.mergeChildSpan(e,t),t.indexOf(e)<0&&0===e.childNodes.length&&1===e.nodeType&&!a.isSelfClosingTag(e)&&e.getAttribute(o.ATTR.SPAN)&&a.remove(e)}}},a.fragmentFilterForCopy=function(e){var t,n,r=e.querySelectorAll("."+o.CLASS.CODE_CONTAINER+" textarea");for(n=r.length-1;n>=0;n--)t=r[n],a.remove(t);for(r=e.querySelectorAll("."+o.CLASS.CODE_MIRROR_MEASURE),n=r.length-1;n>=0;n--)t=r[n],a.remove(t);for(r=e.querySelectorAll("."+o.CLASS.CODE_MIRROR_GUTTER),n=r.length-1;n>=0;n--)t=r[n],a.remove(t);for(r=e.querySelectorAll("."+o.CLASS.CODE_TOOLS),n=r.length-1;n>=0;n--)t=r[n],a.remove(t)},a.fixFontSize=function(){var e,t,n,o,i,l=r.doc.querySelectorAll("[style]"),s=/font-size\s*:\s*([%.\w]*)/i;for(e=0;e<l.length;e++)t=l[e],n=t.getAttribute("style"),i=s.exec(n),!i||i[1].indexOf("rem")>0||(o=a.getFontSizeRem(i[1],{useRootSize:!0}),a.isTag(t,"html")||(t.style.fontSize=o))},a.fixOrderList=function(){var e,t,n,i,l=r.doc.querySelectorAll("ol");for(e=0;e<l.length;e++){for(t=l[e],n=t,i=0;n;)i++,n=a.getParentByTagName(n,["ul","ol"],!1);a.removeClass(t,o.CLASS.ORDER_LIST_LEVEL),a.addClass(t,o.CLASS.ORDER_LIST_LEVEL[i%3])}},a.getBodyText=function(){var e=r.doc.body;return e?e.innerText?e.innerText:"":" "},a.getContentHtml=function(e){a.fixFontSize();var t=e&&e.isSaveTemp;r.event.call(o.EVENT.BEFORE_GET_DOCHTML,null);var n,l,s,c=a.getDocType(r.doc),d=r.doc.getElementsByTagName("input");for(n=0,l=d.length;n<l;n++)s=d[n],/^test$/i.test(s.getAttribute("type"))&&s.value!==s.getAttribute("value")&&s.setAttribute("value",s.value);for(d=r.doc.getElementsByTagName("textarea"),n=0,l=d.length;n<l;n++)s=d[n],a.setTextarea(s);for(d=r.doc.querySelectorAll("."+o.CLASS.TABLE_CONTAINER),n=0,l=d.length;n<l;n++)a.moveOutFromTableContainer(d[n]);var u=[o.NAME.TMP_STYLE];t||u.push(o.NAME.UNSAVE_STYLE);var f=a.removeStyleByNameFromHtml(r.doc.documentElement.outerHTML,u);f=a.removeByTagFromHtml(f,o.TAG.TMP_TAG),f=a.peelTagFromHtml(f,o.TAG.TMP_PLUGIN_TAG),f=f.replace(/<!--(.|\n)*?(-->)/g,""),f=f.replace(/<script[^<>]*\/>/gi,"").replace(/<script[^<>]*>(((?!<\/script>).)|(\r?\n))*<\/script>/gi,"");var g=/(<[\w]*[^<>]*[ ]+)contenteditable([ ]*=[ ]*['"][^'"<>]*['"])?/gi;f=f.replace(g,"$1"),f=f.replace(/(<div class="CodeMirror-measure">)<pre><span>xxxxxxxxxx<\/span><\/pre>/gi,"$1"),f=a.hideTableFromHtml(f),f=a.hideCodeFromHtml(f),r.win.WizTemplate&&(f=r.win.WizTemplate.hideTemplateFormHtml(f)),f=i.replaceSpecialChar(f);var m,p;return t||(m=new RegExp("(<img[^<>]*)( "+o.ATTR.IMG_EDITING+"=('|\")1\\3)","ig"),f=f.replace(m,"$1"),p=new RegExp("(<[^<>]*src[ ]*=[ ]*(\"|'))"+r.options.indexFilesFullPath.escapeRegex(),"ig"),f=f.replace(p,"$1"+r.options.indexFilesPath+"/")),c+f},a.getPrevBlock=function(e){var t,n=!1;if(a.isBlock(e)||a.isTag(e,"br"))return e;for(;e&&(n&&e.childNodes&&e.childNodes.length>0?(e=e.childNodes[e.childNodes.length-1],n=!1):(t=e.previousSibling,t?(e=t,n=!0):(e=e.parentNode,n=!1)),!a.isBlock(e)&&!a.isTag(e,"br")););return e},a.getNextBlock=function(e){var t,n=!1;if(a.isBlock(e)||a.isTag(e,"br"))return e;for(;e&&(n&&e.childNodes&&e.childNodes.length>0?(e=e.childNodes[0],n=!1):(t=e.nextSibling,t?(e=t,n=!0):(e=e.parentNode,n=!1)),!a.isBlock(e)&&!a.isTag(e,"br")););return e},a.hideCodeFromHtml=function(e){var t=/(<div [^<>]*)(CodeMirror-activeline-background|CodeMirror-cursors|CodeMirror-selected|CodeMirror-hscrollbar|CodeMirror-vscrollbar)([^<>]*>)/gi;e=e.replace(t,"$1 wiz-hide wiz_$2$3");var n=/(<span [^<>]*)(CodeMirror-matchingbracket)([^<>]*>)/gi;return e=e.replace(n,"$1$3")},a.hideTableFromHtml=function(e){var t=/(<[^<> ]*[^<>]* class[ ]*=[ ]*['"])([^'"]*)(['"])/i,n=/(<[^<> ]*[^<>]* class[ ]*=[ ]*['"])([^'"]*)(['"])/gi;if(!t.test(e))return e;for(var r,i,a,l=[],s=0;r=n.exec(e);)i=r[2],(" "+i+" ").indexOf(" "+o.CLASS.SELECTED_CELL+" ")>-1&&(a=new RegExp(" "+o.CLASS.SELECTED_CELL+" ","ig"),i=(" "+i+" ").replace(a,"").trim()),l.push(e.substr(s,r.index-s),r[1],i,r[3]),s=r.index+r[0].length;return l.push(e.substr(s)),l.join("")},a.mergeChildSpan=function(e,t){if(e&&1===e.nodeType){var n,r;for(n=0,r=e.children.length;n<r;n++)a.mergeChildSpan(e.children[n],t);a.mergeSiblingSpan(e,t);var i,l=e.children[0];if(l&&t.indexOf(l)<0&&1==e.childNodes.length&&e.getAttribute(o.ATTR.SPAN)==o.ATTR.SPAN&&l.getAttribute(o.ATTR.SPAN)==o.ATTR.SPAN)a.mergeChildToParent(e,l);else for(;l;)t.indexOf(l)<0&&t.indexOf(e)<0&&a.isSameSpan(e,l)?(i=l.previousElementSibling,a.mergeChildToParent(e,l),l=i?i.nextElementSibling:e.children[0]):l=l.nextElementSibling}},a.mergeChildToParent=function(e,t){if(e&&t&&t.parentNode===e){for(;t.childNodes.length>0;)a.before(t.childNodes[0],t);a.mergeAtoB(e,t,!1),a.mergeAtoB(t,e,!0),e.removeChild(t)}},a.mergeSiblingSpan=function(e,t){var n,r,i=e.childNodes[0];if(i)for(;i;)if(n=i.nextSibling,n&&t.indexOf(n)<0&&t.indexOf(i)<0&&a.isSameSpan(i,n)){for(;n.childNodes.length;)r=n.childNodes[0],r&&(r.innerHTML||r.nodeValue&&r.nodeValue!=o.FILL_CHAR)?i.appendChild(r):n.removeChild(r);a.remove(n)}else i=n},a.modifyChildNodesStyle=function(e,t,n){if(e){var r,o,i=e.childNodes,l=!1;for(r=0;r<i.length;r++)o=i[r],!l&&a.isUsableTextNode(o)?(l=!0,a.modifyStyle(e,t,n)):1===o.nodeType&&a.modifyChildNodesStyle(o,t,n)}},a.modifyNodeStyle=function(e,t,n,r){return 1===e.nodeType?a.isSelfClosingTag(e)?a.modifyStyle(e,t,n):a.modifyChildNodesStyle(e,t,n):a.isUsableTextNode(e)&&(e=a.splitRangeText(e,null,null,r),a.modifyStyle(e,t,n)),e},a.modifyNodesStyle=function(e,t,n){if(0!==e.length){var r,o,i;for(r=0,o=e.length;r<o;r++)i=e[r],e[r]=a.modifyNodeStyle(i,t,n,r===o-1)}},a.modifyStyle=function(e,t,n){function r(e){if(e){var t=a.createSpan();for(t.setAttribute("style",e.getAttribute("style")||""),e.removeAttribute("style");e.firstChild;)t.insertBefore(e.firstChild,null);e.insertBefore(t,null)}}var i=a.isSelfClosingTag(e),l=a.hasClass(e,o.CLASS.TODO_CHECKBOX);if(!(l||n&&n[o.ATTR.SPAN_INSERT]&&i)){var s=e;if(n&&(n[o.ATTR.SPAN_INSERT]||n[o.ATTR.SPAN_DELETE])&&(s=a.getWizAmendParent(e),s?e=null:s=e),e&&!i&&(!a.isTag(e,"span")||e.getAttribute(o.ATTR.SPAN)!==o.ATTR.SPAN))for(s=a.createSpan(),e.insertBefore(s,null);e.childNodes.length>1;)s.insertBefore(e.childNodes[0],null);var c,d,u=[];for(c in t)t.hasOwnProperty(c)&&(d=t[c],d||u.push(c));var f,g=s,m=s;if(u.length>0){for(;g&&!a.isBlock(g)&&!a.hasClass(g,o.CLASS.TODO_MAIN);)a.isTag(g,"a")&&(f=g),m=g,g=m.parentNode;f?f===m?(r(f),a.splitDomSingle(f.firstChild,s)):(a.splitDomSingle(m,f),r(f),a.splitDomSingle(f.firstChild,s)):a.splitDomSingle(m,s)}a.css(s,t),a.attr(s,n)}},a.moveOutFromTableContainer=function(e){function t(e,t){if(e&&t){var n,r,i,l,s=e===t,c=!1,d=!1;for(n=t.childNodes,i=e,l=n.length-1;l>=0;l--)r=n[l],1!==r.nodeType||!(s&&a.hasClass(r,o.CLASS.TABLE_BODY)||!s&&a.isTag(r,["table",o.TAG.TMP_TAG]))||d?(a.before(r,i,!c),c&&(i=r)):(a.hasClass(r,o.CLASS.TABLE_BODY)||a.isTag(r,"table"))&&(c=!0,d=!0);0===t.childNodes.length&&a.remove(e)}}e&&(t(e,e),t(e,e.querySelector("."+o.CLASS.TABLE_BODY)))},a.removeEmptyParent=function(e){if(e){var t;a.isEmptyDom(e)&&(e===r.doc.body||a.isTag(e,["td","th"])?e.innerHTML="<br/>":(t=e.parentNode,t&&(t.removeChild(e),a.removeEmptyParent(t))))}},a.splitDomBeforeSub=function(e,t){function n(e,t){for(var n,r=e.parentNode,o=e.cloneNode(!1);t;)n=t.nextSibling,o.appendChild(t),t=n;return r.insertBefore(o,e.nextSibling),o}if(!e||!t)return e;for(var r=[t],o=t.parentNode,i=o.firstChild===t;o&&(r.push(o),i&&o.parentNode.firstChild!==o&&(i=!1),o!==e);)o=o.parentNode;if(i)return e;if(r[r.length-1]!==e)return e;for(;r.length>1;)r[1]=n(r[1],r[0]),r.splice(0,1);return r[0]},a.splitDomAfterSub=function(e,t){var n,r;if(t.nextSibling)r=t.nextSibling;else for(n=t.parentNode;n&&n!==e&&!(r=n.nextSibling);)n=n.parentNode;return r&&a.splitDomBeforeSub(e,r),e},a.splitDomSingle=function(e,t){if(e&&t&&1===e.nodeType&&t===e.firstChild&&1===e.childNodes.length)return e;var n=a.splitDomBeforeSub(e,t);return n=a.splitDomAfterSub(n,t)},t.exports=a},{"./../common/const":14,"./../common/env":16,"./../common/utils":20,"./domBase":24}],26:[function(e,t,n){"use strict";var r=e("../common/env"),o=e("../common/const"),i=e("./domBase"),a={active:"active",selected:"selected"},l={bind:function(){l.unbind(),r.event.add(o.EVENT.ON_MOUSE_DOWN,l.handler.onMouseDown)},unbind:function(){r.event.remove(o.EVENT.ON_MOUSE_DOWN,l.handler.onMouseDown)},handler:{onMouseDown:function(e){var t=e.target,n=s.getHeaderFromDom(t);if(n)return void s.showOptions(n);var r=s.getOptionFromDom(t);r&&s.selectOption(r);var o=s.getContainerFromDom(t);o||s.hideOptions()}}},s={getContainerFromDom:function(e){return i.getParentByClass(e,o.CLASS.SELECT_PLUGIN_CONTAINER,!0)},getHeaderFromDom:function(e){return i.getParentByClass(e,o.CLASS.SELECT_PLUGIN_HEADER,!0)},getHeaderText:function(e){return e.querySelector("."+o.CLASS.SELECT_PLUGIN_HEADER_TEXT)},getOptionFromDom:function(e){return i.getParentByClass(e,o.CLASS.SELECT_PLUGIN_OPTIONS_ITEM,!0)},hideOptions:function(e){var t,n;for(t=e?[e]:r.doc.querySelectorAll("."+o.CLASS.SELECT_PLUGIN_CONTAINER+"."+a.active),n=t.length-1;n>=0;n--)i.removeClass(t[n],a.active)},selectOption:function(e){var t=s.getContainerFromDom(e);if(t){var n=t.querySelectorAll("."+o.CLASS.SELECT_PLUGIN_OPTIONS_ITEM+"."+a.selected);if(n!==e){t.value=e.getAttribute("value"),i.removeClass(n,a.selected),i.addClass(e,a.selected);var l=s.getHeaderText(t);l.textContent=e.textContent,s.hideOptions(t),r.event.call(o.EVENT.ON_SELECT_PLUGIN_CHANGE,t)}}},showOptions:function(e){var t=s.getContainerFromDom(e);return i.hasClass(t,a.active)?void s.hideOptions(t):(s.hideOptions(),void i.addClass(t,a.active))}},c={on:function(){l.bind()},off:function(){l.unbind()},create:function(e,t,n){var l,s,c,d,u,f=r.doc.createElement("div"),g=r.doc.createElement("div"),m=r.doc.createElement("span"),p=r.doc.createElement("i"),h=r.doc.createElement("ul");for(g.appendChild(m),g.appendChild(p),f.appendChild(g),f.appendChild(h),s=0,c=e.length;s<c;s++)d=e[s].text,u=e[s].value,l=r.doc.createElement("li"),l.textContent=d,i.attr(l,{value:u,"data-index":s}),u===n&&(m.textContent=d,f.value=u,i.addClass(l,a.selected)),i.addClass(l,o.CLASS.SELECT_PLUGIN_OPTIONS_ITEM),h.appendChild(l);return i.addClass(p,"icon-down_arrow editor-icon"),i.addClass(m,o.CLASS.SELECT_PLUGIN_HEADER_TEXT),i.addClass(g,o.CLASS.SELECT_PLUGIN_HEADER),i.addClass(h,o.CLASS.SELECT_PLUGIN_OPTIONS),i.addClass(f,o.CLASS.SELECT_PLUGIN_CONTAINER+" "+t),i.attr(f,{onselectstart:"return false;"}),f},destory:function(){}};t.exports=c},{"../common/const":14,"../common/env":16,"./domBase":24}],27:[function(e,t,n){"use strict";var r=e("../common/xss"),o={xssFilter:function(){if("undefined"==typeof r)return null;var e=decodeURIComponent(location.pathname),t=e.lastIndexOf("/")+1,n=e.lastIndexOf(".");e=n>0?e.substring(t,n)+"_files":"";var o=/^((file|wiz(note)?):\/\/)|(index_files\/)|(data:image\/(?!svg))/,i="#",a=new RegExp("^("+i.escapeRegex()+(e?"|"+e.escapeRegex():"")+")","i"),l=/^(id|class|name|style|data|width|height)/i,s=new r.FilterXSS({onIgnoreTag:function(e,t,n){if(/script/gi.test(e))return r.escapeAttrValue(t);if(n.isClosing)return"</"+e+">";var o=r.parseAttr(t,function(t,n){return n=s.options.safeAttrValue(e,t,n,s),/^on/i.test(t)?"":n?t+'="'+n+'"':t});return o=/^<!/i.test(t)?"<!"+o:"<"+o,"/"===t[t.length-2]&&(o+="/"),o+=">"},onIgnoreTagAttr:function(e,t,n,r){return!/^object$/i.test(e)&&n&&l.test(t)?t+'="'+n+'"':""},safeAttrValue:function(e,t,n){return/^meta$/i.test(e)&&/^http-equiv$/i.test(t)&&/refresh/i.test(n)?"":"href"!==t&&"src"!==t||!o.test(n)&&!a.test(n)?r.safeAttrValue(e,t,n):r.escapeAttrValue(n)}});return s.options.whiteList.iframe=["src","scrolling"],s.options.whiteList.button=["title","type","value"],s.options.whiteList.object=[],function(e){return s.process(e)}}()};t.exports=o},{"../common/xss":23}],28:[function(e,t,n){"use strict";function r(){var e=[],t=m.getRange();if(!t)return e;var n=m.getRangeDetail(t.startContainer,t.startOffset).container,r=m.getRangeDetail(t.endContainer,t.endOffset).container,o=f.getBlockParent(n,!0);o&&o!==c.doc.body&&(n=o);var i=n===r?n:f.getParentRoot([n,r]);i!==c.doc.body&&(i=f.getBlockParent(i,!0)),f.isTag(i,["h1","h2","h3","h4","h5","h6"])&&e.push(i);var a,l=f.getIndexList(n).join("."),s=f.getIndexList(r).join(".");for(a=1;a<7;a++)e=e.concat(f.getListFromTagAndIndex("h"+a,i,l,s));return e}function o(){var e=[],t=m.getRange();if(!t)return e;for(var n,r,o,a,l,s,p,h,b,C,E,v,y=m.getRangeDetail(t.startContainer,t.startOffset).container,T=m.getRangeDetail(t.endContainer,t.endOffset).container,S=f.getBlockParent(y,!0),A=(f.getBlockParent(T,!0),f.getIndexList(T).join(".")),x=S;x&&(E=!1,a=!1,l=!1,s=!1,p=!1,h=!1,o=f.isBlock(x),v=f.getIndexList(x).join("."),!(u.compareVersion(v,A)>0)||!o&&b);){if(!o){if(a=3===x.nodeType&&u.isEmpty(x.nodeValue),b||a||(b=x),n=x.nextSibling){x=n;continue}E=!0}if(b&&(E||o)){for(C=x,x=c.doc.createElement("div"),E?f.after(x,C):f.before(x,C);b&&b!==x;)x.appendChild(b),b=b.nextSibling;e.push(x)}else if(o&&(s=!!f.getParentByClass(x,d.CLASS.CODE_CONTAINER,!0),s||(h=f.isWizDom(x),h||(p=!!f.getParentByClass(x,d.CLASS.TABLE_CONTAINER,!0))),!h&&!s&&!p))if(l=!!g.isLayer(x))e.push(x);else{if(r=i(x),r.hasBlock||!r.hasLine){x=x.firstChild;continue}if(f.isTag(x,"li")){for(n=c.doc.createElement("div"),f.after(n,x);x.firstChild;)n.appendChild(x.firstChild);x.appendChild(n),x=n}e.push(x)}for(b=null,C=null,n=x.nextSibling;!n&&x!==c.doc.body&&x.parentNode;)x=x.parentNode,n=x.nextSibling;x=n}return e}function i(e){var t,n,r,o=e.childNodes||[],i=!1,a=!1;for(t=0,n=o.length;t<n&&(r=o[t],f.isBlock(r)?i=!0:(1===r.nodeType||3===r.nodeType&&!f.isEmptyDom(r))&&(a=!0),!i||!a);t++);return{hasBlock:i,hasLine:a}}function a(e){var t=m.getRange();if(t){var n,i,a,l=m.getRangeDetail(t.startContainer,t.startOffset),s=m.getRangeDetail(t.endContainer,t.endOffset),d=f.getPreviousNode(l.container,!1)||c.doc.body,u=f.getNextNode(s.container,!1)||c.doc.body,g=r();for(n=0;n<g.length;n++)i=g[n],f.isTag(i,[e])||f.replaceTagName(i,e);var p=o();for(n=0;n<p.length;n++)a=p[n],f.replaceTagName(a,e);l.container.parentNode||(l={container:d,offset:f.getEndOffset(d)}),s.container.parentNode||(s={container:u,offset:0}),m.setRange(l.container,l.offset,s.container,s.offset)}}function l(e){return s(e)?(h.clearSubSup(),!1):c.doc.execCommand(e,!1)}function s(e){var t,n="subscript"===e?"sub":"sup",r=m.getRange();return r&&(t=m.getRangeDetail(r.startContainer,r.startOffset),t=t.container,t=f.getFirstDeepChild(t),t=f.getParentByTagName(t,n,!0)),!!t}var c=e("../common/env"),d=e("../common/const"),u=(e("../common/historyUtils"),e("../common/utils")),f=e("../domUtils/domExtend"),g=e("../todoUtils/todoUtils"),m=e("../rangeUtils/rangeExtend"),p={bind:function(){p.unbind(),c.event.add(d.EVENT.EXEC_COMMEND,p.handler.onExecCommand)},unbind:function(){c.event.remove(d.EVENT.EXEC_COMMEND,p.handler.onExecCommand)},handler:{onExecCommand:function(){h.execCommand.apply(this,arguments)}}},h={on:function(){p.bind()},off:function(){p.unbind()},clearSubSup:function(){var e,t,n,r,o,i,a,l=m.getRangeDomList({noSplit:!1});if(!l||0===l.list.length)return r=m.getRange(),void(r&&r.collapsed&&(o=f.createSpan(),o.innerHTML=d.FILL_CHAR+d.FILL_CHAR,r.insertNode(o),n=f.getParentByTagName(o,["sub","sup"],!0),n?(n=f.splitDomSingle(n,o),f.peelDom(n),m.setRange(o,1)):f.remove(o)));var s=f.getParentByTagName(l.list[0],["sub","sup"],!0);if(1===l.list.length)return n=f.splitDomSingle(s,l.list[0]),void(n?(i=n.firstChild,a=n.lastChild,f.peelDom(n),m.setRange(i,0,a,f.getEndOffset(a))):m.setRange(l.startDom,l.startOffset,l.endDom,l.endOffset));s&&f.splitDomBeforeSub(s,l.list[0]);var c=f.getParentByTagName(l.list[l.list.length-1],["sub","sup"],!0);c&&f.splitDomAfterSub(c,l.list[l.list.length-1]);var u=!1;for(e=0;e<l.list.length;e++)t=l.list[e],n=f.getParentByTagName(t,["sub","sup"],!0),0===e?i=t:e===l.list.length-1&&(a=t),n&&(0===e?i=n.firstChild:e===l.list.length-1&&(a=n.lastChild),f.peelDom(n),u=!0);u?m.setRange(i,0,a,f.getEndOffset(a)):m.fixRange(l)},execCommand:function(){var e,t,n,r=m.getRange();r&&r.collapsed&&(e=g.getMainByCaret(),t=g.getCheckbox(e),n=t?t.id:"");var o;o=/formatblock/i.test(arguments[0])?a(arguments[2]):/subscript|superscript/i.test(arguments[0])?l(arguments[0]):c.doc.execCommand.apply(c.doc,arguments);var i=arguments[0];if(/^(indent)|(outdent)|(insertOrderedList)|(insertUnorderedList)$/i.test(i)&&f.fixOrderList(),n&&(/^indent$/i.test(i)&&c.client.type.isIOS||/^outdent$/i.test(i))&&(/^outdent$/i.test(i)&&g.fixNewTodo(),t=c.doc.querySelector("#"+n),e=g.getMainFromChild(t),e&&g.isEmptyMain(e))){for(var s=g.getCheckbox(e);e.lastChild!==s;)e.removeChild(e.lastChild);var u=f.createSpan();f.after(u,s),u.innerHTML=d.FILL_CHAR+d.FILL_CHAR,m.setRange(u,1)}return f.fixFontSize(),c.event.call(d.EVENT.ON_EXEC_COMMAND),o},queryCommandState:function(e){var t;return t=/subscript|superscript/i.test(e)?s(e):c.doc.queryCommandState(e)}};t.exports=h},{"../common/const":14,"../common/env":16,"../common/historyUtils":17,"../common/utils":20,"../domUtils/domExtend":25,"../rangeUtils/rangeExtend":39,"../todoUtils/todoUtils":49}],29:[function(e,t,n){"use strict";function r(e,t){var n;n=c.win.getSelection(),t&&(s=-1,l=null,b=[]),h=!1,t&&c.win.find(e,!1,!1,!0)&&(l=o(e)),n.collapse(c.doc.body,c.doc.body.childNodes.length);for(var r=1;r++<101&&c.win.find(e,!1,!0);)o(e);h=!!c.doc.querySelector(d.TAG.TMP_HIGHLIGHT_TAG)||!!c.doc.querySelector(d.TAG.CODE_MIRROR+" ."+C.searching),h&&!t&&(n.collapse(document.body,0),n.extend(document.body,0))}function o(e){var t,n,r,o=c.win.getSelection();if(t=o.getRangeAt(0),g.getParentByTagName(t.startContainer,d.TAG.TMP_HIGHLIGHT_TAG))return t.collapse(!0),null;var i=f.getContainerFromChild(t.startContainer);if(i)i.state&&i.state.query===e||(f.highlight.search(i,e),l||(n=i.querySelector("."+C.searching)));else{for(n=document.createElement(d.TAG.TMP_HIGHLIGHT_TAG),g.addClass(n,C.searching),n.style.backgroundColor=m,r=t.extractContents();r.firstChild;)n.appendChild(r.firstChild);g.isEmptyDom(n)||t.insertNode(n)}return n}function i(){if(b=c.doc.querySelectorAll("."+C.searching),0!==b.length){var e,t;for(t=b.length-1;t>=0;t--)if(e=b[t],e===l)return void(s=t);s=0,l=b[0]}}function a(e){var t=s;if(0!==b.length){if(e>=b.length?e=0:e<0&&(e=b.length-1),e===t)return void(l.style.backgroundColor=p);b[t].style.backgroundColor=m,s=e,l=b[s],l.style.backgroundColor=p,l.scrollIntoViewIfNeeded&&l.scrollIntoViewIfNeeded()}}var l,s,c=e("./../common/env"),d=e("./../common/const"),u=e("./../common/utils"),f=e("./../codeUtils/codeUtils"),g=e("./../domUtils/domExtend"),m="yellow",p="#FF9632",h=!1,b=[],C={searching:"cm-searching"},E={on:function(e,t){if(E.off(),!e)return!1;u.isArray(e)||(e=[e]),e.length>1&&(t=!1);var n,o;for(n=0,o=e.length;n<o;n++)r(e[n],t);return t&&(i(),a(s)),h},off:function(){g.peelTag(d.TAG.TMP_HIGHLIGHT_TAG),f.highlight.clearAll()},next:function(){a(s+1)},previous:function(){a(s-1)}};t.exports=E},{"./../codeUtils/codeUtils":12,"./../common/const":14,"./../common/env":16,"./../common/utils":20,"./../domUtils/domExtend":25}],30:[function(e,t,n){"use strict";function r(e){var t=new RegExp("("+s.CLASS.IMG_NOT_DRAG+")|("+s.CLASS.IMG_ATTACHMENT+")","i"),n=!(!e||!d.isTag(e,"img")||t.test(e.className)||!e.src);if(!n)return n;var r;return l.readonly?(r=d.getParentByFilter(e,function(e){return e&&d.isTag(e,"a")&&/^(http|https|wiz|wiznote|wiznotecmd):/.test(e.getAttribute("href"))},!0),!r):(r=d.getParentByFilter(e,function(e){return e&&d.isTag(e,"a")&&/^(wiz|wiznote|wiznotecmd):open_attachment/.test(e.getAttribute("href"))},!0),!r)}function o(e){var t=e.target;if(r(t))return l.client.sendCmdToWiznote(s.CLIENT_EVENT.WizReaderClickImg,{src:t.src,imgList:l.client.type.isIOS?null:u.getAll(!0)}),c.stopEvent(e),!1}function i(e){var t=e.target;if(r(t)){var n,o=l.doc.querySelectorAll("img["+s.ATTR.IMG_EDITING+"]"),i={};for(i[s.ATTR.IMG_EDITING]="",n=o.length-1;n>=0;n--)d.attr(o[n],i);i[s.ATTR.IMG_EDITING]=1,d.attr(t,i),l.client.sendCmdToWiznote(s.CLIENT_EVENT.WizEditorClickImg,{src:t.src})}}function a(){}var l=e("./../common/env"),s=e("./../common/const"),c=e("./../common/utils"),d=e("./../domUtils/domExtend"),u=e("./imgUtils"),f={bind:function(){f.unbind(),l.client.type.isIOS||l.client.type.isAndroid?l.event.add(s.EVENT.ON_CLICK,f.handler.onClick):l.readonly&&(l.client.type.isWin||l.client.type.isMac||l.client.type.isLinux)&&l.event.add(s.EVENT.ON_DBLCLICK,f.handler.onClick)},unbind:function(){l.event.remove(s.EVENT.ON_CLICK,f.handler.onClick)},handler:{onClick:function(e){l.readonly?o(e):l.client.type.isAndroid&&i(e)}}},g={init:a,bind:f.bind,unbind:f.unbind};t.exports=g},{"./../common/const":14,"./../common/env":16,"./../common/utils":20,"./../domUtils/domExtend":25,"./imgUtils":33}],31:[function(e,t,n){"use strict";var r=e("./../common/env"),o=e("./imgResize"),i=e("./imgClick"),a={on:function(){r.client.type.isPhone||r.client.type.isPad||(o.init(),o.bind()),i.init(),i.bind()},off:function(){r.client.type.isPhone||r.client.type.isPad||o.unbind(),i.unbind()},setImgFullPath:function(){var e,t,n,o=r.doc.querySelectorAll("img"),i=new RegExp("^(\\.\\/)?"+r.options.indexFilesPath.escapeRegex()+"\\/","i");for(e=o.length-1;e>=0;e--)t=o[e],n=t.getAttribute("src"),i.test(n)&&t.setAttribute("src",n.replace(i,r.options.indexFilesFullPath))}};t.exports=a},{"./../common/env":16,"./imgClick":30,"./imgResize":32}],32:[function(e,t,n){"use strict";function r(){S=x.doc.body.style.cursor||"",x.win.WizImgResizeOnGetHTML=function(){}}function o(e){if(e&&e.tagName&&"img"==e.tagName.toLowerCase()&&g(e)){var t=a();t&&(c(e),f(e),M.bindContainer(t))}}function i(){d(),u(),T=null,x.doc.body.style.cursor=S}function a(){var e=l();if(e)return e;e=x.doc.createElement(O.TAG.TMP_TAG),N.addClass(e,O.CLASS.IMG_RESIZE_CONTAINER),e.setAttribute("contenteditable","false"),e.setAttribute(R,"unsave");for(var t=0;t<D.length;t++){var n=x.doc.createElement("div");N.addClass(n,O.CLASS.IMG_RESIZE_HANDLE),N.addClass(n,D[t]),N.attr(n,{"data-type":D[t]}),e.appendChild(n)}return x.doc.body.appendChild(e),e}function l(){var e=x.doc.body.querySelector("."+O.CLASS.IMG_RESIZE_CONTAINER);return!e||e.length<1?null:e}function s(e,t){if(e&&t){var n=e.offset,r=n.left,o=n.top,i=e.width,a=e.height,l=t.getAttribute("data-type"),s=0,c=0;switch(l){case"lt":s=r-7,c=o-7;break;case"tm":s=r+(i-7)/2,c=o-7;break;case"rt":s=r+i,c=o-7;break;case"rm":s=r+i,c=o+(a-7)/2;break;case"rb":s=r+i,c=o+a;break;case"bm":s=r+(i-7)/2,c=o+a;break;case"lb":s=r-7,c=o+a;break;case"lm":s=r-7,c=o+(a-7)/2}N.css(t,{left:s+"px",top:c+"px"})}}function c(e){if(e){var t=l();if(t)for(var n=t.querySelectorAll("."+O.CLASS.IMG_RESIZE_HANDLE),r={offset:N.getOffset(e),width:e.width,height:e.height},o=0;o<n.length;o++){var i=n[o];s(r,i),i.style.visibility="inherit"}}}function d(){var e=x.doc.querySelectorAll("."+O.CLASS.IMG_RESIZE_ACTIVE);if(e&&0!==e.length){var t;for(t=e.length-1;t>=0;t--)N.removeClass(e[t],O.CLASS.IMG_RESIZE_ACTIVE)}}function u(){var e=l();e&&(M.unbindContainer(e),N.remove(e))}function f(e){if(e){d(),N.addClass(e,O.CLASS.IMG_RESIZE_ACTIVE),e.attributes[O.ATTR.IMG_RATE]=e.width/e.height,T=e;var t=N.getIndex(e);w.setRange(e.parentNode,t,e.parentNode,t+1)}}function g(e){if(!e)return!1;var t=e.getAttribute("class");return!t||-1===t.indexOf(O.CLASS.IMG_NOT_DRAG)}function m(e){var t=l();t&&(t.style.display=e?"block":"none",e||i())}function p(e,t,n,r){if(r){
var o=n*e,i=t/e;o<t?o=t:i=n,r.width=o,r.height=i}}var h,b,C,E,v,y,T,S,A,x=e("./../common/env"),O=e("./../common/const"),_=e("./../common/utils"),N=e("./../domUtils/domExtend"),w=e("../rangeUtils/rangeExtend"),D=["lt","tm","rt","rm","rb","bm","lb","lm"],L="",R="wiz_style",I=!1,k=null,M={bind:function(){M.unbind(),x.event.add(O.EVENT.BEFORE_GET_DOCHTML,M.handler.beforeGetDocHtml),x.event.add(O.EVENT.ON_CUT,M.handler.onCut),x.event.add(O.EVENT.ON_KEY_DOWN,M.handler.onKeyDown),x.event.add(O.EVENT.ON_MOUSE_DOWN,M.handler.onMouseDown),x.event.add(O.EVENT.ON_MOUSE_MOVE,M.handler.onMouseMove),x.event.add(O.EVENT.ON_MOUSE_UP,M.handler.onMouseUp)},bindContainer:function(e){M.unbindContainer(e),e.addEventListener("mousedown",M.handler.onContainerMouseDown)},unbind:function(){x.event.remove(O.EVENT.BEFORE_GET_DOCHTML,M.handler.beforeGetDocHtml),x.event.remove(O.EVENT.ON_CUT,M.handler.onCut),x.event.remove(O.EVENT.ON_KEY_DOWN,M.handler.onKeyDown),x.event.remove(O.EVENT.ON_MOUSE_DOWN,M.handler.onMouseDown),x.event.remove(O.EVENT.ON_MOUSE_MOVE,M.handler.onMouseMove),x.event.remove(O.EVENT.ON_MOUSE_UP,M.handler.onMouseUp)},unbindContainer:function(e){e.removeEventListener("mousedown",M.handler.onContainerMouseDown)},handler:{beforeGetDocHtml:function(){i()},onCut:function(e){m(!1)},onKeyDown:function(e){var t,n,r=e.keyCode||e.which;!T||8!==r&&46!==r||(t=T.parentNode,t&&(n=N.getIndex(T),w.setRange(t,n,t,n+1))),m(!1)},onContainerMouseDown:function(e){var t=e.target||e.srcElement;L=t.getAttribute("data-type");var n,r,o,i=x.doc.querySelector("."+O.CLASS.IMG_RESIZE_ACTIVE);if(i){switch(n=e.pageX,r=e.pageY,o=N.getOffset(i),L){case"lt":h=o.left-n,b=o.top-r,v=o.left+i.width,y=o.top+i.height,A="nw-resize";break;case"tm":h=void 0,b=o.top-r,A="n-resize";break;case"rt":h=n-i.width-o.left,b=o.top-r,v=o.left,y=o.top+i.height,A="ne-resize";break;case"rm":h=n-i.width-o.left,b=void 0,A="e-resize";break;case"rb":h=n-i.width-o.left,b=r-i.height-o.top,A="se-resize";break;case"bm":h=void 0,b=r-i.height-o.top,v=o.left/2,y=o.top,A="s-resize";break;case"lb":h=o.left-n,b=r-i.height-o.top,v=o.left+i.width,y=o.top,A="sw-resize";break;case"lm":h=o.left-n,b=void 0,A="w-resize"}_.stopEvent(e)}},onDrop:function(e){x.doc.removeEventListener("drop",M.handler.onDrop),T===k&&i(),I=!1,k=null},onMouseDown:function(e){var t=e.target||e.srcElement;N.isTag(t,"img")?(I=!0,k=t,x.doc.addEventListener("drop",M.handler.onDrop)):(I=!1,k=null),e.target!==T&&(m(!1),d())},onMouseMove:function(e){var t,n,r,o,i,a=e.target||e.srcElement;if(a&&a===k&&(o=N.getIndex(e.target),i=a,w.setRange(i.parentNode,o,i.parentNode,o+1)),i=x.doc.querySelector("."+O.CLASS.IMG_RESIZE_ACTIVE),i&&(t=N.getOffset(i),L)){n=e.pageX,r=e.pageY,x.doc.body.style.cursor=A;var l,s,d,u,f;switch(C&&E||(C=n,E=r),L){case"tm":i.width=i.width,r<t.top?i.height+=E-r:(f=i.height-(r-E)-b,i.height=f<0?0:f);break;case"rm":u=n-t.left-h,i.width=u<0?0:u,i.height=i.height,i.attributes[O.ATTR.IMG_RATE]=i.width/i.height;break;case"bm":i.width=i.width,f=r-y-b,i.height=f<0?0:f,i.attributes[O.ATTR.IMG_RATE]=i.width/i.height;break;case"lm":i.height=i.height,n<t.left?i.width+=C-n:(u=i.width-(n-C)-h,i.width=u<0?0:u);break;case"lt":l=Number(i.attributes[O.ATTR.IMG_RATE]),s=v-n,d=y-r,s-=h,d-=b,s=s<0?0:s,d=d<0?0:d,p(l,s,d,i);break;case"rt":l=Number(i.attributes[O.ATTR.IMG_RATE]),s=n-v,d=y-r,s-=h,d-=b,s=s<0?0:s,d=d<0?0:d,p(l,s,d,i);break;case"lb":l=Number(i.attributes[O.ATTR.IMG_RATE]),s=v-n,d=r-y,s-=h,d-=b,s=s<0?0:s,d=d<0?0:d,p(l,s,d,i);break;case"rb":l=Number(i.attributes[O.ATTR.IMG_RATE]),s=n-t.left,d=r-t.top,s-=h,d-=b,s=s<0?0:s,d=d<0?0:d,p(l,s,d,i)}if(i.style.cssText){var g=i.style.cssText;g=g.replace(/width:\s*\d+.?\d+px;?/gi,"width: "+i.width+"px").replace(/height:\s*\d+.?\d+px;?/gi,"height: "+i.height+"px"),i.style.cssText=g}C=n,E=r,c(i),x.event.call(O.EVENT.UPDATE_RENDER,null)}},onMouseUp:function(e){x.doc.removeEventListener("drop",M.handler.onDrop),I=!1,k=null;var t=e.target||e.srcElement;N.isTag(t,"img")&&o(t),L="",C=void 0,E=void 0,v=void 0,y=void 0,h=void 0,b=void 0,x.doc.body.style.cursor=S}}},B={init:r,bind:M.bind,unbind:M.unbind};t.exports=B},{"../rangeUtils/rangeExtend":39,"./../common/const":14,"./../common/env":16,"./../common/utils":20,"./../domUtils/domExtend":25}],33:[function(e,t,n){"use strict";function r(e,t){if(!e||e.className&&e.className.indexOf("wiz-todo")>-1)return!1;var n=e.src;if(!n)return!1;var r,o=/^(http|https|ftp):/,i=/^(data):/;return r=!i.test(n),r&&t?!o.test(n):r}var o=e("./../common/env"),i=e("./../common/const"),a=e("./../domUtils/domBase"),l={getAll:function(e){var t,n,i=o.doc.images,a=[],l={};for(t in i)i.hasOwnProperty(t)&&(n=decodeURIComponent(i[t].src),r(i[t],e)&&!l[n]&&(a.push(n),l[n]=!0));return a},getImageSize:function(e){var t=new Image;t.src=e;var n=t.height,r=t.width;return{width:r,height:n}},getImageData:function(e){var t=l.getImageSize(e.src),n=o.doc.createElement("canvas");n.width=t.width,n.height=t.height;var r=n.getContext("2d");r.drawImage(e,0,0);var i=n.toDataURL("image/png");return i.replace(/^data:image\/(png|jpg);base64,/,"")},makeAttachmentDom:function(e,t){var n,r,l,s=[];return n=o.doc.createElement("div"),n.style.margin="10px auto",r=o.doc.createElement("a"),r.href="wiz://open_attachment?guid="+e,l=o.doc.createElement("img"),l.src=t,l.style.verticalAlign="bottom",l.style.maxWidth="280px",a.addClass(l,i.CLASS.IMG_ATTACHMENT),r.appendChild(l),n.appendChild(r),s.push(n),n=o.doc.createElement("div"),n.appendChild(o.doc.createElement("br")),s.push(n),s},makeDomByPath:function(e){var t,n,r,i,a=[],l=[];for(e.indexOf("*")?l=e.split("*"):l.push(e),r=0,i=l.length;r<i;r++)t=o.doc.createElement("div"),a.push(t),n=o.doc.createElement("img"),n.src=l[r],n.style.verticalAlign="bottom",n.style.maxWidth="100%",t.insertBefore(n,null),t=o.doc.createElement("div"),t.insertBefore(o.doc.createElement("br"),null),a.push(t);return a},remove:function(e){var t,n,r=o.doc.querySelectorAll(e);for(n=r.length-1;n>=0;n--)t=r[n],t.parentElement.removeChild(t)},replaceSrc:function(e,t){var n,r,l=o.doc.querySelectorAll(e),s={};for(s[i.ATTR.IMG_EDITING]="",r=l.length-1;r>=0;r--)n=l[r],n.src=t,a.attr(n,s)}};t.exports=l},{"./../common/const":14,"./../common/env":16,"./../domUtils/domBase":24}],34:[function(e,t,n){"use strict";var r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r="object"===("undefined"==typeof n?"undefined":o(n))&&"function"==typeof e?n:{},function(){function e(e){return e}function t(e){return!1}function n(){}function o(){}n.prototype={chain:function(t,n){var r=this[t];if(!r)throw new Error("unknown hook "+t);r===e?this[t]=n:this[t]=function(e){var t=Array.prototype.slice.call(arguments,0);return t[0]=r.apply(null,t),n.apply(null,t)}},set:function(e,t){if(!this[e])throw new Error("unknown hook "+e);this[e]=t},addNoop:function(t){this[t]=e},addFalse:function(e){this[e]=t}},r.HookCollection=n,o.prototype={set:function(e,t){this["s_"+e]=t},get:function(e){return this["s_"+e]}},r.Converter=function(t){function r(e){return e=e.replace(/^[ ]{0,3}\[([^\[\]]+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(\n+)/gm,function(e,t,n,r,o,i,a){return t=t.toLowerCase(),z.set(t,_(n)),o?r+a:(i&&U.set(t,i.replace(/"/g,"&quot;")),"")})}function i(e){return e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,l),e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,l),e=e.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,l),e=e.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,l),e=e.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,l)}function a(e){return e=e.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(F.push(e)-1)+"K\n\n"}function l(e,t){return a(t)}function s(e,t,n){e=P.preBlockGamut(e,W),e=h(e);var r="<hr />\n";return e=e.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,r),e=e.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,r),e=e.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,r),e=b(e),e=v(e),e=x(e),e=P.postBlockGamut(e,W),e=i(e),e=O(e,t,n)}function c(e){return e=P.preSpanGamut(e),e=y(e),e=d(e),e=N(e),e=g(e),e=u(e),e=D(e),e=e.replace(/~P/g,"://"),e=_(e),e=V(e),e=e.replace(/  +\n/g," <br>\n"),e=P.postSpanGamut(e)}function d(e){var t=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;return e=e.replace(t,function(e){var t=e.replace(/(.)<\/?code>(?=.)/g,"$1`");return t=M(t,"!"==e.charAt(1)?"\\`*_/":"\\`*_")})}function u(e){return e.indexOf("[")===-1?e:(e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,f),e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()\s])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,f),e=e.replace(/(\[([^\[\]]+)\])()()()()()/g,f))}function f(e,t,n,r,o,i,a,l){void 0==l&&(l="");var s=t,c=n.replace(/:\/\//g,"~P"),d=r.toLowerCase(),u=o,f=l;if(""==u)if(""==d&&(d=c.toLowerCase().replace(/ ?\n/g," ")),u="#"+d,void 0!=z.get(d))u=z.get(d),void 0!=U.get(d)&&(f=U.get(d));else{if(!(s.search(/\(\s*\)$/m)>-1))return s;u=""}u=k(u);var g='<a href="'+u+'"';return""!=f&&(f=m(f),f=M(f,"*_"),g+=' title="'+f+'"'),g+=">"+c+"</a>"}function g(e){return e.indexOf("![")===-1?e:(e=e.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,p),e=e.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,p))}function m(e){return e.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function p(e,t,n,r,o,i,a,l){var s=t,c=n,d=r.toLowerCase(),u=o,f=l;if(f||(f=""),""==u){if(""==d&&(d=c.toLowerCase().replace(/ ?\n/g," ")),u="#"+d,void 0==z.get(d))return s;u=z.get(d),void 0!=U.get(d)&&(f=U.get(d))}c=M(m(c),"*_[]()"),u=M(u,"*_");var g='<img src="'+u+'" alt="'+c+'"';return f=m(f),f=M(f,"*_"),g+=' title="'+f+'"',g+=" />"}function h(e){return e=e.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(e,t){return"<h1>"+c(t)+"</h1>\n\n"}),e=e.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(e,t){return"<h2>"+c(t)+"</h2>\n\n"}),e=e.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(e,t,n){var r=t.length;return"<h"+r+">"+c(n)+"</h"+r+">\n\n"})}function b(e,t){e+="~0";var n,r=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]*?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return H?e=e.replace(r,function(e,r,o){var i=r;n=C(o);var a=E(i,n,t),l=a.list_str.replace(/\s+$/,""),s="<"+n;return l=s+">"+l+"</"+a.list_type+">\n\n",n=a.list_type,l}):(r=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,e=e.replace(r,function(e,t,r,o){var i=t,a=r;n=C(o);var l=E(a,n),s="<"+n,c=i+s+">\n"+l.list_str+"</"+l.list_type+">\n\n";return n=l.list_type,c})),e=e.replace(/~0/,"")}function C(e){return e.search(/[*+-]/g)>-1?"ul":"ol"}function E(e,t,n){H++,e=e.replace(/\n{2,}$/,"\n"),e+="~0";var r=new RegExp("(^[ \\t]*)([*+-]|\\d+[.])[ \\t]+([^\\r]*?(\\n+))(?=(~0|\\1([*+-]|\\d+[.])[ \\t]+))","gm"),o=!1;return e=e.replace(r,function(e,n,r,i){var a=i,l=C(r),c=/\n\n$/.test(a),d=c||a.search(/\n{2,}/)>-1,u=/^\[( |x)\]/.test(a),f=d||o;a=s(R(a),!0,!f);var g="";return l!=t&&(g="</"+t+">\n<"+l+">\n",t=l),g+=u?"<li class='wiz-md-todo-list-item'>":"<li>",g+=a+"</li>\n",o=c,g}),e=e.replace(/~0/g,""),H--,{list_str:e,list_type:t}}function v(e){return e+="~0",e=e.replace(/(?:\n\n|^\n?)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(e,t,n){var r=t,o=n;return r=T(R(r)),r=I(r),r=r.replace(/^\n+/g,""),r=r.replace(/\n+$/g,""),r="<pre><code>"+r+"\n</code></pre>","\n\n"+r+"\n\n"+o}),e=e.replace(/~0/,"")}function y(e){return e=e.replace(/(^|[^\\`])(`+)(?!`)([^\r]*?[^`])\2(?!`)/gm,function(e,t,n,r,o){var i=r;return i=i.replace(/^([ \t]*)/g,""),i=i.replace(/[ \t]*$/g,""),i=T(i),i=i.replace(/:\/\//g,"~P"),t+"<code>"+i+"</code>"})}function T(e){return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=M(e,"*_{}[]\\",!1)}function S(e){return e.indexOf("*")===-1&&e.indexOf("_")===-1?e:(e=G(e),e=e.replace(/(^|[\W_])(?:(?!\1)|(?=^))(\*|_)\2(?=\S)([^\r]*?\S)\2\2(?!\2)(?=[\W_]|$)/g,"$1<strong>$3</strong>"),e=e.replace(/(^|[\W_])(?:(?!\1)|(?=^))(\*|_)(?=\S)((?:(?!\2)[^\r])*?\S)\2(?!\2)(?=[\W_]|$)/g,"$1<em>$3</em>"),Y(e))}function A(e){return e.indexOf("*")===-1&&e.indexOf("_")===-1?e:(e=G(e),e=e.replace(/(?=[^\r][*_]|[*_])(^|(?=\W__|(?!\*)[\w\W_]\*\*|\w\*\*\w)[^\r])(\*\*|__)(?!\2)(?=\S)((?:|[^\r]*?(?!\2)[^\r])(?=\S_|\w|.\*\*(?:[\w\W_]|$)).)(?=__(?:\W|$)|\*\*(?:[^*]|$))\2/g,"$1<strong>$3</strong>"),e=e.replace(/(?=[^\r][*_]|[*_])(^|(?=\W_|(?!\*)(?:[\w\W_]\*|\D\*(?=\w)\D))[^\r])(\*|_)(?!\2\2\2)(?=\S)((?:(?!\2)[^\r])*?(?=[^\s_]_|(?=[\w\W])\D\*\D|[^\s*]\*(?:[\w\W_]|$)).)(?=_(?:\W|$)|\*(?:[^*]|$))\2/g,"$1<em>$3</em>"),Y(e))}function x(e){return e=e.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(e,t){var n=t;return n=n.replace(/^[ \t]*>[ \t]?/gm,"~0"),n=n.replace(/~0/g,""),n=n.replace(/^[ \t]+$/gm,""),n=s(n),n=n.replace(/(^|\n)/g,"$1  "),n=n.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(e,t){var n=t;return n=n.replace(/^  /gm,"~0"),n=n.replace(/~0/g,"")}),a("<blockquote>\n"+n+"\n</blockquote>")})}function O(e,t,n){e=e.replace(/^\n+/g,""),e=e.replace(/\n+$/g,"");for(var r=e.split(/\n{2,}/g),o=[],i=/~K(\d+)K/,a=r.length,l=0;l<a;l++){var s=r[l];i.test(s)?o.push(s):/\S/.test(s)&&(s=c(s),s=s.replace(/^([ \t]*)/g,n?"":"<p>"),n||(s+="</p>"),o.push(s))}if(!t){a=o.length;for(var l=0;l<a;l++)for(var d=!0;d;)d=!1,o[l]=o[l].replace(/~K(\d+)K/g,function(e,t){return d=!0,F[t]})}return o.join("\n\n")}function _(e){return e=e.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),e=e.replace(/<(?!([a-z\/?!][^<>]*>)|~D)/gi,"&lt;")}function N(e){return e=e.replace(/\\(\\)/g,B),e=e.replace(/\\([`*_{}\[\]()>#+-.!])/g,B)}function w(e,t,n,r,o,i){if(/^<[^<>]*(https?|ftp)/.test(i))return e;if(t)return e;if(")"!==r.charAt(r.length-1))return"<"+n+r+">";for(var a=r.match(/[()]/g),l=0,s=0;s<a.length;s++)"("===a[s]?l<=0?l=1:l++:l--;var c="";if(l<0){var d=new RegExp("\\){1,"+-l+"}$");r=r.replace(d,function(e){return c=e,""})}if(c){var u=r.charAt(r.length-1);Z.test(u)||(c=u+c,r=r.substr(0,r.length-1))}return"<"+n+r+">"+c}function D(e){e=e.replace(K,w);var t=function(e,t){var n=k(t);return'<a href="'+n+'">'+P.plainLinkText(t)+"</a>"};return e=e.replace(/<((https?|ftp):[^'">\s]+)>/gi,t)}function L(e){return e=e.replace(/~E(\d+)E/g,function(e,t){var n=parseInt(t);return String.fromCharCode(n)})}function R(e){return e=e.replace(/^(\t|[ ]{1,4})/gm,"~0"),e=e.replace(/~0/g,"")}function I(e){if(!/\t/.test(e))return e;var t,n=["    ","   ","  "," "],r=0;return e.replace(/[\n\t]/g,function(e,o){return"\n"===e?(r=o+1,e):(t=(o-r)%4,r=o+1,n[t])})}function k(e){return e=m(e),e=M(e,"*_:()[]")}function M(e,t,n){var r="(["+t.replace(/([\[\]\\])/g,"\\$1")+"])";n&&(r="\\\\"+r);var o=new RegExp(r,"g");return e=e.replace(o,B)}function B(e,t){var n=t.charCodeAt(0);return"~E"+n+"E"}var P=this.hooks=new n;P.addNoop("plainLinkText"),P.addNoop("preConversion"),P.addNoop("postNormalization"),P.addNoop("preBlockGamut"),P.addNoop("postBlockGamut"),P.addNoop("preSpanGamut"),P.addNoop("postSpanGamut"),P.addNoop("postConversion");var z,U,F,H;t=t||{};var G=e,Y=e;t.nonAsciiLetters&&!function(){var e=/[Q\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376-\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0621-\u064a\u0660-\u0669\u066e-\u066f\u0671-\u06d3\u06d5\u06e5-\u06e6\u06ee-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07c0-\u07ea\u07f4-\u07f5\u07fa\u0904-\u0939\u093d\u0950\u0958-\u0961\u0966-\u096f\u0971-\u0972\u097b-\u097f\u0985-\u098c\u098f-\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc-\u09dd\u09df-\u09e1\u09e6-\u09f1\u0a05-\u0a0a\u0a0f-\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32-\u0a33\u0a35-\u0a36\u0a38-\u0a39\u0a59-\u0a5c\u0a5e\u0a66-\u0a6f\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2-\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0-\u0ae1\u0ae6-\u0aef\u0b05-\u0b0c\u0b0f-\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32-\u0b33\u0b35-\u0b39\u0b3d\u0b5c-\u0b5d\u0b5f-\u0b61\u0b66-\u0b6f\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99-\u0b9a\u0b9c\u0b9e-\u0b9f\u0ba3-\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0be6-\u0bef\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58-\u0c59\u0c60-\u0c61\u0c66-\u0c6f\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0-\u0ce1\u0ce6-\u0cef\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60-\u0d61\u0d66-\u0d6f\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32-\u0e33\u0e40-\u0e46\u0e50-\u0e59\u0e81-\u0e82\u0e84\u0e87-\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa-\u0eab\u0ead-\u0eb0\u0eb2-\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0ed0-\u0ed9\u0edc-\u0edd\u0f00\u0f20-\u0f29\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1000-\u102a\u103f-\u1049\u1050-\u1055\u105a-\u105d\u1061\u1065-\u1066\u106e-\u1070\u1075-\u1081\u108e\u1090-\u1099\u10a0-\u10c5\u10d0-\u10fa\u10fc\u1100-\u1159\u115f-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1681-\u169a\u16a0-\u16ea\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u17e0-\u17e9\u1810-\u1819\u1820-\u1877\u1880-\u18a8\u18aa\u1900-\u191c\u1946-\u196d\u1970-\u1974\u1980-\u19a9\u19c1-\u19c7\u19d0-\u19d9\u1a00-\u1a16\u1b05-\u1b33\u1b45-\u1b4b\u1b50-\u1b59\u1b83-\u1ba0\u1bae-\u1bb9\u1c00-\u1c23\u1c40-\u1c49\u1c4d-\u1c7d\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u203f-\u2040\u2054\u2071\u207f\u2090-\u2094\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2183-\u2184\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2c6f\u2c71-\u2c7d\u2c80-\u2ce4\u2d00-\u2d25\u2d30-\u2d65\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3006\u3031-\u3035\u303b-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31b7\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fc3\ua000-\ua48c\ua500-\ua60c\ua610-\ua62b\ua640-\ua65f\ua662-\ua66e\ua67f-\ua697\ua717-\ua71f\ua722-\ua788\ua78b-\ua78c\ua7fb-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8d0-\ua8d9\ua900-\ua925\ua930-\ua946\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa50-\uaa59\uac00-\ud7a3\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe33-\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]/g,t="Q".charCodeAt(0),n="A".charCodeAt(0),r="Z".charCodeAt(0),o="a".charCodeAt(0)-r-1;G=function(i){return i.replace(e,function(e){for(var i,a=e.charCodeAt(0),l="";a>0;)i=a%51+n,i>=t&&i++,i>r&&(i+=o),l=String.fromCharCode(i)+l,a=a/51|0;return"Q"+l+"Q"})},Y=function(e){return e.replace(/Q([A-PR-Za-z]{1,3})Q/g,function(e,i){for(var a,l=0,s=0;s<i.length;s++)a=i.charCodeAt(s),a>r&&(a-=o),a>t&&a--,a-=n,l=51*l+a;return String.fromCharCode(l)})}}();var V=t.asteriskIntraWordEmphasis?A:S;this.makeHtml=function(e){if(z)throw new Error("Recursive call to converter.makeHtml");return z=new o,U=new o,F=[],H=0,e=P.preConversion(e),e=e.replace(/~/g,"~T"),e=e.replace(/\$/g,"~D"),e=e.replace(/\r\n/g,"\n"),e=e.replace(/\r/g,"\n"),e="\n\n"+e+"\n\n",e=I(e),e=e.replace(/^[ \t]+$/gm,""),e=P.postNormalization(e),e=i(e),e=r(e),e=s(e),e=L(e),e=e.replace(/~D/g,"$$"),e=e.replace(/~T/g,"~"),e=P.postConversion(e),F=U=z=null,e};var W=function(e){return s(e)},j="[-A-Z0-9+&@#/%?=~_|[\\]()!:,.;]",q="[-A-Z0-9+&@#/%=~_|[\\])]",K=new RegExp('(="|<)?\\b(https?|ftp)(://'+j+"*"+q+")(?=$|\\W)","gi"),Z=new RegExp(q,"i")}}(),t.exports=r},{}],35:[function(e,t,n){"use strict";var r={};!function(){function e(e){return e.replace(/^\s+|\s+$/g,"")}function t(e){return e.replace(/\s+$/g,"")}function n(e){return e.replace(new RegExp("^(\\t|[ ]{1,4})","gm"),"")}function o(e,t){return e.indexOf(t)!=-1}function i(e,t){return e.replace(/<[^>]*>?/gi,function(e){return e.match(t)?e:""})}function a(e,t){for(var n={},r=0;r<e.length;r++)n[e[r]]=e[r];for(r=0;r<t.length;r++)n[t[r]]=t[r];var o=[];for(var i in n)n.hasOwnProperty(i)&&o.push(n[i]);return o}function l(e){return""!=e.charAt(0)&&(e=""+e),""!=e.charAt(e.length-1)&&(e+=""),e}function s(e){return""==e.charAt(0)&&(e=e.substr(1)),""==e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),e}function c(e,t){return i(d(e,t),h)}function d(e,t){var n=t.blockGamutHookCallback(e);return n=g(n),n=n.replace(/~D/g,"$$").replace(/~T/g,"~"),n=t.previousPostConversion(n)}function u(e){return e.replace(/\\\|/g,"~I").replace(/\\:/g,"~i")}function f(e){return e.replace(/~I/g,"|").replace(/~i/g,":")}function g(e){return e=e.replace(/~E(\d+)E/g,function(e,t){var n=parseInt(t);return String.fromCharCode(n)})}function m(e){return e.toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}function p(e,t){var n=t;return n=n.replace(/&\#8220;/g,'"'),n=n.replace(/&\#8221;/g,'"'),n=n.replace(/&\#8216;/g,"'"),n=n.replace(/&\#8217;/g,"'"),n=n.replace(/&\#8212;/g,"---"),n=n.replace(/&\#8211;/g,"--"),n=n.replace(/&\#8230;/g,"...")}var h=new RegExp(["^(<\\/?(a|abbr|acronym|applet|area|b|basefont|","bdo|big|button|cite|code|del|dfn|em|figcaption|","font|i|iframe|img|input|ins|kbd|label|map|","mark|meter|object|param|progress|q|ruby|rp|rt|s|","samp|script|select|small|span|strike|strong|","sub|sup|textarea|time|tt|u|var|wbr)[^>]*>|","<(br)\\s?\\/?>)$"].join(""),"i");Array.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1}),r.Extra=function(){this.converter=null,this.hashBlocks=[],this.footnotes={},this.usedFootnotes=[],this.attributeBlocks=!1,this.googleCodePrettify=!1,this.highlightJs=!1,this.codeMirror=!1,this.tableClass="",this.tabWidth=4},r.Extra.init=function(e,t){var n=new r.Extra,i=[],a=[],l=[],s=["unHashExtraBlocks"];return t=t||{},t.extensions=t.extensions||["all"],o(t.extensions,"all")&&(t.extensions=["tables","fenced_code_gfm","def_list","attr_list","footnotes","smartypants","todo_list","strikethrough","newlines"]),a.push("wrapHeaders"),o(t.extensions,"todo_list")&&a.push("todo_list"),o(t.extensions,"attr_list")&&(i.push("hashFcbAttributeBlocks"),a.push("hashHeaderAttributeBlocks"),s.push("applyAttributeBlocks"),n.attributeBlocks=!0),o(t.extensions,"fenced_code_gfm")&&(a.push("fencedCodeBlocks"),i.push("fencedCodeBlocks")),o(t.extensions,"tables")&&a.push("tables"),o(t.extensions,"def_list")&&a.push("definitionLists"),o(t.extensions,"footnotes")&&(i.push("stripFootnoteDefinitions"),a.push("doFootnotes"),s.push("printFootnotes")),o(t.extensions,"smartypants")&&s.push("runSmartyPants"),o(t.extensions,"strikethrough")&&l.push("strikethrough"),o(t.extensions,"newlines")&&l.push("newlines"),e.hooks.chain("postNormalization",function(e){return n.doTransform(i,e)+"\n"}),e.hooks.chain("preBlockGamut",function(e,t){return n.blockGamutHookCallback=t,e=u(e),e=n.doTransform(a,e)+"\n",e=f(e)}),e.hooks.chain("postSpanGamut",function(e){return n.doTransform(l,e)}),n.previousPostConversion=e.hooks.postConversion,e.hooks.chain("postConversion",function(e){return e=n.doTransform(s,e),n.hashBlocks=[],n.footnotes={},n.usedFootnotes=[],e}),"highlighter"in t&&(n.googleCodePrettify="prettify"===t.highlighter,n.highlightJs="highlight"===t.highlighter,n.codeMirror="codeMirror"===t.highlighter),"table_class"in t&&(n.tableClass=t.table_class),n.converter=e,n},r.Extra.prototype.doTransform=function(e,t){for(var n=0;n<e.length;n++)t=this[e[n]](t);return t},r.Extra.prototype.hashExtraBlock=function(e){return"\n<p>~X"+(this.hashBlocks.push(e)-1)+"X</p>\n"},r.Extra.prototype.hashExtraInline=function(e){return"~X"+(this.hashBlocks.push(e)-1)+"X"},r.Extra.prototype.unHashExtraBlocks=function(e){function t(){var r=!1;e=e.replace(/(?:<p>)?~X(\d+)X(?:<\/p>)?/g,function(e,t){r=!0;var o=parseInt(t,10);return n.hashBlocks[o]}),r===!0&&t()}var n=this;return t(),e},r.Extra.prototype.wrapHeaders=function(e){function t(e){return"\n"+e+"\n"}return e=e.replace(/^.+[ \t]*\n=+[ \t]*\n+/gm,t),e=e.replace(/^.+[ \t]*\n-+[ \t]*\n+/gm,t),e=e.replace(/^\#{1,6}[ \t]*.+?[ \t]*\#*\n+/gm,t)};var b="\\{[ \\t]*((?:[#.][-_:a-zA-Z0-9]+[ \\t]*)+)\\}",C=new RegExp("^(#{1,6}.*#{0,6})[ \\t]+"+b+"[ \\t]*(?:\\n|0x03)","gm"),E=new RegExp("^(.*)[ \\t]+"+b+"[ \\t]*\\n(?=[\\-|=]+\\s*(?:\\n|0x03))","gm"),v=new RegExp("^(```[ \\t]*[^{\\s]*)[ \\t]+"+b+"[ \\t]*\\n(?=([\\s\\S]*?)\\n```[ \\t]*(\\n|0x03))","gm");r.Extra.prototype.hashHeaderAttributeBlocks=function(e){function t(e,t,r){return"<p>~XX"+(n.hashBlocks.push(r)-1)+"XX</p>\n"+t+"\n"}var n=this;return e=e.replace(C,t),e=e.replace(E,t)},r.Extra.prototype.hashFcbAttributeBlocks=function(e){function t(e,t,r){return"<p>~XX"+(n.hashBlocks.push(r)-1)+"XX</p>\n"+t+"\n"}var n=this;return e.replace(v,t)},r.Extra.prototype.applyAttributeBlocks=function(e){var t=this,n=new RegExp('<p>~XX(\\d+)XX</p>[\\s]*(?:<(h[1-6]|pre)(?: +class="(\\S+)")?(>[\\s\\S]*?</\\2>))',"gm");return e=e.replace(n,function(e,n,r,o,i){if(!r)return"";for(var l=parseInt(n,10),s=t.hashBlocks[l],c=s.match(/#[^\s#.]+/g)||[],d=c[0]?' id="'+c[0].substr(1,c[0].length-1)+'"':"",u=s.match(/\.[^\s#.]+/g)||[],f=0;f<u.length;f++)u[f]=u[f].substr(1,u[f].length-1);var g="";return o&&(u=a(u,[o])),u.length>0&&(g=' class="'+u.join(" ")+'"'),"<"+r+d+g+i})},r.Extra.prototype.tables=function(t){function n(t,n,o,i,a,l){n=n.replace(/^ *[|]/m,""),o=o.replace(/^ *[|]/m,""),i=i.replace(/^ *[|]/gm,""),n=n.replace(/[|] *$/m,""),o=o.replace(/[|] *$/m,""),i=i.replace(/[|] *$/gm,"");for(var s=o.split(/ *[|] */),d=[],u=0;u<s.length;u++){var f=s[u];f.match(/^ *-+: *$/m)?d[u]=' align="right"':f.match(/^ *:-+: *$/m)?d[u]=' align="center"':f.match(/^ *:-+ *$/m)?d[u]=' align="left"':d[u]=""}var g=n.split(/ *[|] */),m=g.length,p=r.tableClass?' class="'+r.tableClass+'"':"",h=["<table",p,">\n","<thead>\n","<tr>\n"].join("");for(u=0;u<m;u++){var b=c(e(g[u]),r);h+=["  <th",d[u],">",b,"</th>\n"].join("")}h+="</tr>\n</thead>\n";var C=i.split("\n");for(u=0;u<C.length;u++)if(!C[u].match(/^\s*$/)){for(var E=C[u].split(/ *[|] */),v=m-E.length,y=0;y<v;y++)E.push("");for(h+="<tr>\n",y=0;y<m;y++){var T=c(e(E[y]),r);h+=["  <td",d[y],">",T,"</td>\n"].join("")}h+="</tr>\n"}return h+="</table>\n",r.hashExtraBlock(h)}var r=this,o=new RegExp(["^","[ ]{0,3}","[|]","(.+)\\n","[ ]{0,3}","[|]([ ]*[-:]+[-| :]*)\\n","(","(?:[ ]*[|].*\\n?)*",")","(?:\\n|$)"].join(""),"gm"),i=new RegExp(["^","[ ]{0,3}","(\\S.*[|].*)\\n","[ ]{0,3}","([-:]+[ ]*[|][-| :]*)\\n","(","(?:.*[|].*\\n?)*",")","(?:\\n|$)"].join(""),"gm");return t=t.replace(o,n),t=t.replace(i,n)},r.Extra.prototype.stripFootnoteDefinitions=function(e){var t=this;return e=e.replace(/\n[ ]{0,3}\[\^(.+?)\]\:[ \t]*\n?([\s\S]*?)\n{1,2}((?=\n[ ]{0,3}\S)|$)/g,function(e,n,r){return n=m(n),r+="\n",r=r.replace(/^[ ]{0,3}/g,""),t.footnotes[n]=r,"\n"})},r.Extra.prototype.doFootnotes=function(e){var t=this;if(t.isConvertingFootnote===!0)return e;var n=0;return e=e.replace(/\[\^(.+?)\]/g,function(e,r){var o=m(r),i=t.footnotes[o];if(void 0===i)return e;n++,t.usedFootnotes.push(o);var a='<a href="#fn_'+o+'" id="fnref_'+o+'" title="See footnote" class="footnote">'+n+"</a>";return t.hashExtraInline(a)})},r.Extra.prototype.printFootnotes=function(e){var t=this;if(0===t.usedFootnotes.length)return e;e+='\n\n<div class="footnotes">\n<hr>\n<ol>\n\n';for(var n=0;n<t.usedFootnotes.length;n++){var r=t.usedFootnotes[n],o=t.footnotes[r];t.isConvertingFootnote=!0;var i=c(o,t);delete t.isConvertingFootnote,e+='<li id="fn_'+r+'">'+i+' <a href="#fnref_'+r+'" title="Return to article" class="reversefootnote">&#8617;</a></li>\n\n'}return e+="</ol>\n</div>"},r.Extra.prototype.fencedCodeBlocks=function(e){function t(e){return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/~D/g,"$$"),e=e.replace(/~T/g,"~")}var n=this;return e=e.replace(/(?:^|\n)```[ \t]*(\S*)[ \t]*\n([\s\S]*?)\n```[ \t]*(?=\n)/g,function(e,r,o){var i,a=r.replace(";",",").split(","),l=o,s=a[0].trim();a.length>1&&(i=a[1].trim());var c,d,u;return"flow"===s||"sequence"===s?(d=' class="language-'+s+'"',u=['<pre><textarea readonly style="display:none;"',d,">",t(l),"</textarea></pre>"].join("")):n.codeMirror?u=['<div class="wiz-code-container" contenteditable="false"',' data-mode="',s,'" data-theme="',i,'"><textarea readonly style="display:none;">',t(l),"</textarea></div>"].join(""):(c=n.googleCodePrettify?' class="prettyprint linenums"':"",d="",s&&(d=n.codeMirror||n.googleCodePrettify||n.highlightJs?' class="language-'+s+'"':' class="'+s+'"'),u=["<pre",c,"><code",d,">",t(l),"</code></pre>"].join("")),n.hashExtraBlock(u)})},r.Extra.prototype.educatePants=function(e){var t=this,n="",r=0;e.replace(/(?:<!--[\s\S]*?-->)|(<)([a-zA-Z1-6]+)([^\n]*?>)([\s\S]*?)(<\/\2>)/g,function(o,i,a,l,s,c,d){var u=e.substring(r,d);return n+=t.applyPants(u),t.smartyPantsLastChar=n.substring(n.length-1),r=d+o.length,i?(/code|kbd|pre|script|noscript|iframe|math|ins|del|pre/i.test(a)?t.smartyPantsLastChar=s.substring(s.length-1):s=t.educatePants(s),void(n+=i+a+l+s+c)):void(n+=o)});var o=e.substring(r);return n+=t.applyPants(o),t.smartyPantsLastChar=n.substring(n.length-1),n},r.Extra.prototype.applyPants=function(e){return e=e.replace(/\.\.\./g,"&#8230;").replace(/\.\s\.\s\./g,"&#8230;")},r.Extra.prototype.runSmartyPants=function(e){return this.smartyPantsLastChar="",e=this.educatePants(e),e=e.replace(/(<([a-zA-Z1-6]+)\b([^\n>]*?)(\/)?>)/g,p)},r.Extra.prototype.definitionLists=function(t){var n=new RegExp(["(\\x02\\n?|\\n\\n)","(?:","(","(","[ ]{0,3}","((?:[ \\t]*\\S.*\\n)+)","\\n?","[ ]{0,3}:[ ]+",")","([\\s\\S]+?)","(","(?=\\0x03)","|","(?=","\\n{2,}","(?=\\S)","(?!","[ ]{0,3}","(?:\\S.*\\n)+?","\\n?","[ ]{0,3}:[ ]+",")","(?!","[ ]{0,3}:[ ]+",")",")",")",")",")"].join(""),"gm"),r=this;return t=l(t),t=t.replace(n,function(t,n,o){var i=e(r.processDefListItems(o));return i="<dl>\n"+i+"\n</dl>",n+r.hashExtraBlock(i)+"\n\n"}),s(t)},r.Extra.prototype.processDefListItems=function(r){var o=this,i=new RegExp(["(\\x02\\n?|\\n\\n+)","(","[ ]{0,3}","(?![:][ ]|[ ])","(?:\\S.*\\n)+?",")","(?=\\n?[ ]{0,3}:[ ])"].join(""),"gm"),a=new RegExp(["\\n(\\n+)?","(","[ ]{0,3}","[:][ ]+",")","([\\s\\S]+?)","(?=\\n*","(?:","\\n[ ]{0,3}[:][ ]|","<dt>|\\x03",")",")"].join(""),"gm");return r=l(r),r=r.replace(/\n{2,}(?=\\x03)/,"\n"),r=r.replace(i,function(t,n,r){for(var i=e(r).split("\n"),a="",l=0;l<i.length;l++){var s=i[l];s=c(e(s),o),a+="\n<dt>"+s+"</dt>"}return a+"\n"}),r=r.replace(a,function(e,r,i,a){return r||a.match(/\n{2,}/)?(a=Array(i.length+1).join(" ")+a,a=n(a)+"\n\n",a="\n"+d(a,o)+"\n"):(a=t(a),a=c(n(a),o)),"\n<dd>"+a+"</dd>\n"}),s(r)},r.Extra.prototype.todo_list=function(e){return e.replace(/^([ ]*)\[ \]/g,"$1<input type='checkbox' disabled class='wiz-md-todo-checkbox'>").replace(/^([ ]*)\[x\]/g,"$1<input type='checkbox' disabled checked class='wiz-md-todo-checkbox'>")},r.Extra.prototype.strikethrough=function(e){return e.replace(/~T~T(?=\S)([^\r]*?\S[\*_]*)~T~T/g,"<del>$1</del>")},r.Extra.prototype.newlines=function(e){return e.replace(/(<(?:br|\/li)>)?\n/g,function(e,t){
return t?e:" <br>\n"})}}(),t.exports=r.Extra},{}],36:[function(e,t,n){"use strict";function r(){var e=h.Document.createElement("span");e.innerHTML="<math>a</math>",e.style.opacity=0,h.Document.body.appendChild(e);var t=e.innerText;if(s.remove(e),!t)for(var n,r,o,i=h.Document.getElementsByTagName("math");i.length>0;)n=i[0],r=n.parentNode,o=h.Document.createElement("span"),o.innerText=n.textContent,r.insertBefore(o,n),r.removeChild(n)}var o=e("../common/env"),i=e("../common/utils"),a=e("../common/dependLoader"),l=e("../common/scriptLoader"),s=e("../domUtils/domBase"),c=e("../domUtils/xssUtils"),d=e("./Markdown.Converter"),u=e("./Markdown.Extra"),f=!1,g="#wizToc",m={markdown:function(){h.Win.prettyPrint(),h.tocRender(),h.flowRender(),h.sequenceRender()},mathJax:function(){}},p={init:function(){return h.Win=o.win,h.Document=o.doc,h.Dependency=o.dependency,p},markdown:function(e){e&&(h.callback.markdown=h.addCb(m.markdown,e.markdown),h.callback.mathJax=h.addCb(m.mathJax,e.mathJax)),a.loadCss(h.Document,a.getDependencyFiles(h.Dependency,"css","markdown")),a.loadJs(h.Document,a.getDependencyFiles(h.Dependency,"js","markdown"),function(){h.markdownConvert({}),f&&h.mathJaxRender()})},mathJax:function(e){e&&(h.callback.mathJax=h.addCb(m.mathJax,e)),h.mathJaxRender()}},h={Utils:i,Win:null,Document:null,Dependency:null,callback:{markdown:null,mathJax:null},addCb:function(e,t){return t?function(){e.apply(this,arguments),t.apply(this,arguments)}:e},cb:function(e,t){e&&e.apply(this,t?t:[])},getBodyTxt:function(e){r();var t=e.innerText;return t||(t=h.Utils.getInnerText(e)),t=t.replace(String.fromCharCode(65279),""),t.replace(/\u00a0/g," ")},markdownConvert:function(e){function t(e){return e=e.replace(/@@(\d+)@@/g,function(e,t){return s[t]}),s=null,e}function n(e,t){var n=l.slice(e,t+1).join("");if(!n.match(/`/i)){for(n=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");t>e;)l[t]="",t--;l[e]="@@"+s.length+"@@",s.push(n)}o=i=a=null}function r(e){o=i=a=null,s=[],l=e.replace(/\r\n?/g,"\n").split(m);for(var t,r=1,d=l.length;r<d;r+=2)t=l[r],g&&t.match(/\n|`/)?o=i=a=null:"@"===t.charAt(0)?(l[r]="@@"+s.length+"@@",s.push(t)):o?t===i?c?a=r:n(o,r):t.match(/\n.*\n/)?(a&&(r=a,n(o,r)),o=i=a=null,c=0):"{"===t?c++:"}"===t&&c&&c--:/^\$\$?$/.test(t)?(g=t.length<2,o=r,i=t,c=0):"begin"===t.substr(1,5)&&(o=r,i="\\end"+t.substr(6),c=0);return a&&n(o,a),l.join("")}var o,i,a,l,s,c,g=!1,m=/(\$\$?|\\(?:begin|end)\{[a-z]*\*?\}|\\[\\{}$]|[{}]|(?:\n\s*)+|@@\d+@@)/i,p=$(h.Document),b=e.container?e.container:p.find("body");b.addClass("markdown-body");var C,E=new d.Converter({nonAsciiLetters:!0,asteriskIntraWordEmphasis:!0});try{h.Utils.markdownPreProcess(b[0]),C=h.tocReady(h.getBodyTxt(b[0]));var v=/^```/gm,y=C.match(v);y=y?y.length/2:0,u.init(E,{extensions:"all",highlighter:y>50?"prettify":"codeMirror"});var T=C.replace(/\n/g,"\\n").replace(/\r\n?/g,"\n").replace(/```(.*\n)+?```/gm,"");f=/(\$\$?)[^$\n]+\1/.test(T),f&&(C=r(C)),C=E.makeHtml(C),f&&(C=t(C)),C=h.xssFilter(C),b[0].innerHTML=C}catch(e){console.error(e)}try{h.cb(h.callback.markdown,[f])}catch(e){console.error(e)}},tocReady:function(e){return e.replace(/(^[ ]*)\[toc\]([ ]*(\n|$))/gim,"$1[]("+g+")$2")},tocRender:function(){var e=h.Document.body,t=[],n=6;$("h1,h2,h3,h4,h5,h6",e).each(function(e,t){var r=parseInt(t.tagName.charAt(1),10);n=Math.min(n,r)}),$("h1,h2,h3,h4,h5,h6",e).each(function(e,r){var o=(r.textContent||r.innerText).replace(/\(\)<> '"/g,""),i=o,a=parseInt(r.tagName.charAt(1),10),l=$(r);l.attr("id",i),t.push('<a class="wiz_toc h'+(a-n+1)+'" href="#'+i+'">'+l.text()+"</a>")}),t='<div class="wiz_toc_layer">'+t.join("<br/>")+"</div>",$("a",e).each(function(e,n){n=$(n),n.attr("href")==g&&n.before(t)})},flowRender:function(){var e=$(".language-flow",h.Document.body).parents("pre");e.each(function(e,t){var n="wiz-flow-"+e,r=$("textarea",t).val();if(r.length>0)try{t.style.display="none";var i=h.Win.flowchart.parse(r),a=h.Document.createElement("div");if(a.id=n,t.parentNode.insertBefore(a,t),i.drawSVG(n),o.client.type.isPhone){var l=$("svg",a);l.attr("width")&&l.css({"max-width":l.attr("width")}).attr({height:null,width:"95%"})}}catch(e){console.error(e)}})},sequenceRender:function(){var e=$(".language-sequence",h.Document.body).parents("pre");e.each(function(e,t){var n="wiz-sequence-"+e,r=$("textarea",t).val();if(r.length>0)try{t.style.display="none";var i=h.Win.Diagram.parse(r),a=h.Document.createElement("div");if(a.id=n,t.parentNode.insertBefore(a,t),i.drawSVG(n,{theme:"simple"}),o.client.type.isPhone){var l=$("svg",a);l.attr("width")&&(l.get(0).setAttribute("viewBox","0 0 "+l.attr("width")+" "+l.attr("height")),l.css({"max-width":l.attr("width")}).attr({preserveAspectRatio:"xMidYMid meet",height:null,width:"95%"}))}}catch(e){console.error(e)}})},mathJaxRender:function(){function e(){h.Win._wizMathJaxCallback=function(){h.cb(h.callback.mathJax)};var e='MathJax.Hub.Queue(["Typeset", MathJax.Hub, document.body, _wizMathJaxCallback]);';l.appendJsCode(h.Document,e,"text/javascript")}var t='MathJax.Hub.Config({                            skipStartupTypeset: true,                            "HTML-CSS": {                                preferredFont: "TeX",                                availableFonts: [                                    "STIX",                                    "TeX"                                ],                                linebreaks: {                                    automatic: true                                },                                EqnChunk: 10,                                imageFont: null                            },                            SVG: { linebreaks: { automatic: true } },                            tex2jax: {                                inlineMath: [["$","$"],["\\\\\\\\(","\\\\\\\\)"]],                                displayMath: [["$$","$$"],["\\\\[","\\\\]"]],                                processEscapes: true },                            TeX: {                                equationNumbers: {                                    autoNumber: "AMS"                                },                                noUndefined: {                                    attributes: {                                        mathcolor: "red",                                        mathbackground: "#FFEEEE",                                        mathsize: "90%"                                    }                                },                                Safe: {                                    allow: {                                        URLs: "safe",                                        classes: "safe",                                        cssIDs: "safe",                                        styles: "safe",                                        fontsize: "all"                                    }                                }                            },                            messageStyle: "none"                        });';l.appendJsCode(h.Document,"MathJax = null","text/javascript"),l.appendJsCode(h.Document,t,"text/x-mathjax-config"),a.loadJs(h.Document,a.getDependencyFiles(h.Dependency,"js","mathJax"),e)},xssFilter:c.xssFilter};t.exports=p},{"../common/dependLoader":15,"../common/env":16,"../common/scriptLoader":19,"../common/utils":20,"../domUtils/domBase":24,"../domUtils/xssUtils":27,"./Markdown.Converter":34,"./Markdown.Extra":35}],37:[function(e,t,n){"use strict";function r(e,t,n){o(e,t,n);for(var i=t.children,a=0;a<i.length;a++){var l=i[a];r(t.id?t.id:e,l,n)}}function o(e,t,n){if(t){var r=t.tagName;if(!/^(style|script|link|meta|img)$/gi.test(r)&&!d.hasClass(t,s.CLASS.TODO_CHECKBOX)&&!d.hasClass(t,s.CLASS.TODO_AVATAR)){var o=t.className;if(o&&o.length>0)for(var l=o.split(" "),c=0;c<l.length;c++){var u=l[c];0!==u.length&&a("."+i(u),n)}var f=t.id;f&&f.length>0&&a("#"+i(f),n),e?a("#"+i(e)+" "+r,n):a(i(r),n)}}}function i(e){return e.replace(/ /g,"")}function a(e,t){t[e]||/^(\.|#)?[\d]+/i.test(e)||!/^(\.|#)?[\. \w-]+$/i.test(e)||(t[e]="")}var l=e("../common/env"),s=e("../common/const"),c=e("../common/wizStyle"),d=e("../domUtils/domBase"),u="#7990b6",f="#1f2126",g="50%",m="wiz_night_mode_style",p={on:function(e,t,n){e&&(u=e),t&&(f=t),n&&(g=n),p.off();var o={},i=[];r("",l.doc.body,o);var a="{color:"+u+" !important; background-color:"+f+" !important; background-image: none !important; box-shadow: none !important; border-color:"+u+" !important; }";for(var d in o)o.hasOwnProperty(d)&&i.push(d);var h=i.join(", ");h+=a,h+="img{filter: brightness("+g+");-webkit-filter: brightness("+g+");}",h+=s.TAG.TMP_HIGHLIGHT_TAG+"{background-color: #50a9fb !important;  color: black !important;}",c.insertStyle({id:m,name:s.NAME.TMP_STYLE},h)},off:function(){var e=l.doc.getElementById(m);e&&e.remove()}};t.exports=p},{"../common/const":14,"../common/env":16,"../common/wizStyle":21,"../domUtils/domBase":24}],38:[function(e,t,n){"use strict";var r,o=e("./../common/env"),i=e("./../common/const"),a=(e("./../common/base64"),e("./../domUtils/domBase")),l={caretFocus:function(){var e=l.getRange(),t=e?e.getClientRects():null,n=t&&t.length>0?t[0]:null,r=o.doc.documentElement.clientHeight,i=o.doc.documentElement.clientWidth;n&&n.top<0?o.doc.body.scrollTop+=n.top:n&&n.top+n.height>r&&(o.doc.body.scrollTop+=n.top+n.height-r),n&&n.left<0?o.doc.body.scrollLeft+=n.left:n&&n.left+n.width>i&&(o.doc.body.scrollLeft+=n.left+n.width-i)},clearFillCharByCollapsed:function(){var e,t,n,r=l.getRange();r&&r.collapsed&&3===r.startContainer.nodeType&&(e=r.startContainer,t=e.nodeValue.substr(0,r.startOffset),n=e.nodeValue.substr(r.startOffset),t=t.replace(i.FILL_CHAR_REG,""),n=n.replace(i.FILL_CHAR_REG,""),e.nodeValue=t+n,l.setRange(e,t.length))},fixScroll:function(){function e(){var e,t,n,r,i=l.getRange();if(i&&(i.collapsed||!o.client.type.isPhone&&!o.client.type.isPad)&&(e=l.getRangeClientRect())){t=a.getWindowSize();var s=t.height,c=0;o.client.type.isIOS&&(s=t.height),n=o.doc.body.scrollTop,r=o.doc.body.scrollLeft,o.client.type.isIOS&&e.top+c<0?o.doc.body.scrollTop=n+e.top+c:o.client.type.isIOS&&e.top+e.height>s-c?o.doc.body.scrollTop=n+e.top+e.height+c-s:!o.client.type.isIOS&&e.top<0?o.doc.body.scrollTop=n+e.top:!o.client.type.isIOS&&e.top+e.height>t.height&&(o.doc.body.scrollTop=n+e.top+e.height-t.height),e.left<r?o.doc.body.scrollLeft=r+e.left:e.left+e.width>t.width&&(o.doc.body.scrollLeft=r+e.left+e.width-t.width)}}r&&clearTimeout(r),r=setTimeout(e,30)},getFragmentForCopy:function(){var e=l.getRange(),t=null;return!e||e.collapsed?t:(t=o.doc.createElement("div"),t.appendChild(e.cloneContents()),a.fragmentFilterForCopy(t),a.css(t,{position:"absolute",top:"-99999px",left:"-99999px",overflow:"hidden"}),o.doc.body.appendChild(t),t)},getRange:function(){var e=o.doc.getSelection();return e.rangeCount>0?e.getRangeAt(0):null},getRangeAnchor:function(e){var t=l.getRange();if(!t)return null;var n=e?t.startContainer:t.endContainer,r=e?t.startOffset:t.endOffset;return t.collapsed||e?3===n.nodeType&&r<n.nodeValue.length?n:3===n.nodeType?a.getNextNode(n,!1,null):0===n.childNodes.length?n:r==n.childNodes.length?a.getNextNode(n.childNodes[r-1],!1,null):a.getFirstDeepChild(n.childNodes[r]):3===n.nodeType&&r>0?n:3===n.nodeType?a.getPreviousNode(n,!1,null):r>0?a.getLastDeepChild(n.childNodes[r-1]):a.getPreviousNode(n,!1,null)},getRangeClientRect:function(){var e=l.getRange();if(!e)return null;var t,n,r=e.getBoundingClientRect();return 0===r.width&&0===r.height&&(t=l.getRange().getClientRects(),t.length>0&&(r=t[0])),0===r.width&&0===r.height&&(n=e.startContainer,1===n.nodeType&&(n=n.childNodes[e.startOffset===n.childNodes.length?e.startOffset-1:e.startOffset],n.getBoundingClientRect&&(r=n.getBoundingClientRect(),r={bottom:r.bottom,height:r.height,left:r.left+r.width,right:r.right,top:r.top,width:0}))),r},getRangeDetail:function(e,t){var n=!1;return t>0&&t===a.getEndOffset(e)?(1===e.nodeType&&(e=a.getLastDeepChild(e.childNodes[t-1]),t=a.getEndOffset(e)),n=!0):1===e.nodeType&&(0===e.childNodes.length||t<e.childNodes.length&&(e=e.childNodes[t],t=0)),{container:e,offset:t,isEnd:n}},getRangeDomList:function(e){var t=l.getRange();if(!t)return null;var n=t.startContainer,r=t.startOffset,o=t.endContainer,i=t.endOffset,s=a.getListA2B({startDom:n,startOffset:r,endDom:o,endOffset:i,noSplit:!!e.noSplit});return s},getRangeParentRoot:function(){var e,t,n=l.getRange();return n?(e=n.startContainer,t=n.endContainer,a.getParentRoot([e,t])):null},isRangeEdge:function(e){var t={isStart:!1,isEnd:!1},n=l.getRange();if(n){t.isCollapsed=n.collapsed,t.startDom=n.startContainer,t.startOffset=n.startOffset,t.endDom=n.endContainer,t.endOffset=n.endOffset;var r,o;return 1==t.startDom.nodeType&&t.startOffset<t.startDom.childNodes.length?r=a.getFirstDeepChild(t.startDom.childNodes[t.startOffset]):1==t.startDom.nodeType&&(r=a.getNextNode(t.startDom.childNodes[t.startOffset-1],!1,null)),1==t.endDom.nodeType&&t.endOffset>0?o=a.getLastDeepChild(t.endDom.childNodes[t.endOffset-1]):1==t.endDom.nodeType&&(o=a.getPreviousNode(t.endDom,!1,null)),t.isStart=t.startDom==e||t.startDom==r,t.isEnd=t.endDom==e||t.endDom==o,t}},moveToPoint:function(e,t){var n,r,i;o.doc.caretPositionFromPoint?(n=o.doc.caretPositionFromPoint(e,t),r=n.offsetNode,i=n.offset):o.doc.caretRangeFromPoint&&(n=o.doc.caretRangeFromPoint(e,t),r=n.startContainer,i=n.startOffset),l.setRange(r,i)},selectElementContents:function(e){var t=o.doc.createRange();t.selectNodeContents(e);var n=o.doc.getSelection();n.removeAllRanges(),n.addRange(t)},selectCharIncludeFillChar:function(e){var t,n,r,s,c=o.doc.getSelection(),d=c.getRangeAt(0),u=e?"backward":"forward";if(1===d.startContainer.nodeType){if(t=l.getRangeAnchor(!1),d.startContainer==t&&a.isTag(t,"br")&&a.isEmptyDom(t.parentNode))return void(t.parentNode.nextSibling?l.setRange(t.parentNode,0,t.parentNode.nextSibling,0):(c.modify("move","forward","character"),c.modify("extend","backward","character"),t.nextSibling&&c.modify("extend","backward","character")));a.isTag(t,"br")&&c.modify("extend",u,"character")}c.modify("extend",u,"character"),d=c.getRangeAt(0),s=d.toString(),t=l.getRangeAnchor(e),t&&(n=e&&t==d.startContainer?d.startOffset:e||t!=d.endContainer?-1:d.endOffset,r=3===t.nodeType&&n>0&&n<t.nodeValue.length?t:e?a.getPreviousNode(t,!1,null):a.getNextNode(t,!1,null),0===s.length?t&&!a.isSelfClosingTag(t)&&r&&(1!==r.nodeType||1===r.nodeType&&a.isSelfClosingTag(r))&&c.modify("extend",u,"character"):s.indexOf(i.FILL_CHAR)>-1&&""===s.replace(i.FILL_CHAR_REG,"")&&c.modify("extend",u,"character"))},setRange:function(e,t,n,r){if(e||n){var i=a.getEndOffset(e),l=a.getEndOffset(n);t<0?t=0:t>i&&(t=i),r<0?r=a.getEndOffset(n):r>l&&(r=l);var s=o.doc.getSelection();e||(e=o.doc.body,t=0);var c;0===s.rangeCount&&(c=o.doc.createRange(),c.selectNode(e),s.addRange(c)),s.collapse(e,t),n&&s.extend(n,r)}},setRangeToEnd:function(e){var t=e,n=a.getEndOffset(e);a.isSelfClosingTag(t)&&(t=t.parentNode,n=a.getIndex(e)+1),l.setRange(t,n)}};t.exports=l},{"./../common/base64":13,"./../common/const":14,"./../common/env":16,"./../domUtils/domBase":24}],39:[function(e,t,n){"use strict";var r,o=e("./../common/env"),i=e("./../common/const"),a=(e("./../common/utils"),e("./../domUtils/domExtend")),l=e("./rangeBase");l.backupCaret=function(){var e=l.getRange();if(!e){if(r)return!0;if(a.focus(),e=l.getRange(),!e)return!1}return r=l.getRange(),!0},l.restoreCaret=function(){if(!r)return!1;var e=o.doc.getSelection();return 0==e.rangeCount&&a.focus(),e.removeAllRanges(),e.addRange(r),r=null,!0},l.modifyCaretStyle=function(e,t){var n,r,s,c,d=o.doc.getSelection(),u=d.focusNode,f=!0;3==u.nodeType&&(u=u.parentNode);for(r in e)e.hasOwnProperty(r)&&"string"==typeof r&&(s=e[r],u.style[r]!==s&&(f=!1));if(!f){a.isTag(u,"span")&&a.isEmptyDom(u)?(a.modifyStyle(u,e,t),c=u):(n=d.getRangeAt(0),n.deleteContents(),c=a.createSpan(),c.innerHTML=i.FILL_CHAR,n.insertNode(c),a.modifyStyle(c,e,t));var g=u.parentNode?u.parentNode:u;a.clearChild(g,[c]),l.setRange(c.childNodes[0],1,c.childNodes[0],1)}},l.modifyDomsStyle=function(e,t,n,r){a.modifyNodesStyle(e,t,n);var o,i,l,s,c=[];for(o=0,i=e.length;o<i;o++)l=e[o].parentNode,l&&c.indexOf(l)<0&&c.push(l);l=a.getParentRoot(c),s=a.getWizAmendParent(l),l=s?s.parentNode:l,a.clearChild(l,r)},l.modifyRangeStyle=function(e,t){var n,r,o;n=l.getRangeDomList({noSplit:!1}),n&&(r=n.list,o=r.length,0!==o&&(l.modifyDomsStyle(r,e,t,[n.startDomBak,n.endDomBak]),l.fixRange(n)))},l.fixRange=function(e){var t=!e.startDom.parentNode,n=!e.endDom.parentNode,r=a.isSelfClosingTag(e.endDom);t&&a.isSelfClosingTag(e.startDomBak)&&(e.startDomBak=a.getNextNode(e.startDomBak,!1,e.endDomBak),e.startOffsetBak=0),l.setRange(t?e.startDomBak:e.startDom,t?e.startOffsetBak:e.startOffset,n||r?e.endDomBak:e.endDom,n||r?e.endOffsetBak:e.endOffset)},l.modifySelectionDom=function(e,t){var n=l.getRange();return!!n&&(n.collapsed?l.modifyCaretStyle(e,t):l.modifyRangeStyle(e,t),!0)},t.exports=l},{"./../common/const":14,"./../common/env":16,"./../common/utils":20,"./../domUtils/domExtend":25,"./rangeBase":38}],40:[function(e,t,n){"use strict";function r(e,t){var n,r,i=o.doc.getElementsByTagName(e);for(n=0;n<i.length;n++)r=i[n],r.readOnly=t}var o=e("../common/env"),i=e("../common/const"),a=e("../common/wizStyle"),l=e("../blockUtils/blockCore"),s=e("../codeUtils/codeCore"),c=e("../domUtils/domExtend"),d=e("../imgUtils/imgCore"),u=e("../tableUtils/tableCore"),f=e("../todoUtils/todoCore"),g=e("./readerEvent"),m="",p={init:function(){},insertDefaultStyle:function(e,t){a.insertDefaultStyle(e,t)},on:function(){o.readonly=!0,m=c.getContentHtml({isSaveTemp:!0}),a.insertTmpReaderStyle()},afterRender:function(e){function t(){c.fixOrderList(),g.on(),d.on(),u.on(),f.on(),l.on(),s.on(),d.setImgFullPath(),r("input",!0),r("textarea",!0),"function"==typeof e&&e()}s.loadDependency(t)},off:function(){g.off(),l.off(),f.off(),s.off(),u.off(),d.off(),m&&(o.options.noteType===i.NOTE_TYPE.COMMON?(c.removeByName(i.NAME.TMP_STYLE),c.removeByTag(i.TAG.TMP_TAG),r("input",!1),r("textarea",!1)):(o.doc.open("text/html","replace"),o.doc.write(m),o.doc.close()))}};t.exports=p},{"../blockUtils/blockCore":8,"../codeUtils/codeCore":10,"../common/const":14,"../common/env":16,"../common/wizStyle":21,"../domUtils/domExtend":25,"../imgUtils/imgCore":31,"../tableUtils/tableCore":42,"../todoUtils/todoCore":46,"./readerEvent":41}],41:[function(e,t,n){"use strict";function r(e){var t,n,r,d,u=c.getRange(),f=!1;if(u&&!u.collapsed)if(r=s.getContainerFromChild(u.startContainer),d=s.getContainerFromChild(u.endContainer),r&&r===d){if(!o.client.type.isPhone&&!o.client.type.isPad)return;f=!0}else n=u.cloneContents(),f=!!n.querySelector("."+i.CLASS.CODE_CONTAINER);if(u&&!u.collapsed&&f){if(t=c.getFragmentForCopy()){var g=t.innerText,m=t.innerHTML;if(t.innerHTML="",o.doc.body.removeChild(t),t=null,e.clipboardData.clearData(),e.clipboardData.setData("text/plain",g),e.clipboardData.setData("text/html",m),e.clipboardData.getData("text"))return void a.stopEvent(e);var p=o.doc.createElement(i.TAG.TMP_TAG),h=o.doc.createElement("textarea");h.value=g,h.setAttribute("readonly",""),l.css(h,{position:"absolute",top:"0",left:"0",width:"1000px"}),l.css(p,{position:"absolute",top:"-99999px",left:"-99999px",overflow:"hidden"}),p.appendChild(h),o.doc.body.appendChild(p),h.focus(),h.selectionStart=0,h.selectionEnd=h.value.length,setTimeout(function(){o.doc.body.removeChild(p),h=null,p=null},50)}t=null}}var o=e("../common/env"),i=e("../common/const"),a=e("../common/utils"),l=e("../domUtils/domExtend"),s=e("../codeUtils/codeUtils"),c=e("../rangeUtils/rangeExtend"),d=(e("../imgUtils/imgUtils"),{on:function(){d.bind()},off:function(){d.unbind()},bind:function(){d.unbind(),o.doc.addEventListener("dblclick",u.onDblclick),o.doc.addEventListener("click",u.onClick),o.doc.addEventListener("copy",u.onCopy),o.doc.addEventListener("cut",u.onCopy),o.doc.addEventListener("scroll",u.onScroll),o.doc.addEventListener("mousemove",u.onMousemove),(o.client.type.isIOS||o.client.type.isAndroid)&&(o.doc.addEventListener("touchend",u.onTouchEnd),o.doc.addEventListener("touchstart",u.onTouchStart))},unbind:function(){o.doc.removeEventListener("dblclick",u.onDblclick),o.doc.removeEventListener("click",u.onClick),o.doc.removeEventListener("copy",u.onCopy),o.doc.removeEventListener("cut",u.onCopy),o.doc.removeEventListener("scroll",u.onScroll),o.doc.removeEventListener("touchend",u.onTouchEnd),o.doc.removeEventListener("touchstart",u.onTouchStart),o.doc.removeEventListener("mousemove",u.onMousemove)}}),u={onDblclick:function(e){o.event.call(i.EVENT.ON_DBLCLICK,e)},onClick:function(e){o.event.call(i.EVENT.ON_CLICK,e)},onCopy:function(e){r(e)},onMousemove:function(e){o.event.call(i.EVENT.ON_MOUSE_MOVE,e)},onScroll:function(e){o.event.call(i.EVENT.ON_SCROLL,e)},onTouchEnd:function(e){o.event.call(i.EVENT.ON_TOUCH_END,e)},onTouchStart:function(e){o.event.call(i.EVENT.ON_TOUCH_START,e)}};t.exports=d},{"../codeUtils/codeUtils":12,"../common/const":14,"../common/env":16,"../common/utils":20,"../domUtils/domExtend":25,"../imgUtils/imgUtils":33,"../rangeUtils/rangeExtend":39}],42:[function(e,t,n){"use strict";var r=e("../common/env"),o=e("../common/const"),i=e("../common/utils"),a=e("../common/historyUtils"),l=e("../blockUtils/blockUtils"),s=e("../codeUtils/codeUtils"),c=e("../domUtils/domExtend"),d=e("../rangeUtils/rangeExtend"),u=e("./tableUtils"),f=e("./tableMenu"),g=e("./tableZone"),m={bind:function(){m.unbind(),r.event.add(o.EVENT.ON_DRAG_START,m.handler.onDragStart),r.event.add(o.EVENT.ON_KEY_UP,m.handler.onKeyUp),r.client.type.isPhone||r.client.type.isPad?(r.event.add(o.EVENT.ON_TOUCH_START,m.handler.onMouseDown),r.event.add(o.EVENT.ON_TOUCH_END,m.handler.onMouseUp)):(r.event.add(o.EVENT.ON_MOUSE_DOWN,m.handler.onMouseDown),r.event.add(o.EVENT.ON_MOUSE_OVER,m.handler.onMouseOver),r.event.add(o.EVENT.ON_MOUSE_UP,m.handler.onMouseUp)),r.event.add(o.EVENT.ON_SELECTION_CHANGE,m.handler.onSelectionChange),r.event.add(o.EVENT.AFTER_RESTORE_HISTORY,m.handler.afterRestoreHistory)},unbind:function(){r.event.remove(o.EVENT.ON_DRAG_START,m.handler.onDragStart),r.event.remove(o.EVENT.ON_KEY_UP,m.handler.onKeyUp),r.event.remove(o.EVENT.ON_MOUSE_DOWN,m.handler.onMouseDown),r.event.remove(o.EVENT.ON_MOUSE_OVER,m.handler.onMouseOver),r.event.remove(o.EVENT.ON_MOUSE_UP,m.handler.onMouseUp),r.event.remove(o.EVENT.ON_TOUCH_START,m.handler.onMouseDown),r.event.remove(o.EVENT.ON_TOUCH_END,m.handler.onMouseUp),r.event.remove(o.EVENT.ON_SELECTION_CHANGE,m.handler.onSelectionChange),r.event.remove(o.EVENT.AFTER_RESTORE_HISTORY,m.handler.afterRestoreHistory)},handler:{afterRestoreHistory:function(){var e,t,n,i,a=[];if(e=r.doc.getElementsByClassName(o.CLASS.SELECTED_CELL),0===e.length)return void g.clear();for(n=0,i=e.length;n<i;n++)a.push(e[n]);var l=c.getParentByTagName(a[0],"table",!0,null);if(!l)return void g.clear();g.setStart(a[0]);var s,d=g.getZone(),m=a[a.length-1],p=u.getRangeByCellData(u.getCellData(d.grid,m));for(n=1;n<a.length-1;n++)t=a[n],1!=t.rowSpan&&(s=u.getRangeByCellData(u.getCellData(d.grid,t)),(s.maxY>p.maxY||(s.maxY=p.maxY&&s.maxX>p.maxX))&&(m=t,p=s));g.setEnd(m),f.show()},onDragStart:function(e){var t=c.getParentByTagName(e.target,"table",!0,null);t&&i.stopEvent(e)},onKeyDown:function(e){var t=r.doc.getSelection(),n=g.getZone();if(!n.range)return!0;var o,a,l,m=e.shiftKey?"extend":"move",p=e.keyCode||e.which,h=!1,b=t.focusNode;switch(p){case 37:e.ctrlKey||e.metaKey||!b||(h=!0,t.modify(m,"backward","character")),o={x:-1,y:0};break;case 38:e.ctrlKey||e.metaKey||!b||(h=!0,t.modify("move","backward","line")),o={x:0,y:-1};break;case 9:e.shiftKey||(o={x:1,y:0,canChangeRow:!0});break;case 39:e.ctrlKey||e.metaKey||!b||(h=!0,t.modify(m,"forward","character")),o={x:1,y:0};break;case 13:if(!e.ctrlKey&&!e.metaKey)break;case 40:e.ctrlKey||e.metaKey||!b||(h=!0,t.modify("move","forward","line")),o={x:0,y:1}}var C,E,v,y;if(h){if(a=t.focusNode,b=c.getParentByTagName(b,["td","th"],!0,null),a=c.getParentByTagName(a,["td","th"],!0,null),a&&a!=b&&(38==p||40==p||13==p?h=!1:g.setStart(a).setEnd(a)),h)return v=u.checkCaretInTableContainer(e),a||v.tableContainer?v.before&&(d.setRange(n.start.cell,0),g.setStart(n.start.cell).setEnd(n.start.cell)):(g.clear(),f.show()),i.stopEvent(e),!1;if(38==p&&n.start.cell==n.end.cell&&0==n.start.y_src){for(l=n.start.x,a=c.getPreviousNode(u.getContainer(b));a&&!c.isTag(a,"br")&&c.isEmptyDom(a);)a=c.getPreviousNode(a);return a?(g.clear(),f.show(),y=s.getContainerFromChild(a),y?s.focusToLast(y.codeMirror):(d.setRange(a,c.getEndOffset(a)),0!==l||c.getParentByTagName(a,["table"],!0,null)||t.modify("move","backward","lineboundary"),d.fixScroll())):(d.setRange(n.start.cell,0),g.setStart(n.start.cell).setEnd(n.start.cell)),i.stopEvent(e),!1}if(40==p&&n.start.cell==n.end.cell&&n.start.y_src+n.start.cell.rowSpan>=n.grid.length){for(l=n.start.x,a=c.getNextNode(u.getContainer(b));a&&!c.isTag(a,"br")&&c.isEmptyDom(a);)a=c.getNextNode(a);return a?(g.clear(),f.show(),y=s.getContainerFromChild(a),y?s.focusToFirst(y.codeMirror):(d.setRange(a,c.getEndOffset(a)),0!==l||c.getParentByTagName(a,["table"],!0,null)||t.modify("move","backward","lineboundary"),d.fixScroll())):g.setStart(n.start.cell).setEnd(n.start.cell),i.stopEvent(e),!1}}if(o){if(C=e.shiftKey?n.end||n.start:n.start,E=g.switchCell(C,o),E==C)return i.stopEvent(e),!1;if(E)return e.shiftKey?g.setEnd(E.cell,!0):g.setStart(E.cell,E.x,E.y).setEnd(E.cell),d.fixScroll(),i.stopEvent(e),!1}return!0},onKeyUp:function(e){var t,n=g.getZone(),r=d.getRange();!n.range&&r&&r.collapsed&&(t=c.getParentByTagName(r.startContainer,["td","th"],!0,null),t&&(g.setStart(t).setEnd(t),f.show())),u.fixSelection(e)},onMouseDown:function(e){var t="mousedown"!==e.type||0===e.button||1===e.button;if(!t)return void f.hide();var n=u.isMenu(e.target);if(!n){var o=c.getParentByTagName(e.target,["th","td"],!0,null),a=o?c.getParentByTagName(o,"table",!1,null):null,l=u.getMousePosition(e,a),s=g.isZoneBorder(e);if(s.isBodyBorder||s.isContainer)return void(r.client.type.isPhone||r.client.type.isPad||i.stopEvent(e));if(!r.client.type.isPhone&&!r.client.type.isPad){if(s.isRight)return void g.startDragColLine(e.target,l.x);if(s.isBottom)return void g.startDragRowLine(e.target,l.y);if(s.isDot)return}s.isBorder||s.isScroll||(g.setStart(o),f.show())}},onMouseOver:function(e){var t=c.getParentByTagName(e.target,["td","th"],!0,null);g.modify(t)},onMouseUp:function(e){u.fixSelection(e);var t="mouseup"!==e.type||0===e.button||1===e.button;if(t){var n,r,o=g.getZone();if(!o.active){if(n=u.isMenu(e.target))return;if(r=g.isZoneBorder(e),r.isRight&&!g.isRangeActiving())return;if(r.isBottom&&!g.isRangeActiving())return;if(r.isDot)return;if(r.isBorder||r.isScroll)return}var i=c.getParentByTagName(e.target,["td","th"],!0,null);g.setEnd(i),f.show()}},onSelectionChange:function(e){var t,n,r=u.checkCaretInTableContainer(e),o=d.getRange();o&&!o.collapsed&&(n=u.getContainer(o.startContainer),n&&c.moveOutFromTableContainer(n),n=u.getContainer(o.endContainer),n&&c.moveOutFromTableContainer(n));var i=g.getZone();r.tableContainer&&!i.range&&(t=r.tableContainer.querySelectorAll("td"),t=r.tableMenu||r.after?t[t.length-1]:r.before?t[0]:null,t&&(g.setStart(t).setEnd(t),f.show()))}}},p={on:function(){r.readonly||(m.bind(),f.init(p)),u.initTableContainer(null),g.clear()},off:function(){g.clear()},canCreateTable:function(){return u.canCreateTable(g.getZone())},clearCellValue:function(){var e=g.getZone();e.range&&(a.saveSnap(!1),u.clearCellValue(e.grid,e.range))},deleteCols:function(){var e=g.getZone();if(e.range){if(0===e.range.minX&&e.range.maxX===e.grid[0].length-1)return void p.deleteTable();a.saveSnap(!1);var t;for(t=e.range.maxX;t>=e.range.minX;t--)u.deleteCols(e.grid,t);g.clear()}},deleteRows:function(){var e=g.getZone();if(e.range){if(0===e.range.minY&&e.range.maxY===e.grid.length-1)return void p.deleteTable();a.saveSnap(!1);var t;for(t=e.range.maxY;t>=e.range.minY;t--)u.deleteRows(e.grid,t);g.clear()}},deleteTable:function(){var e=g.getZone();if(e.table){a.saveSnap(!1);var t=e.table.parentNode;t&&t.removeChild(e.table),f.remove(),g.remove(),t=c.getParentByFilter(t,function(e){return c.hasClass(e,o.CLASS.TABLE_CONTAINER)},!0);var n;t&&(n=r.doc.createElement("br"),t.parentNode.insertBefore(n,t),c.remove(t),d.setRange(n,0))}},distributeCols:function(){var e=g.getZone();e.range&&(a.saveSnap(!1),u.distributeCols(e.table,e.grid),g.updateGrid())},insertCol:function(e){var t=g.getZone();t.range&&(a.saveSnap(!1),u.insertCol(t.grid,e?t.range.minX:t.range.maxX+1),g.updateGrid())},insertRow:function(e){var t=g.getZone();t.range&&(a.saveSnap(!1),u.insertRow(t.grid,e?t.range.minY:t.range.maxY+1),g.updateGrid())},insertTable:function(e,t){a.saveSnap(!1);var n,i=d.getRange();if(p.canCreateTable()){var s,f,m;i&&(i.deleteContents(),s=d.getRangeDetail(i.startContainer,i.startOffset),s=c.getBlockParent(s.container,!0),s&&s!==r.doc.body&&c.isEmptyDom(s)&&c.isTag(s,"div")&&(f=s,s.innerHTML="")),m=u.createTable(e,t),f=f?f:r.doc.createElement("div"),f.appendChild(m),f.parentNode||(f=l.insertBlock(m)),u.initTableContainer(m),n=m.querySelector("td"),g.setStart(n).setEnd(n),r.event.call(o.EVENT.UPDATE_RENDER)}},merge:function(){var e=g.getZone();if(e.range){a.saveSnap(!1);var t=u.mergeCell(e.grid,e.range);t&&(g.updateGrid(),g.setStart(t).setEnd(t))}},modifySelectionDom:function(e,t){var n=d.getRange(),r=g.getZone();return!(n&&!n.collapsed||!r.range)&&(u.modifySelectionDom(r,e,t),!0)},onKeyDown:m.handler.onKeyDown,setCellAlign:function(e,t){var n=g.getZone();n.range&&(a.saveSnap(!1),u.setCellAlign(n.grid,n.range,{align:e,valign:t}),g.setStartRange())},setCellBg:function(e){var t=g.getZone();t.range&&(a.saveSnap(!1),u.setCellBg(t.grid,t.range,e),g.setStartRange())},split:function(){var e=g.getZone(),t=u.splitCell(e.table,e.grid,e.range);t&&(a.saveSnap(!1),g.updateGrid(),e=g.getZone(),g.setStart(e.grid[t.minY][t.minX].cell).setEnd(e.grid[t.maxY][t.maxX].cell))}};t.exports=p},{"../blockUtils/blockUtils":9,"../codeUtils/codeUtils":12,"../common/const":14,"../common/env":16,"../common/historyUtils":17,"../common/utils":20,"../domUtils/domExtend":25,"../rangeUtils/rangeExtend":39,"./tableMenu":43,"./tableUtils":44,"./tableZone":45}],43:[function(e,t,n){"use strict";function r(){var e=d.doc.querySelector("."+u.CLASS.TABLE_TOOLS);if(e)return e;var t,n,r=[{id:b.col,exClass:"icon-insert editor-icon",subMenu:{type:E.list,data:[{type:u.TYPE.TABLE.INSERT_ROW_UP,name:g.Table.InsertRowUp,isSplit:!1},{type:u.TYPE.TABLE.INSERT_ROW_DOWN,name:g.Table.InsertRowDown,isSplit:!1},{type:u.TYPE.TABLE.INSERT_COL_LEFT,name:g.Table.InsertColLeft,isSplit:!1},{type:u.TYPE.TABLE.INSERT_COL_RIGHT,name:g.Table.InsertColRight,isSplit:!1},{type:u.TYPE.TABLE.DELETE_ROW,name:g.Table.DeleteRow,isSplit:!0},{type:u.TYPE.TABLE.DELETE_COL,name:g.Table.DeleteCol,isSplit:!1}]}},{id:b.align,exClass:"icon-align editor-icon",subMenu:{type:E.custom,make:function(){var e,t,n,r=[["top","middle","bottom"],["left","center","right"]],o='<div class="wiz-table-menu-sub wiz-table-cell-align">';for(e=0;e<r.length;e++){for(o+="<div>",t=0;t<r[e].length;t++)n=0===e?"valign":"align",o+='<div class="'+C.alignItem+" "+C.clickItem+'" data-type="'+u.TYPE.TABLE.SET_CELL_ALIGN+'" data-align-type="'+n+'" data-align-value="'+r[e][t]+'">',0===e?(o+='<i class="editor-icon icon-box"></i>',o+='<i class="editor-icon valign icon-valign_'+r[e][t]+'"></i>'):o+='<i class="editor-icon align icon-align_'+r[e][t]+'"></i>',o+="</div>";o+="</div>"}return o+="</div>"}}},{id:b.bg,exClass:"icon-box editor-icon",subMenu:{type:E.custom,make:function(){var e,t,n=[["","#f7b6ff","#fecf9c"],["#acf3fe","#b2ffa1","#b6caff"],["#ffc7c8","#eeeeee","#fef49c"]],r='<div class="wiz-table-menu-sub wiz-table-color-pad">';for(e=0;e<n.length;e++){for(r+="<div>",t=0;t<n[e].length;t++)r+='<div class="'+C.colorPadItem+" "+C.clickItem+'" data-color="'+n[e][t]+'" data-type="'+u.TYPE.TABLE.SET_CELL_BG+'">',r+='<i class="editor-icon icon-box"></i>',r+=0===e&&0===t?'<i class="pad-demo editor-icon icon-oblique_line"></i>':'<i class="pad-demo editor-icon icon-inner_box" style="color:'+n[e][t]+';"></i>',
r+="</div>";r+="</div>"}return r+="</div>"}}},{id:b.cells,exClass:"icon-merge editor-icon",subMenu:{type:E.list,data:[{type:u.TYPE.TABLE.MERGE_CELL,name:g.Table.MergeCell,isSplit:!1},{type:u.TYPE.TABLE.SPLIT_CELL,name:g.Table.SplitCell,isSplit:!1},{type:u.TYPE.TABLE.CLEAR_CELL,name:g.Table.ClearCell,isSplit:!1}]}},{id:b.more,exClass:"icon-more editor-icon",subMenu:{type:E.list,data:[{type:u.TYPE.TABLE.DISTRIBUTE_COLS,name:g.Table.DistributeCols,exClass:"",isSplit:!1},{type:u.TYPE.TABLE.DELETE_TABLE,name:g.Table.DeleteTable,exClass:"",isSplit:!0}]}}];e=d.doc.createElement(u.TAG.TMP_TAG),h.addClass(e,u.CLASS.TABLE_TOOLS);var i="<ul>";for(t=0;t<r.length;t++)n=r[t],i+='<li id="'+n.id+'" class="'+u.CLASS.TABLE_MENU_ITEM+'"><div class="'+u.CLASS.TABLE_MENU_BUTTON+'"><i class="'+n.exClass+'"></i>',n.id===b.bg&&(i+='<i id="'+b.bgDemo+'" class="editor-icon icon-inner_box"></i>'),i+="</div>",i+=n.subMenu.type===E.list?o(n.subMenu.data):n.subMenu.make(),i+="</li>";return i+="</ul>",e.innerHTML=i,l=e.querySelector("#"+b.bgDemo),l&&(l.style.color="#fff"),e}function o(e){var t,n,r='<ul class="wiz-table-menu-sub">';for(t=0;t<e.length;t++)n=e[t],r+='<li class="wiz-table-menu-sub-item '+C.clickItem,n.isSplit&&(r+=" split"),r+='" data-type="'+n.type+'">'+n.name,r+="</li>";return r+="</ul>"}function i(){var e,t=c.parentNode.querySelector("."+u.CLASS.TABLE_BODY),n=t?t.offsetTop:0;return e=n-c.offsetHeight+5,e+"px"}function a(){var e=c.parentNode,t=h.getOffset(e),n=d.doc.body.scrollTop;n>t.top-30&&n<e.offsetHeight+t.top-2.5*c.offsetHeight?h.css(c,{position:"fixed",top:"0",left:t.left+"px"}):h.css(c,{position:"",top:i(),left:""})}var l,s,c,d=e("../common/env"),u=e("../common/const"),f=e("../common/lang"),g=f.getLang(),m=e("./tableUtils"),p=e("./tableZone"),h=e("../domUtils/domExtend"),b={col:"wiz-menu-col",align:"wiz-menu-align",bg:"wiz-menu-bg",bgDemo:"wiz-menu-bg-demo",cells:"wiz-menu-cells",more:"wiz-menu-more"},C={active:"active",disabled:"disabled",clickItem:"click-item",colorPadItem:"wiz-table-color-pad-item",alignItem:"wiz-table-cell-align-item"},E={list:1,custom:2},v={bind:function(){v.unbind(),c&&(c.addEventListener("click",v.handler.onClick),c.addEventListener("mouseover",v.handler.onMouseOver)),d.event.add(u.EVENT.BEFORE_SAVESNAP,v.handler.onBeforeSaveSnap),d.event.add(u.EVENT.ON_SCROLL,v.handler.onScroll)},unbind:function(){c&&(c.removeEventListener("click",v.handler.onClick),c.removeEventListener("mouseover",v.handler.onMouseOver)),d.event.remove(u.EVENT.BEFORE_SAVESNAP,v.handler.onBeforeSaveSnap),d.event.remove(u.EVENT.ON_SCROLL,v.handler.onScroll)},handler:{onBeforeSaveSnap:function(){},onClick:function(e){var t=h.getParentByFilter(e.target,function(e){return h.hasClass(e,u.CLASS.TABLE_MENU_BUTTON)},!0);if(t)return void y.showSub(t.parentNode);var n;if(t=h.getParentByFilter(e.target,function(e){return h.hasClass(e,C.clickItem)},!0),t&&!h.hasClass(t,C.disabled)){var r=t.getAttribute("data-type"),o=!0;switch(r){case u.TYPE.TABLE.CLEAR_CELL:s.clearCellValue();break;case u.TYPE.TABLE.MERGE_CELL:s.merge();break;case u.TYPE.TABLE.SPLIT_CELL:s.split();break;case u.TYPE.TABLE.INSERT_ROW_UP:s.insertRow(!0);break;case u.TYPE.TABLE.INSERT_ROW_DOWN:s.insertRow();break;case u.TYPE.TABLE.INSERT_COL_LEFT:s.insertCol(!0);break;case u.TYPE.TABLE.INSERT_COL_RIGHT:s.insertCol();break;case u.TYPE.TABLE.DELETE_ROW:s.deleteRows();break;case u.TYPE.TABLE.DELETE_COL:s.deleteCols();break;case u.TYPE.TABLE.SET_CELL_BG:var i=t.getAttribute("data-color");s.setCellBg(i),n=h.getParentByFilter(t,function(e){return h.hasClass(e,"wiz-table-color-pad")},!1),h.removeClass(n.querySelectorAll(".wiz-table-color-pad ."+C.colorPadItem+"."+C.active),C.active),h.addClass(t,C.active),l.setAttribute("data-last-color",i);break;case u.TYPE.TABLE.SET_CELL_ALIGN:var a=null,c=null;"align"==t.getAttribute("data-align-type")?a=t.getAttribute("data-align-value"):c=t.getAttribute("data-align-value"),s.setCellAlign(a,c),n=t.parentNode,h.removeClass(n.querySelectorAll("."+C.active),C.active),h.addClass(t,C.active),o=!1;break;case u.TYPE.TABLE.DELETE_TABLE:s.deleteTable();break;case u.TYPE.TABLE.DISTRIBUTE_COLS:s.distributeCols();break;default:o=!1}o&&y.hideSub()}},onMouseOver:function(e){var t=h.getParentByFilter(e.target,function(e){return h.hasClass(e,C.colorPadItem)},!0);t&&l&&(l.style.color=t.getAttribute("data-color")||"#fff")},onScroll:function(e){c&&"none"!=c.style.display&&a()}}},y={init:function(e){s=e},hide:function(){c&&(c.style.display="none"),v.unbind()},hideSub:function(){if(c){var e=c.querySelectorAll("."+u.CLASS.TABLE_MENU_ITEM+"."+C.active);h.removeClass(e,C.active),l&&(l.style.color=l.getAttribute("data-last-color")||"#fff")}},remove:function(){c&&(h.remove(c),c=null)},show:function(){if(!d.client.type.isPhone&&!d.client.type.isPad){var e=p.getZone();if(!e.grid||!e.range)return void y.hide();var t=h.getParentByFilter(e.table,function(e){return h.hasClass(e,u.CLASS.TABLE_CONTAINER)},!1);c=r(),h.attr(c,{contenteditable:"false"}),y.hideSub(),t.appendChild(c),h.css(c,{top:i()}),c.style.display="block",a(),v.bind()}},showSub:function(e){if(h.hasClass(e,C.active))return void h.removeClass(e,C.active);var t,n,r,o,i=p.getZone();e.id===b.cells?(t=m.canMerge(i.grid,i.range),n=m.canSplit(i.grid,i.range),o=e.querySelector("[data-type="+u.TYPE.TABLE.MERGE_CELL+"]"),o&&t?h.removeClass(o,C.disabled):o&&h.addClass(o,C.disabled),o=e.querySelector("[data-type="+u.TYPE.TABLE.SPLIT_CELL+"]"),o&&n?h.removeClass(o,C.disabled):o&&h.addClass(o,C.disabled)):e.id===b.align&&(r=m.getAlign(i.grid,i.range),o=e.querySelector("."+C.alignItem+"."+C.active+"[data-align-type=align]"),!o||r.align&&o.getAttribute("data-align-value").toLowerCase()===r.align||(h.removeClass(o,C.active),o=null),!o&&r.align&&(o=e.querySelector("[data-align-value="+r.align+"]"),h.addClass(o,C.active)),o=e.querySelector("."+C.alignItem+"."+C.active+"[data-align-type=valign]"),!o||r.valign&&o.getAttribute("data-align-value").toLowerCase()===r.valign||(h.removeClass(o,C.active),o=null),!o&&r.valign&&(o=e.querySelector("[data-align-value="+r.valign+"]"),h.addClass(o,C.active))),y.hideSub(),h.addClass(e,C.active)}};t.exports=y},{"../common/const":14,"../common/env":16,"../common/lang":18,"../domUtils/domExtend":25,"./tableUtils":44,"./tableZone":45}],44:[function(e,t,n){"use strict";var r=e("./../common/env"),o=e("./../common/const"),i=e("./../common/utils"),a=e("./../domUtils/domExtend"),l=e("../rangeUtils/rangeExtend"),s={init:function(){},canCreateTable:function(e){var t,n=l.getRange();if(n){if(t=a.getParentByTagName(n.startContainer,["table"],!0,null)||a.getParentByTagName(n.endContainer,["table"],!0,null))return!1;if(a.getParentByClass(n.startContainer,o.CLASS.CODE_CONTAINER,!0))return!1}return!e.range},canMerge:function(e,t){return e&&t&&e[t.minY][t.minX].cell!==e[t.maxY][t.maxX].cell},canSplit:function e(t,n){if(!t||!n)return!1;var r,o={},e=!1;return s.eachRange(t,n,function(n){r=n.x_src+"_"+n.y_src,n.fake&&!o[r]&&(o[r]=t[n.y_src][n.x_src],e=!0)}),!!e&&o},checkCaretInTableContainer:function(e){var t,n,r,o,i,c,d={tableContainer:null,tableMenu:!1,before:!1,after:!1},u=/^(mouse|touch)/i;if(e&&u.test(e.type))o=e.target;else{if(t=l.getRange(),!t||!t.collapsed)return d;c=l.getRangeDetail(t.startContainer,t.startOffset),o=c.container,i=c.offset}return a.isTag(o,"table")&&s.initTableContainer(o),s.isMenu(o)?(d.tableContainer=s.getContainerExcludeTable(o),d.tableMenu=!0,d):(n=s.getContainerExcludeTable(o),n&&(d.tableContainer=n,e&&u.test(e.type)?r=n.querySelector("table"):i>0?d.after=!0:d.before=!0),d)},clearCellValue:function(e,t){e&&t&&s.eachRange(e,t,function(e){e.fake||(e.cell.innerHTML="<br/>")})},cloneCell:function(e,t){var n=r.doc.createElement(e.tagName);return n.style.cssText=e.style.cssText,t?n.innerHTML="<br/>":(n.colSpan=e.colSpan,n.rowSpan=e.rowSpan,n.innerHTML=e.innerHTML),n},createCell:function(e){var t=r.doc.createElement("td");return t.setAttribute("align","left"),t.setAttribute("valign","middle"),e&&t.setAttribute("style","width:"+e+"px"),t.appendChild(r.doc.createElement("br")),t},createTable:function(e,t){if(e&&t){var n,o,i,a=r.doc.createElement("table"),l=r.doc.createElement("tbody");for(i=0;i<t;i++){for(n=r.doc.createElement("tr"),o=0;o<e;o++)n.appendChild(s.createCell(r.options.table.colWidth));l.appendChild(n)}return a.appendChild(l),a.style.width=r.options.table.colWidth*e+"px",a}},deleteCols:function(e,t){if(e&&0!==e.length&&!(t>e[0].length)){var n,o,i,l=a.getParentByTagName(e[0][0].cell,"table",!1,null),c=[],d=r.options.table.colWidth;for(n=0;n<e.length;n++)o=e[n][t],o.y_src==n&&o.cell.colSpan>1?(o.cell.colSpan--,c.push(o.cell)):o.y_src==n&&(d=s.getCellWidth(o.cell),o.cell.parentElement.removeChild(o.cell)),e[n].splice(t,1);for(n=0;n<c.length;n++)i=c[n],i.style.width=s.getCellWidth(i)-d+"px";l.getElementsByTagName("td").length||l.getElementsByTagName("th").length?s.fixTableWidth(l):l.parentElement.removeChild(l)}},deleteRows:function(e,t){if(e&&0!==e.length&&!(t>e.length)){var n,r,o,i=a.getParentByTagName(e[0][0].cell,"table",!1,null),l=i.rows;for(n=e[t].length-1;n>=0;n--)r=e[t][n],r.x_src==n&&r.y_src<r.y?r.cell.rowSpan--:r.x_src==n&&r.y_src==r.y&&r.cell.rowSpan>1&&t+1<e.length&&(r.cell.rowSpan--,o=s.getNextCellDataInRow(e[t+1],n),o=o?o.cell:null,l[t+1].insertBefore(r.cell,o));e.splice(t,1),l[t].parentElement.removeChild(l[t]),i.getElementsByTagName("tr").length?s.fixTableWidth(i):i.parentElement.removeChild(i)}},distributeCols:function(e,t){if(e&&t){var n=t[0].length;if(0!==n){var r,o,i,a=e.rows,l=e.offsetWidth/n;for(r=a.length-1;r>=0;r--)for(o=a[r].cells.length-1;o>=0;o--)i=a[r].cells[o],i.style.width=l*i.colSpan+"px";e.style.width=e.offsetWidth+"px"}}},eachRange:function(e,t,n){if(e&&t&&n&&"function"==typeof n){var r,o,i=!0;for(o=t.minY;i!==!1&&o<e.length&&o<=t.maxY;o++)for(r=t.minX;i!==!1&&r<e[o].length&&r<=t.maxX;r++)i=n(e[o][r])}},fixSelection:function(){var e=l.getRange();if(e&&!e.collapsed){var t=e.startContainer,n=e.startOffset,r=e.endContainer,o=e.endOffset,i=s.getContainer(t),c=s.getContainer(r);if(!(!i&&!c||i&&c)){for(var d,u=i?i:c;d=s.getContainer(u);)u=i?a.getNextNode(d,!1,r):a.getPreviousNode(d,!1,t);i?(t=u?u:r,n=0):(r=u?u:t,o=a.getEndOffset(r)),i?l.setRange(r,o,t,n):l.setRange(t,n,r,o)}}},fixTableWidth:function(e){if(e){var t,n,r,o=e.rows,i=0;for(t=0;t<o[0].cells.length;t++)n=o[0].cells[t],r=s.getCellWidth(n),i+=r;e.style.width=i+"px"}},getAlign:function(e,t){if(!e||!t)return!1;var n,r,o,i={align:"",valign:""};return s.eachRange(e,t,function(e){return o=e.cell,e.fake||(n=o.align.toLowerCase(),r=o.vAlign.toLowerCase()),""===i.align&&(i.align=n,i.valign=r),null!==i.align&&(i.align=i.align===n?n:null),null!==i.valign&&(i.valign=i.valign===r?r:null),null!==i.align||null!==i.valign}),i},getCellWidth:function(e){return parseInt(e.style.width||e.offsetWidth,10)},getCellData:function(e,t){if(!e||!t)return null;var n,r,o;for(n=0;n<e.length;n++)for(r=0;r<e[n].length;r++)if(o=e[n][r],o.cell===t)return o;return null},getCellsByRange:function(e,t){var n=[];return e&&t?(s.eachRange(e,t,function(e){e.fake||n.push(e.cell)}),n):n},getContainer:function(e){return a.getParentByClass(e,o.CLASS.TABLE_CONTAINER,!0)},getTableBody:function(e){return a.getParentByFilter(e,function(e){return a.hasClass(e,o.CLASS.TABLE_BODY)},!0)},getContainerExcludeTable:function(e){var t=a.getParentByTagName(e,["th","td"],!0,null),n=t?null:s.getContainer(e);return n},getDomsByCellList:function(e){var t,n,r,o,i=[];if(!e)return i;for(t=0,n=e.length;t<n;t++)r=e[t],o=a.getListA2B({startDom:r.firstChild,startOffset:0,endDom:r.lastChild,endOffset:1,noSplit:!0}),i=i.concat(o.list);return i},getNextCellInTable:function(e){var t=e.nextElementSibling;if(t)return t;for(var n=e.parentNode.nextElementSibling;n;){if(n.cells.length>0)return n.cells[0];n=n.nextElementSibling}return null},getNextCellDataInRow:function(e,t){if(!e)return null;var n;for(n=t;n<e.length;n++)if(!e[n].fake)return e[n];return null},getMousePosition:function(e,t){var n=i.getEventClientPos(e),o=s.getTableBody(t||e.target),a=n.x+r.doc.body.scrollLeft+(o?o.scrollLeft:0),l=n.y+r.doc.body.scrollTop+(o?o.scrollTop:0);return{x:a,y:l}},getPreviousCellDataInRow:function(e,t){if(!e)return null;var n;for(n=t;n>=0;n--)if(!e[n].fake)return e[n];return null},getRangeByCellData:function(e){return e?{minX:e.x_src,minY:e.y_src,maxX:e.x_src+e.cell.colSpan-1,maxY:e.y_src+e.cell.rowSpan-1}:{minX:0,minY:0,maxX:0,maxY:0}},getRangeByCellsData:function(e,t,n){if(!e||!t||!n)return null;var r=s.getRangeByCellData(t);if(t.cell===n.cell)return r;for(var o,i,a,l,c,d,u,f,g,m=s.getRangeByCellData(n),p=Math.min(r.minX,m.minX),h=Math.min(r.minY,m.minY),b=Math.max(r.maxX,m.maxX),C=Math.max(r.maxY,m.maxY),E={},v=!0;v;)for(v=!1,o=p,i=h,a=b,l=C,d=h;d<=C;d++){for(c=p;c<=b;c++)if(d>h&&d<C&&c<b-1)c=b-1;else if(u=e[d][c],g=u.x_src+"_"+u.y_src,!E[g]&&(f=s.getRangeByCellData(u),p=Math.min(p,f.minX),h=Math.min(h,f.minY),b=Math.max(b,f.maxX),C=Math.max(C,f.maxY),p!==o||h!==i||b!==a||C!==l)){v=!0;break}if(v)break}return{minX:p,minY:h,maxX:b,maxY:C}},getTableGrid:function(e){function t(e,t){for(;C[t][e];)e++;return e}if(!e||!a.isTag(e,"table"))return null;var n,r,o,i,l,s,c,d,u,f,g,m,p,h,b,C=[];for(o=e.rows,r=0;r<o.length;r++)for(i=o[r],l=i.cells,C[r]||(C[r]=[]),n=0;n<l.length;n++)for(s=l[n],c=s.colSpan,d=s.rowSpan,s.firstChild||(s.innerHTML="<br>"),b=t(n,r),u=0;u<d;u++)for(C[r+u]||(C[r+u]=[]),f=0;f<c;f++)m=r+u,g=t(b+f,m),0==u&&0==f&&(p=g,h=m),C[m][g]={cell:s,x:g,y:m,x_src:p,y_src:h,fake:u>0||f>0};return C},getTemplateByHtmlForPaste:function(e){var t,n,o,i,l,s=!1,c=r.doc.createElement("div");if(c.innerHTML=e,a.childNodesFilter(c),t=c.querySelectorAll("table"),1==t.length&&(n=t[0],a.remove(n),a.isEmptyDom(c)?(s=!0,o=n):c.innerHTML=e),!s){for(t=c.querySelectorAll("table"),i=t.length-1;i>=0;i--)n=t[i],a.before(r.doc.createTextNode(n.innerText),n),a.remove(n);for(i=c.childNodes.length-1;i>=0;i--)l=c.childNodes[i],1!==l.nodeType&&3!==l.nodeType&&a.isEmptyDom(l)&&c.removeChild(l);o=c}return{isTable:s,pasteDom:o}},getTemplateByTxtForPaste:function(e){e=(e||"").trim();var t,n,o,i,a,l=e.split(/\r?\n/),c=r.doc.createElement("table"),d=r.doc.createElement("tbody"),u=0;for(c.appendChild(d),n=0;n<l.length;n++){for(o=l[n].split("\t"),i=r.doc.createElement("tr"),t=0;t<o.length;t++)a=s.createCell(),o[t]&&(a.innerHTML="",a.appendChild(r.doc.createTextNode(o[t]))),i.appendChild(a);u=Math.max(u,i.cells.length),d.appendChild(i)}for(l=c.rows,n=0;n<l.length;n++)for(i=l[n],o=i.cells,t=o.length;t<u;t++)i.appendChild(s.createCell());return{isTable:!0,pasteDom:c}},initTable:function(e){var t,n,r;for(t=e.rows.length-1;t>=0;t--)for(n=e.rows[t].cells.length-1;n>=0;n--)r=e.rows[t].cells[n],r.style.width=r.offsetWidth+"px";e.style.width=e.offsetWidth+"px"},initTableContainer:function(e){function t(e,t){var n=e.parentNode;return t(n)||(n=r.doc.createElement("div"),a.before(n,e),n.appendChild(e)),n}var n,i,l,s,c,d=e?[e]:r.doc.querySelectorAll("table");for(s=0,c=d.length;s<c;s++)n=d[s],l=t(n,function(e){return e!==r.doc.body&&(1===e.childNodes.length?(a.addClass(e,o.CLASS.TABLE_BODY),!0):a.hasClass(e,o.CLASS.TABLE_BODY))}),i=t(l,function(e){return e!==r.doc.body&&(1===e.childNodes.length?(a.addClass(e,o.CLASS.TABLE_CONTAINER),!0):a.hasClass(e,o.CLASS.TABLE_CONTAINER))}),a.addClass(i,o.CLASS.TABLE_CONTAINER),a.css(i,{position:"relative",padding:"0"}),a.addClass(l,o.CLASS.TABLE_BODY),a.removeClass(l,o.CLASS.TABLE_MOVING)},insertCol:function(e,t){if(e){t=t||0;var n,o,i,l,c,d,u=a.getParentByTagName(e[0][0].cell,"table",!1,null),f=u.rows,g=null;for(n=0;n<e.length;n++)o=e[n],o.length>t?(i=e[n][t],l=i.cell):(i=null,l=null),l&&l!==g&&i.x_src<t?(i.cell.colSpan++,i.cell.style.width=s.getCellWidth(i.cell)+r.options.table.colWidth+"px"):(!l||l&&i.x_src==t)&&(c=s.createCell(r.options.table.colWidth),l&&i.y_src<i.y?(d=s.getNextCellDataInRow(e[n],t),f[n].insertBefore(c,d?d.cell:null)):f[n].insertBefore(c,l)),g=i?i.cell:null;s.fixTableWidth(u)}},insertRow:function(e,t){if(e){t=t||0;var n,o,i,l=(a.getParentByTagName(e[0][0].cell,"table",!1,null),r.doc.createElement("tr")),c=e[e.length>t?t:e.length-1];for(n=0;n<c.length;n++)o=c[n],e.length>t&&o.y_src<o.y&&o.x_src==o.x?o.cell.rowSpan++:(e.length<=t||o.y_src==o.y)&&(i=s.cloneCell(o.cell,!0),o.cell.colSpan>1&&(i.style.width=o.cell.offsetWidth/o.cell.colSpan+"px"),l.appendChild(i));var d=c[0].cell.parentElement,u=d.parentElement;e.length<=t&&(d=null),u.insertBefore(l,d)}},isMenu:function(e){return!!e&&!!a.getParentByFilter(e,function(e){return a.hasClass(e,o.CLASS.TABLE_TOOLS)},!0)},mergeCell:function(e,t){if(!s.canMerge(e,t))return null;var n=t.maxY-t.minY+1,o=t.maxX-t.minX+1,i=e[t.minY][t.minX].cell,l=r.doc.createElement("div");for(s.eachRange(e,t,function(e){if(!e.fake&&e.cell!=i){if(!a.isEmptyDom(e.cell))for(l.lastChild&&l.appendChild(r.doc.createElement("br"));e.cell.firstChild;)l.appendChild(e.cell.firstChild);a.remove(e.cell)}});l.firstChild;)i.appendChild(l.firstChild);return i.rowSpan=n,i.colSpan=o,i},modifySelectionDom:function(e,t,n){var r,o;r=t["text-align"]||null,o=t["text-valign"]||null,delete t["text-align"],delete t["text-valign"],s.eachRange(e.grid,e.range,function(e){e.fake||l.modifyDomsStyle(e.cell.childNodes,t,n,[])}),(r||o)&&s.setCellAlign(e.grid,e.range,{align:r,valign:o})},setCellAlign:function(e,t,n){if(e&&t){var r={};null!=n.align&&(r.align=n.align||"left"),null!=n.valign&&(r.valign=n.valign||"middle"),s.eachRange(e,t,function(e){e.fake||(r.align&&a.css(e.cell,{"text-align":""}),r.valign&&a.css(e.cell,{"text-valign":""}),a.attr(e.cell,r))})}},setCellBg:function(e,t,n){e&&t&&(n=n||"","transparent"===n.toLowerCase()&&(n=""),s.eachRange(e,t,function(e){e.fake||a.css(e.cell,{"background-color":n})}))},getKeyForColWidth:function(e){return e.x_src+"_"+e.y_src},fixColTimer:-1,fixColWidth:function(e,t,n,i,a){a>=0||(s.fixColTimer&&clearTimeout(s.fixColTimer),s.fixColTimer=setTimeout(function(){var l,c,d,u,f=a;for(e.style.width=t+"px",l=0,c=n.length;l<c;l++)d=n[l],u=d.cell.offsetWidth-i[s.getKeyForColWidth(d)]+a,f=0===l?u:Math.max(f,u);if(f>a){for(e.style.width=t-a+f+"px",l=0,c=n.length;l<c;l++)d=n[l],d.cell.style.width=i[s.getKeyForColWidth(d)]-a+f+"px";r.event.call(o.EVENT.UPDATE_RENDER)}},0))},setColWidth:function(e,t,n,o){function i(){var e,i,a,l,s=o;for(e=0;e<t.length;e++){if(i=t[e][n],l=r.options.table.colWidthMin-i.cell.offsetWidth,1==i.cell.colSpan){s=l,a=i.cell;break}s<l&&(s=l,a=i.cell)}return o<s?s:o}o=i();var a,l,c,d,u=e.offsetWidth+o,f=[],g={};for(a=0,l=t.length;a<l;a++)c=t[a][n],d=s.getKeyForColWidth(c),g[d]||(g[d]=c.cell.offsetWidth+o,f.push(c));for(e.style.width=u+"px",a=0,l=f.length;a<l;a++)c=f[a],c.cell.style.width=g[s.getKeyForColWidth(c)]+"px";s.fixColWidth(e,u,f,g,o)},setRowHeight:function(e,t,n,o){var i,a,l,s,c=o;for(i=0;i<t[n].length;i++){if(a=t[n][i],s=r.options.table.rowHeightMin-a.cell.offsetHeight,1==a.cell.rowSpan){c=s,l=a.cell;break}c<s&&(c=s,l=a.cell)}l&&(o<c?l.parentNode.style.height=r.options.table.rowHeightMin+"px":l.parentNode.style.height=a.cell.offsetHeight+o+"px")},splitCell:function(e,t,n){var r,o,i,a,l,c,d=s.canSplit(t,n);if(!d)return null;var u,f,g;for(a in d)if(d.hasOwnProperty(a))for(i=d[a],c=i.cell.rowSpan,l=i.cell.colSpan,o=i.y_src;o<i.y_src+c;o++)for(r=i.x_src;r<i.x_src+l;r++)u=t[o][r],u.fake?(f=s.getNextCellDataInRow(t[o],r),f=f?f.cell:null,g=s.cloneCell(u.cell,!0),e.rows[o].insertBefore(g,f),u.fake=!1,u.cell=g,u.y_src=o,u.x_src=r):(u.cell.rowSpan=1,u.cell.colSpan=1),u.cell.style.width="";return n}};t.exports=s},{"../rangeUtils/rangeExtend":39,"./../common/const":14,"./../common/env":16,"./../common/utils":20,"./../domUtils/domExtend":25}],45:[function(e,t,n){"use strict";function r(e){_.table=e,_.grid=A.getTableGrid(_.table)}function o(){if(_.table){var e,t=_.table.getElementsByClassName(y.CLASS.SELECTED_CELL);for(e=t.length-1;e>=0;e--)x.removeClass(t[e],[y.CLASS.SELECTED_CELL,y.CLASS.SELECTED_CELL_MULTI])}}function i(){if(!_.grid||!_.range)return null;var e=[];return A.eachRange(_.grid,_.range,function(t){t.fake||e.push(t)}),e}function a(e,t,n){var r=e.querySelector("#"+t);return r||(r=v.doc.createElement(n),r.id=t,e.appendChild(r)),r}function l(){if(!_.grid||!_.range)return!1;var e=!1;return A.eachRange(_.grid,_.range,function(t){return e=t.fake,!e}),!1}function s(){if(!_.grid||!_.range)return!1;var e=_.grid[_.range.minY][_.range.minX],t=_.grid[_.range.maxY][_.range.maxX],n=_.start;return e.cell==t.cell&&t.cell==n.cell}function c(){var e=O.getRange();if(!e)return v.client.type.isPhone||v.client.type.isPad||!s();var t,n,r;return _.grid&&_.start&&(t=x.getParentByTagName(e.startContainer,["th","td"],!0,null),n=e.collapsed?t:x.getParentByTagName(e.endContainer,["th","td"],!0,null)),!_.start||_.start.cell==t&&t==n||!e.collapsed&&_.start.cell==t&&t!=n&&0===e.endOffset&&n==A.getNextCellInTable(t)&&(n=t.lastChild,r=x.getEndOffset(n),setTimeout(function(){O.setRange(e.startContainer,e.startOffset,n,r)},200),!0)}function d(e){if(e){var t,n;for(t=0,n=e.length;t<n;t++)x.addClass(e[t].cell,y.CLASS.SELECTED_CELL+(n>1?" "+y.CLASS.SELECTED_CELL_MULTI:""))}}function u(e){if(_.table){var t=p(),n=t.colLine.minLeft;e<n&&(e=n),x.css(t.colLine,{top:_.table.offsetTop+"px",left:e+"px",height:_.table.offsetHeight+"px",display:"block"}),t.container.style.display="block"}}function f(e){if(_.table){var t=p(),n=t.rowLine.minTop;e<n&&(e=n),x.css(t.rowLine,{left:_.table.offsetLeft+"px",top:e+"px",width:_.table.offsetWidth+"px",display:"block"}),t.container.style.display="block"}}function g(e){A.initTableContainer(_.table);var t=_.table.parentNode;t.appendChild(e.container)}function m(){o(),d(i());var e=p();if(!_.start||!_.range)return e.container.style.display="none",e.start.dom.style.display="none",void(e.range.dom.style.display="none");g(e);var t,n,r,a,l,c,u,f,m=v.doc.body.clientTop,b=v.doc.body.clientLeft,C=_.start?_.start.cell:null,E=_.grid[_.range.minY][_.range.minX],y=_.grid[_.range.maxY][_.range.maxX];E&&y&&(E=E.cell,y=y.cell,C&&(n=m+C.offsetTop,t=b+C.offsetLeft,r=C.offsetWidth,a=C.offsetHeight),c=m+E.offsetTop,l=b+E.offsetLeft,E==y?(u=E.offsetWidth,f=E.offsetHeight):(u=y.offsetLeft+y.offsetWidth-l,f=y.offsetTop+y.offsetHeight-c),x.css(e.start.dom,{top:n+"px",left:t+"px"}),x.css(e.start.top,{width:r+"px"}),x.css(e.start.left,{height:a+"px"}),x.css(e.start.bottom,{top:a-1+"px",width:r+"px"}),x.css(e.start.right,{left:r-1+"px",height:a+"px"}),x.css(e.start.dot,{top:a-1-4+"px",left:r-1-4+"px"}),x.css(e.range.dom,{top:c+"px",left:l+"px"}),x.css(e.range.top,{width:u+"px"}),x.css(e.range.left,{height:f+"px"}),x.css(e.range.bottom,{top:f+"px",width:u+"px"}),x.css(e.range.right,{left:u+"px",height:f+"px"}),x.css(e.range.dot,{top:f-4+"px",left:u-4+"px"}),e.start.dom.style.display="block",s()?(e.start.dot.style.display="block",e.range.dom.style.display="none"):(e.start.dot.style.display="none",e.range.dom.style.display="block"),e.container.style.display="block",e.start.dot.style.display="none",e.range.dot.style.display="none",h())}function p(){var e={container:null,rowLine:null,colLine:null,start:{dom:null,top:null,right:null,bottom:null,left:null,dot:null},range:{dom:null,top:null,right:null,bottom:null,left:null,dot:null}};return e.container=a(v.doc.body,y.ID.TABLE_RANGE_BORDER,y.TAG.TMP_TAG),x.attr(e.container,{contenteditable:"false"}),e.colLine=a(e.container,y.ID.TABLE_COL_LINE,"div"),e.rowLine=a(e.container,y.ID.TABLE_ROW_LINE,"div"),e.start.dom=a(e.container,y.ID.TABLE_RANGE_BORDER+"_start","div"),e.start.top=a(e.start.dom,y.ID.TABLE_RANGE_BORDER+"_start_top","div"),e.start.right=a(e.start.dom,y.ID.TABLE_RANGE_BORDER+"_start_right","div"),e.start.bottom=a(e.start.dom,y.ID.TABLE_RANGE_BORDER+"_start_bottom","div"),e.start.left=a(e.start.dom,y.ID.TABLE_RANGE_BORDER+"_start_left","div"),e.start.dot=a(e.start.dom,y.ID.TABLE_RANGE_BORDER+"_start_dot","div"),e.range.dom=a(e.container,y.ID.TABLE_RANGE_BORDER+"_range","div"),e.range.top=a(e.range.dom,y.ID.TABLE_RANGE_BORDER+"_range_top","div"),e.range.right=a(e.range.dom,y.ID.TABLE_RANGE_BORDER+"_range_right","div"),e.range.bottom=a(e.range.dom,y.ID.TABLE_RANGE_BORDER+"_range_bottom","div"),e.range.left=a(e.range.dom,y.ID.TABLE_RANGE_BORDER+"_range_left","div"),e.range.dot=a(e.range.dom,y.ID.TABLE_RANGE_BORDER+"_range_dot","div"),e}function h(){var e;return _.grid&&_.range&&!s()?(e=v.doc.getSelection(),void e.empty()):void(c()||O.setRange(_.start.cell,_.start.cell.childNodes.length))}var b,C,E,v=e("../common/env"),y=e("../common/const"),T=e("../common/utils"),S=e("../common/historyUtils"),A=e("./tableUtils"),x=e("../domUtils/domExtend"),O=e("../rangeUtils/rangeExtend"),_={active:!1,table:null,start:null,end:null,range:null,grid:null},N={bind:function(){N.unbind(),v.event.add(y.EVENT.ON_SELECTION_CHANGE,N.handler.onSelectionChange),v.event.add(y.EVENT.UPDATE_RENDER,N.handler.updateRender),_.table&&(_.table.addEventListener("DOMSubtreeModified",N.handler.onDomModified),v.doc.body.addEventListener("resize",N.handler.onDomModified))},unbind:function(){var e=w.getZone();v.event.remove(y.EVENT.ON_SELECTION_CHANGE,N.handler.onSelectionChange),v.event.remove(y.EVENT.UPDATE_RENDER,N.handler.updateRender),e.table&&(e.table.removeEventListener("DOMSubtreeModified",N.handler.onDomModified),v.doc.body.removeEventListener("resize",N.handler.onDomModified))},bindStopSelectStart:function(){N.unbindStopSelectStart(),v.event.add(y.EVENT.ON_SELECT_START,N.handler.onStopSelectStart)},unbindStopSelectStart:function(){v.event.remove(y.EVENT.ON_SELECT_START,N.handler.onStopSelectStart)},bindDragLine:function(){N.unbindDragLine(),N.bindStopSelectStart(),v.event.add(y.EVENT.ON_MOUSE_MOVE,N.handler.onDragLineMove),v.event.add(y.EVENT.ON_MOUSE_UP,N.handler.onDragLineEnd)},unbindDragLine:function(){N.unbindStopSelectStart(),v.event.remove(y.EVENT.ON_MOUSE_MOVE,N.handler.onDragLineMove),v.event.remove(y.EVENT.ON_MOUSE_UP,N.handler.onDragLineEnd)},handler:{onDragLineMove:function(e){var t=p(),n=A.getMousePosition(e,_.table);"block"==t.colLine.style.display?u(n.x-t.colLine.startMouse+t.colLine.startLine):f(n.y-t.rowLine.startMouse+t.rowLine.startLine)},onDragLineEnd:function(e){N.unbindDragLine();var t,n=p(),r=A.getMousePosition(e,_.table),o="block"==n.colLine.style.display,i="block"==n.rowLine.style.display;n.colLine.style.display="none",n.rowLine.style.display="none",S.saveSnap(!1),o&&n.colLine.startMouse!==r.x?(t=n.colLine.cellData,t&&(A.initTable(_.table),A.setColWidth(_.table,_.grid,t.x,r.x-n.colLine.startMouse))):i&&n.rowLine.startMouse!==r.y&&(t=n.rowLine.cellData,t&&(A.initTable(_.table),A.setRowHeight(_.table,_.grid,t.y,r.y-n.rowLine.startMouse))),n.colLine.cellData=null,n.colLine.minLeft=null,n.colLine.startLine=null,n.colLine.startMouse=null,n.rowLine.cellData=null,n.rowLine.minTop=null,n.rowLine.startLine=null,n.rowLine.startMouse=null,v.event.call(y.EVENT.UPDATE_RENDER)},onSelectionChange:function(e){var t=v.doc.getSelection();c()||(t.empty(),T.stopEvent(e))},onDomModified:function(e){var t=e&&"DOMSubtreeModified"==e.type&&1===e.target.nodeType&&e.target.querySelector("img");E&&clearTimeout(E),E=setTimeout(function(){v.event.call(y.EVENT.UPDATE_RENDER,e,t)},100)},onStopSelectStart:function(e){return T.stopEvent(e),!1},updateRender:function(e,t){function n(e){m(),e&&C<60&&(b&&clearTimeout(b),b=setTimeout(function(){C++,n(e)},500))}C=0,n(t)}}},w={clear:function(){_.active=!1,_.start=null,_.end=null,_.range=null,_.grid=null,m();var e=p();return e.colLine.style.display="none",e.rowLine.style.display="none",_.table=null,N.unbind(),w},getFragmentForCopy:function(){var e=null;if(!_.range)return e;var t,n,r,o,i,a=v.doc.createElement("table"),l=v.doc.createElement("tbody");for(a.appendChild(l),n=_.range.minY;n<=_.range.maxY;n++){for(o=v.doc.createElement("tr"),t=_.range.minX;t<=_.range.maxX;t++)r=_.grid[n][t],r.fake||(i=A.cloneCell(r.cell,!1),o.children.length>0&&o.appendChild(v.doc.createTextNode("\t")),o.appendChild(i));o.appendChild(v.doc.createTextNode("\n")),l.appendChild(o)}return e=v.doc.createElement("div"),e.appendChild(a),e},getRangeBorder:p,getSelectedCells:function(){return A.getCellsByRange(_.grid,_.range)},getZone:function(){return{active:_.active,table:_.table,start:_.start,end:_.end,range:_.range,grid:_.grid}},hasMergeCell:l,isRangeActiving:function(){return _.start&&_.active},isSingleCell:s,isZoneBorder:function(e){var t,n=e.target,r=e.offsetX,o=e.offsetY,i=T.getEventClientPos(e),a=!1,l=!1,s=!1,c=!1,d=!1,u=!!x.getParentByFilter(n,function(e){return e&&1==e.nodeType&&(e.id==y.ID.TABLE_RANGE_BORDER+"_start_dot"||e.id==y.ID.TABLE_RANGE_BORDER+"_range_dot")},!0);u||(s=!!x.getParentByFilter(n,function(e){if(e&&1==e.nodeType&&(e.id==y.ID.TABLE_RANGE_BORDER+"_start_right"||e.id==y.ID.TABLE_RANGE_BORDER+"_range_right"))return!0;var t,n;return!(!e||1!=e.nodeType||!x.isTag(e,["td","th"]))&&(t=e.offsetWidth-4,n=e.offsetWidth+4,r>=t&&r<=n)},!0)),u||s||(c=!!x.getParentByFilter(n,function(e){if(e&&1==e.nodeType&&(e.id==y.ID.TABLE_RANGE_BORDER+"_start_bottom"||e.id==y.ID.TABLE_RANGE_BORDER+"_range_bottom"))return!0;var t,n;return!(!e||1!=e.nodeType||!x.isTag(e,["td","th"]))&&(t=e.offsetHeight-4,n=e.offsetHeight+4,o>=t&&o<=n)},!0)),c||u||s||(l=!!x.getParentByFilter(n,function(e){return e&&1==e.nodeType&&e.id==y.ID.TABLE_RANGE_BORDER},!0));var f,g,m;return c||u||s||l||(d=!!A.getContainerExcludeTable(n),d||n!=v.doc.body||(f=v.win.getComputedStyle(n),g=parseInt(f.paddingLeft),m=parseInt(f.paddingRight),a=i.x<=g||i.x>=v.doc.body.offsetWidth-m)),t=(e.target.clientWidth>0&&e.target.clientWidth<e.offsetX||e.target.clientHeight>0&&e.target.clientHeight<e.offsetY)&&(e.target.offsetWidth>=e.offsetX||e.target.offsetHeight>=e.offsetY),{isBodyBorder:a,isBorder:l,isBottom:c,isContainer:d,isDot:u,isRight:s,isScroll:t}},modify:function(e){if(!_.active||!e)return w;var t=x.getParentByTagName(e,["table"],!0,null);if(!t||t!==_.table)return w;var n=A.getCellData(_.grid,e);_.range=A.getRangeByCellsData(_.grid,_.start,n),_.end=n,m();var r=x.getParentByFilter(_.table,function(e){return x.hasClass(e,y.CLASS.TABLE_BODY)},!1);return x.addClass(r,y.CLASS.TABLE_MOVING),w},remove:function(){w.clear();var e,t=p();t&&(e=t.container.parentNode,e&&e.removeChild(t.container))},setEnd:function(e,t){t&&(_.active=!0),w.modify(e),_.active=!1,h(),v.event.call(y.EVENT.ON_SELECTION_CHANGE,null);var n=x.getParentByFilter(_.table,function(e){return x.hasClass(e,y.CLASS.TABLE_BODY)},!1);return x.removeClass(n,y.CLASS.TABLE_MOVING),w},setStart:function(e,t,n){if(!e)return w.clear(),w;var o=x.getParentByTagName(e,["table"],!0,null);if(!o)return w.clear(),w;if(o!==_.table&&(w.clear(),r(o)),_.active=!0,_.end=null,_.start=A.getCellData(_.grid,e),"undefined"!=typeof t&&"undefined"!=typeof n)try{var i=_.grid[n][t];i&&i.cell==_.start.cell&&(_.start=i)}catch(e){}return _.range=A.getRangeByCellsData(_.grid,_.start,_.start),m(),_.start.cell.scrollIntoViewIfNeeded&&_.start.cell.scrollIntoViewIfNeeded(),N.bind(),w},setStartRange:h,startDragColLine:function(e,t){var n,i;if(e&&1==e.nodeType&&e.id==y.ID.TABLE_RANGE_BORDER+"_start_right")i=_.start,e=_.start.cell,n=_.table;else if(e&&1==e.nodeType&&e.id==y.ID.TABLE_RANGE_BORDER+"_range_right")i=_.grid[_.range.maxY][_.range.maxX],e=i.cell,n=_.table;else{if(e=x.getParentByTagName(e,["th","td"],!0,null),!e)return;if(n=x.getParentByTagName(e,["table"],!0,null),!n)return;n!==_.table&&(o(),w.clear()),_.grid||r(n),i=A.getCellData(_.grid,e)}for(var a,l=i.x;l+1<_.grid[i.y].length&&(l++,a=_.grid[i.y][l],a.cell==e);)i=a;var s=e.offsetLeft+e.offsetWidth,c=p();g(c),c.colLine.minLeft=n.offsetLeft,c.colLine.startLine=s,c.colLine.startMouse=t,c.colLine.cellData=i,u(s);var d=v.doc.getSelection();d.empty(),N.bindDragLine()},startDragRowLine:function(e,t){var n,i;if(e&&1==e.nodeType&&e.id==y.ID.TABLE_RANGE_BORDER+"_start_bottom")i=_.start,e=_.start.cell,n=_.table;else if(e&&1==e.nodeType&&e.id==y.ID.TABLE_RANGE_BORDER+"_range_bottom")i=_.grid[_.range.maxY][_.range.maxX],e=i.cell,n=_.table;else{if(e=x.getParentByTagName(e,["th","td"],!0,null),!e)return;if(n=x.getParentByTagName(e,["table"],!0,null),!n)return;n!==_.table&&(o(),w.clear()),_.grid||r(n),i=A.getCellData(_.grid,e);
}for(var a,l=i.y;l+1<_.grid.length&&(l++,a=_.grid[l][i.x],a.cell==e);)i=a;var s=e.offsetTop+e.offsetHeight,c=p();g(c),c.rowLine.minTop=n.offsetTop,c.rowLine.startLine=s,c.rowLine.startMouse=t,c.rowLine.cellData=i,f(s);var d=v.doc.getSelection();d.empty(),N.bindDragLine()},switchCell:function(e,t){function n(){t.canChangeRow&&o>=0&&o<_.grid.length&&(r<0?(r=_.grid[o].length-1,o-=1):r>=_.grid[o].length&&(r=0,o+=1))}if(!t||!_.start)return null;t.x=t.x?t.x>0?1:-1:0,t.y=t.y?t.y>0?1:-1:0;var r=e.x+t.x,o=e.y+t.y;n();for(var i=e;o>=0&&o<_.grid.length&&r>=0&&r<_.grid[o].length&&i.cell==e.cell;)i=_.grid[o][r],r+=t.x,o+=t.y,n();return i},updateGrid:function(){var e,t;return _.table&&(_.grid&&(e=_.grid[_.range.minY][_.range.minX],t=_.grid[_.range.maxY][_.range.maxX]),r(_.table),e=A.getCellData(_.grid,e.cell),t=A.getCellData(_.grid,t.cell),_.range=A.getRangeByCellsData(_.grid,e,t),_.start=A.getCellData(_.grid,_.start.cell),_.end&&(_.end=A.getCellData(_.grid,_.end.cell))),v.event.call(y.EVENT.UPDATE_RENDER),w}};t.exports=w},{"../common/const":14,"../common/env":16,"../common/historyUtils":17,"../common/utils":20,"../domUtils/domExtend":25,"../rangeUtils/rangeExtend":39,"./tableUtils":44}],46:[function(e,t,n){"use strict";function r(e){if(!m.hasPermission())return null;var t=e.target;if(!c.hasClass(t,a.CLASS.TODO_CHECKBOX))return null;var n=f.getContainerFromChild(t),r=f.getContainerFromChild(n.parentNode);return r?f.fixNewTodo(r):f.fixNewTodo(n),i.readonly&&h.curCheckbox?null:(!i.readonly||h.docLockChecked?o(t,e):(h.curCheckbox=t,m.checkDocLock("onCheckDocLock")),void d.setRange(n,n.children.length))}function o(e,t){var n=f.checkTodo(e,m);n&&(i.readonly&&h.addModifiedId(n),t&&l.stopEvent(t))}var i=e("../common/env"),a=e("../common/const"),l=e("../common/utils"),s=e("../common/historyUtils"),c=e("../domUtils/domExtend"),d=e("../rangeUtils/rangeExtend"),u=e("./todoRouteForClient"),f=e("./todoUtils"),g=e("./todoStyle"),m=null,p=null,h={curCheckbox:null,docLockChecked:!1,modifiedIdList:{},htmlToSave:"",init:function(){if(i.readonly){h.modifiedIdList={};var e,t,n=i.doc.querySelectorAll("."+a.CLASS.TODO_CHECKBOX);for(e=0;e<n.length;e++)t=n[e],t.wizTodoIndex=e}},addModifiedId:function(e){if(i.readonly){var t=e.checkbox,n=e.checked,r=h.modifiedIdList[t.wizTodoIndex];"boolean"==typeof r&&r!==n?delete h.modifiedIdList[t.wizTodoIndex]:h.modifiedIdList[t.wizTodoIndex]=n}},getModifiedIdList:function(){var e,t=[];for(e in h.modifiedIdList)h.modifiedIdList.hasOwnProperty(e)&&t.push({id:e,checked:h.modifiedIdList[e]});return t},modifyDoc:function(){var e="",t=h.getModifiedIdList();if(0===t.length)return e;e=m.getOriginalDoc();var n=i.doc.getElementById(a.ID.IFRAME_FOR_SAVE);n||(n=i.doc.createElement("iframe"),n.id=a.ID.IFRAME_FOR_SAVE,i.doc.body.appendChild(n)),n.style.display="none";var r,o,l,s,d,u,g=i.doc,p=i.win,b=n.contentDocument,C=m.isPersonalDocument();for(b.open("text/html","replace"),b.write(e),b.close(),i.doc=b,i.win=n.contentWindow,f.oldPatch.fixOldTodo(),f.fixNewTodo(),s=i.doc.querySelectorAll("."+a.CLASS.TODO_CHECKBOX),r=t.length-1;r>=0;r--)o=t[r].id,l=t[r].checked,d=s[o],d&&(u=f.getMainFromChild(d),f.check(u,l),C||f.addUserInfo(u,l,d.id,m));return f.checkTodoStyle(!0),e=c.getContentHtml(),i.doc=g,i.win=p,i.doc.body.removeChild(n),e}},b={bind:function(){b.unbind(),i.event.add(a.EVENT.ON_SELECTION_CHANGE,b.handler.onSelectionChange),i.event.add(a.EVENT.AFTER_RESTORE_HISTORY,b.handler.afterRestoreHistory),i.event.add(a.EVENT.ON_EXEC_COMMAND,b.handler.onExecCommand),i.event.add(a.EVENT.ON_PASTE,b.handler.onPaste),i.event.add(a.EVENT.AFTER_INSERT_DOM,b.handler.afterInsertDom),i.client.type.isIOS||i.client.type.isAndroid?(i.event.add(a.EVENT.ON_TOUCH_END,b.handler.onTouchEnd),i.event.add(a.EVENT.ON_TOUCH_START,b.handler.onTouchStart)):i.event.add(a.EVENT.ON_CLICK,b.handler.onClick)},unbind:function(){i.event.remove(a.EVENT.ON_CLICK,b.handler.onClick),i.event.remove(a.EVENT.ON_SELECTION_CHANGE,b.handler.onSelectionChange),i.event.remove(a.EVENT.ON_TOUCH_END,b.handler.onTouchEnd),i.event.remove(a.EVENT.ON_TOUCH_START,b.handler.onTouchStart),i.event.remove(a.EVENT.AFTER_RESTORE_HISTORY,b.handler.afterRestoreHistory)},handler:{afterRestoreHistory:function(){f.checkTodoStyle(!1),f.fixNewTodo(),g.restoreUserAvatarStyle()},onClick:function(e){r(e)},onCheckDocLock:function(e,t){h.docLockChecked=!t,e||o(h.curCheckbox),h.curCheckbox=null},onExecCommand:function(){var e,t,n,r,o=d.getRange();if(o&&(e=o.collapsed?o.startContainer:c.getParentRoot([o.startContainer,o.endContainer]),e=c.getBlockParent(e,!0)))for(t=e.querySelectorAll("."+a.CLASS.TODO_CHECKBOX),n=0,r=t.length;n<r;n++)f.fixCheckbox(t[n],!1)},onKeyDown:function(e){if(!m.hasPermission())return!0;var t=d.getRange();if(!t)return!0;var n,r,o,u,g,p,h,b,C,E,v,y,T,S,A,x,O,_,N=e.keyCode||e.which;if(!t.collapsed){if(8!==N&&46!==N&&l.checkNonTxtKey(e))return!0;if(_=d.getRangeDomList({noSplit:!0}),_&&_.list.length>0){for(s.saveSnap(!1),o=t.endContainer,u=t.endOffset,3!==o.nodeType&&(t.endOffset===o.childNodes.length?(o=c.getLastDeepChild(o),u=c.getEndOffset(o)):(o=o.childNodes[t.endOffset],u=0)),E=f.getContainerFromChild(o),x=_.list.length-1;x>=0;x--)O=_.list[x],f.isCheckbox(O)&&(C=f.getContainerFromChild(O),b=f.getMainFromChild(O),b&&(h=b.parentNode,f.cancelTodo(h,!0)),E&&C==E&&(o.parentNode||(o=h,u=c.getEndOffset(o)),d.setRange(t.startContainer,t.startOffset,o,u)));return!0}t.collapse(!0)}if(g=f.isCaretAfterCheckbox(),p=f.getMainByCaret(),h=p?c.getBlockParent(p,!1):f.getContainerFromChild(t.startContainer),v=c.getEndOffset(t.endContainer)===t.endOffset,!h||p||f.getCheckbox(h)||(c.removeClass(h,a.CLASS.TODO_LAYER),h=null),!h&&!v&&13!==N)return!0;if(8===N&&g)return s.saveSnap(!1),f.cancelTodo(h),l.stopEvent(e),!1;if(46===N&&(s.saveSnap(!1),n=t.startContainer,r=t.startOffset,d.selectCharIncludeFillChar(),t=d.getRange(),o=t.endContainer,b=f.getMainFromChild(o)||f.getMainInDom(o),d.setRange(n,r),b&&b!=p))return f.cancelTodo(b.parentNode,!0),!1;if(37===N&&g&&(O=c.getPreviousNode(h)))return d.setRange(O,c.getEndOffset(O)),l.stopEvent(e),!1;if(!h||13!==N||e.shiftKey)return!0;if(s.saveSnap(!1),f.isEmptyContainer(h))return c.getParentByTagName(h,["blockquote","ul","ol"])?i.event.call(a.EVENT.EXEC_COMMEND,"outdent",!1):(h.innerHTML="<br>",c.removeClass(h,a.CLASS.TODO_LAYER),d.setRange(h,1)),l.stopEvent(e),!1;t.deleteContents(),f.fixNewTodo(h);var w=!1,D=f.getUserInfoInDom(h),L=void 0;D?(L=c.getPreviousNode(D,!1,h),t.startContainer===D&&t.startOffset!==c.getEndOffset(D)?w=!0:f.getUserInfoFromChild(t.startContainer)&&(w=!0)):L=h,t.setEndAfter(w?h:L);var R=t.cloneContents(),I=i.doc.createElement("div");for(R.appendChild(I);R.childNodes.length>1;)I.appendChild(R.firstChild);y=c.isEmptyDom(I);var k;if(y)S=f.cloneTodo(h),p=f.getMainInDom(S),c.after(S,h),f.setTodo(S,m),O=c.getLastDeepChild(S),3===O.nodeType?O.nodeValue=a.FILL_CHAR+a.FILL_CHAR:(O.appendChild(i.doc.createTextNode(a.FILL_CHAR+a.FILL_CHAR)),O=O.childNodes[0]),d.setRange(O,1);else{for(k=t.extractContents(),A=[],x=0;x<k.childNodes.length;x++)A.push(k.childNodes[x]);for(T=h!==i.doc.body&&c.isBlock(h)?h.tagName:"div",S=i.doc.createElement(T),c.after(S,h),p=f.setTodo(S,m),f.insertToMain(A,p),x=0;x<A.length;x++)f.clearBlock(A[x]);d.setRange(p,1)}if(l.stopEvent(e),p.getBoundingClientRect().top+p.clientHeight>i.doc.documentElement.clientHeight||p.getBoundingClientRect().top+p.clientHeight<0){var M=p.getBoundingClientRect().left+i.doc.body.scrollLeft,B=i.doc.body.scrollTop+p.clientHeight;window.scrollTo(M,B)}},afterInsertDom:function(){f.fixNewTodo(),f.checkTodoStyle(!1)},onPaste:function(){setTimeout(function(){b.handler.afterInsertDom()},300)},onSelectionChange:function(){var e=d.getRange();if(e){var t,n,r;e.collapsed||(n=e.endContainer,r=e.endOffset);var o=f.isCaretBeforeCheckbox();o.enable&&(t=o.checkbox,t&&t.nextSibling?(n=t.nextSibling,r=0):t&&(n=t.parentNode,r=c.getIndex(t)+1),e.collapsed?d.setRange(n,r):d.setRange(e.startContainer,e.startOffset,n,r))}},onTouchStart:function(e){p=e.target},onTouchEnd:function(e){e.target===p&&(p=null,r(e))}}},C={init:function(){},on:function(){f.oldPatch.fixOldTodo(),f.fixNewTodo(),h.init(),b.bind(),m||(m=u.getRoute()),f.checkTodoStyle(!0)},off:function(){b.unbind()},checkTodoStyle:function(){f.checkTodoStyle(!1)},closeDocument:function(){var e;return m||(m=u.getRoute()),e=i.client.type.isWin&&i.options.pc.pluginModified?c.getContentHtml():h.modifyDoc(),!e||i.client.type.isIOS||i.client.type.isMac||m.saveDoc(e,""),m.beforeCloseDoc&&m.beforeCloseDoc(),h.init(),e},onCheckDocLock:b.handler.onCheckDocLock,onKeyDown:b.handler.onKeyDown,setTodo:function(){s.saveSnap(!1),f.setTodo(null,m)},setTodoInfo:function(e){m.setTodoInfo&&m.setTodoInfo(e)}};t.exports=C},{"../common/const":14,"../common/env":16,"../common/historyUtils":17,"../common/utils":20,"../domUtils/domExtend":25,"../rangeUtils/rangeExtend":39,"./todoRouteForClient":47,"./todoStyle":48,"./todoUtils":49}],47:[function(e,t,n){"use strict";function r(){function e(){try{return s.UserAlias}catch(e){return console.error(e),""}}function t(){try{return s.GetUserGUID()}catch(e){return console.error(e),""}}function n(e){try{return s.GetUserAvatarFileName(e)}catch(e){return console.error(e),""}}function r(){try{return s.WizDocument.IsPersonalDocument()}catch(e){return console.error(e),!1}}function o(e){s.WizDocument&&(s.WizDocument.Type=e)}function i(){try{return!u.readonly||s.WizDocument.CanEdit}catch(e){return console.error(e),!1}}function a(){try{return s.WizDocument.GetHtml()}catch(e){return console.error(e),""}}function l(e,t){try{s.WizDocument.SetHtml2(e,t)}catch(e){console.error(e)}}function c(e){if(r())return void WizReader.todo[e](!1,!1);try{s.ExecuteCommand("OnClickingChecklist","WizReader.todo."+e+"({cancel}, {needCallAgain});","readingnote")}catch(e){console.error(e)}}s=u.win.external,this.getUserAlias=e,this.getUserGuid=t,this.getUserAvatarFileName=n,this.isPersonalDocument=r,this.setDocumentType=o,this.hasPermission=i,this.getOriginalDoc=a,this.saveDoc=l,this.checkDocLock=c}function o(){function e(){return"zzz"}function t(){return"63272832-e387-4d31-85c6-7549555f2231"}function n(){return"/wizas/a/users/avatar/63272832-e387-4d31-85c6-7549555f2231?default=true"}function r(){return!1}function o(e){}function i(){return!0}function a(){return u.doc.body.outerHTML}function l(e,t){console.log("saveDoc")}function s(e){setTimeout(function(){WizReader.todo.onCheckDocLock(!1,!1)},500)}this.getUserAlias=e,this.getUserGuid=t,this.getUserAvatarFileName=n,this.isPersonalDocument=r,this.setDocumentType=o,this.hasPermission=i,this.getOriginalDoc=a,this.saveDoc=l,this.checkDocLock=s}function i(){function e(){return c.userAlias}function t(){return c.userGuid}function n(e){return c.userAvatarFilePath}function r(){return c.isPersonalDocument}function o(e){c.changeCurrentDocumentType(e)}function i(){return!u.readonly||c.hasEditPermissionOnCurrentNote}function a(){return c.currentNoteHtml}function l(e,t){}function s(e){return c.clickingTodoCallBack.connect(WizReader.todo[e]),c.checkListClickable()}c=u.win.WizQtEditor,this.getUserAlias=e,this.getUserGuid=t,this.getUserAvatarFileName=n,this.isPersonalDocument=r,this.setDocumentType=o,this.hasPermission=i,this.getOriginalDoc=a,this.saveDoc=l,this.checkDocLock=s}function a(){function e(){return d.getUserAlias()}function t(){return d.getUserGuid()}function n(e){return d.getUserAvatarFileName(e)}function r(){return d.isPersonalDocument()}function o(e){d.setDocumentType(e)}function i(){return!u.readonly||d.hasPermission()}function a(){return d.getDocHtml()}function l(e,t){d.setDocHtml(e,t)}function s(e){d.checkDocLock()}function c(){d.onWizTodoReadCheckedClose()}d=u.win.WizNote,this.getUserAlias=e,this.getUserGuid=t,this.getUserAvatarFileName=n,this.isPersonalDocument=r,this.setDocumentType=o,this.hasPermission=i,this.getOriginalDoc=a,this.saveDoc=l,this.checkDocLock=s,this.beforeCloseDoc=c}function l(){function e(e){this.userAlias=e.alias,this.userGuid=e.userGuid,this.avatarFileName=e.avatar,this.personalDocument="true"===e.isPersonal,this._hasPermission="true"===e.hasPermission,this.originalHtml=f.decode(e.docHtml)}function t(){return this.userAlias}function n(){return this.userGuid}function r(e){return this.avatarFileName}function o(){return this.personalDocument}function i(e){u.win.location.href="wiztodolist://setDocumentType/?type="+e}function a(){return!u.readonly||this._hasPermission}function l(){return this.originalHtml}function s(e){u.win.location.href="wiztodolist://tryLockDocument/?callback="+e}this.getUserAlias=t,this.getUserGuid=n,this.getUserAvatarFileName=r,this.isPersonalDocument=o,this.setDocumentType=i,this.setTodoInfo=e,this.hasPermission=a,this.getOriginalDoc=l,this.checkDocLock=s,this.userAlias="",this.userGuid="",this.avatarFileName="",this.personalDocument=!1,this._hasPermission=!1,this.originalHtml=""}var s,c,d,u=e("../common/env"),f=e("../common/base64"),g={getRoute:function(){var e=null;return e=u.client.type.isWin?new r:u.client.type.isMac?new i:u.client.type.isIOS?new l:u.client.type.isAndroid?new a:new o},setQtEditor:function(){c=u.win.WizQtEditor}};t.exports=g},{"../common/base64":13,"../common/env":16}],48:[function(e,t,n){"use strict";function r(e){var t=new RegExp("^"+i.ID.TODO_AVATAR_STYLE+"(.*)$","i");return e.replace(t,"$1")}var o=e("../common/env"),i=e("../common/const"),a=e("../common/wizStyle"),l=e("../domUtils/domBase"),s={},c={todoChecked:"data:text/xml;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUYxRkNCNDRFNUYzMTFFN0I3MjU4OUZFNDhFRjQzMjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUYxRkNCNDVFNUYzMTFFN0I3MjU4OUZFNDhFRjQzMjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5RjFGQ0I0MkU1RjMxMUU3QjcyNTg5RkU0OEVGNDMyNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5RjFGQ0I0M0U1RjMxMUU3QjcyNTg5RkU0OEVGNDMyNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PoB3J04AAAJhSURBVHja7JjLK0RRHMdnhFiM55RsFJGFrcSOGguDaHZCSRY2Q7PwiAUlj1gMCkvF2FDKZpLXSh7xB1jMf6AmY5RSGt9Tv6vjdO5j7twzzcKvPt07v+ae873n/B5nxp1KpVy5ZHmuHLOcE5QvOqLR6O99KNmZLR2rYFYqiKwBrIU9lz5cSzKYiAXoCF7swGCHdsC47grBGsEDKHPgzUMGYgrAPhjkfBsyQSsk5gtMgQgGjTu8RUXgGPRyviMwIxPko+s0hGwriBcPOAMdnO8GjLItlgnSYuZQgZhKljeghfM9gwDtiG5QM3N6m6rBJWjifDHgBwmjoFZhteAK1HG+V9BF17QL4wII2yykbEVuBTEfFNAx08KoI2aR7mvAEPi0KKYZnFPsaMZipQ882m0dVdw9C75r4LXwXDtlT6VQKEfJb7uXBYUB2sAdqDd4poeyySP456jeZNRcv2llYkJruQetku8PgFNQLPjXWTviHWhNbrvdPkEZkeB8Xlq5AOdjPSlCbcElVOFZybjhTI4fMZr8m/OxVTgBk6zsg13JmL9VWFidZXou7SwTBw/SxPxLbep8/4mvwpJ4cuSAtkdYWdFuYZuVnRiDRqmrV4VVCpJlnmZJvSqs+kwtyzwWK/16VTgbh3w+80yrsK1Dvg3TMq/UrApnS5DLYtZZMrf4yxU/gzSHW/EZ6c88fr/fNIYqFIqpSCeo3+k6rFDQGHdQMxV0xXXnCVDuoJByGnOJPl9YETQP3kAh2KLDfsoh4jRmIc0xb0XQC51zTqnqOm1JGruV5jLOsv+/Y/4FpWk/AgwACweeMaBPu0MAAAAASUVORK5CYII=",todoUnChecked:"data:text/xml;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjlFNzg2NjRFNUYzMTFFN0IyNkY5NzZGNEEyNTU3NEYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjlFNzg2NjVFNUYzMTFFN0IyNkY5NzZGNEEyNTU3NEYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCOUU3ODY2MkU1RjMxMUU3QjI2Rjk3NkY0QTI1NTc0RiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCOUU3ODY2M0U1RjMxMUU3QjI2Rjk3NkY0QTI1NTc0RiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PohRJcgAAAEHSURBVHja7JgxCsJAEEWNSEAQ0XgG8QrWIhYp7e2stRMhpRDETltLe8sU4gE8guIdokQrm/UHvoUWZsVdEJmBx5AUMy87m5DEUUrlfinyuR8LEcqKwuuJKIrSVAdT0AZlwz0TsAVjcPR9/70QogF2oGJpEdIL7IIWaIJD1shCytzAENSAYwiPNW/sEWaOjGNKYwQWhlfnxJpFbomOzqZ+7JmVxb27ZC59cpfFFoVieQ6JkAiJkAiJkAiJkAj9gZBnsa/3iVDC3LMo1Ge+6ghtmWdgAKoGRaqsOeHxRkcoAGfggjlfyJUhYtZ02SPQEdrzi3INLhbGdWHtJns9hSP/h0Toy7gLMABy5T6ChFra5QAAAABJRU5ErkJggg=="},d={common:"."+i.CLASS.TODO_MAIN+" {padding-left: 12px;line-height:30px;}li > ."+i.CLASS.TODO_MAIN+" {padding-left: 0}."+i.CLASS.TODO_CHECKED+" {color: #666;}."+i.CLASS.TODO_UNCHECKED+" {text-decoration: initial;}."+i.CLASS.TODO_CHECKED+" ."+i.CLASS.TODO_CHECKBOX+" {background-image:url("+c.todoChecked+")}."+i.CLASS.TODO_UNCHECKED+" ."+i.CLASS.TODO_CHECKBOX+" {background-image:url("+c.todoUnChecked+")}."+i.CLASS.TODO_CHECKBOX+" {border-radius:0;position:relative;top:-1px;vertical-align:middle;border:0;background-color:transparent;outline:none;width:18px !important; height:18px !important; cursor:default; padding:0px 10px 0px 5px;-webkit-user-select: none;background-size:18px;background-repeat:no-repeat;background-position:5px;box-sizing:initial;}."+i.CLASS.TODO_AVATAR+" {border:0;background-color:transparent;outline:none;width:20px !important; height: 20px !important; vertical-align: -20%; padding:0; margin:0 10px 0 0; border-radius:100%;background-size:20px;background-repeat:no-repeat;}."+i.CLASS.TODO_USER_INFO+" {padding-left: 20px;}input."+i.CLASS.TODO_AVATAR+" {position:relative;top:-4px;}."+i.CLASS.TODO_ACCOUNT+", ."+i.CLASS.TODO_DATE+" { color: #666; }"},u={insertTodoStyle:function(e){u.removeTodoOldStyle();var t=o.doc.getElementById(i.ID.TODO_STYLE);!e&&t||a.replaceStyleById(i.ID.TODO_STYLE,d.common,!1),u.removeUnUsedTodoStyle();var n="wiz_todo_checkbox_img_preview";if(o.client.type.isIOS&&!o.doc.body.querySelector("#"+n)){var r=o.doc.createElement(i.TAG.TMP_TAG),s=o.doc.createElement("img"),f=o.doc.createElement("img");s.src=c.todoChecked,f.src=c.todoUnChecked,r.setAttribute("contenteditable","false"),l.css(r,{width:0,height:0,opacity:0,overflow:"hidden",display:"inline-block"}),r.id=n,r.appendChild(s),r.appendChild(f),o.doc.body.appendChild(r)}},removeTodoOldStyle:function(){a.removeStyleById(i.ID.TODO_STYLE_OLD)},removeTodoStyle:function(){u.removeTodoOldStyle();var e=o.doc.getElementById(i.ID.TODO_STYLE);l.remove(e);var t,n,a=o.doc.querySelectorAll("style");for(n=a.length-1;n>=0;n--)e=a[n],e.id&&0===e.id.indexOf(i.ID.TODO_AVATAR_STYLE)&&(t=r(e.id),s[t]=e.innerHTML,l.remove(e))},removeUnUsedTodoStyle:function(e){var t,n,a,c,d,u=o.doc.querySelectorAll("style");if(e)return n=i.ID.TODO_AVATAR_STYLE+e,a=i.CLASS.TODO_USER_AVATAR+e,c=o.doc.querySelector("."+a),t=o.doc.getElementById(n),void(t&&!c&&(s[e]=t.innerHTML,l.remove(t)));for(d=u.length-1;d>=0;d--)t=u[d],n=t.id,n&&0===n.indexOf(i.ID.TODO_AVATAR_STYLE)&&(e=r(n),o.doc.querySelector("."+i.CLASS.TODO_USER_AVATAR+e)||(s[e]=t.innerHTML,l.remove(t)))},restoreUserAvatarStyle:function(){var e,t;for(e in s)s.hasOwnProperty(e)&&(t=i.ID.TODO_AVATAR_STYLE+e,!o.doc.querySelector("#"+t)&&o.doc.querySelector("."+i.CLASS.TODO_USER_AVATAR+e)&&a.replaceStyleById(t,s[e],!1))}};t.exports=u},{"../common/const":14,"../common/env":16,"../common/wizStyle":21,"../domUtils/domBase":24}],49:[function(e,t,n){"use strict";var r=e("../common/env"),o=e("../common/const"),i=e("../common/lang"),a=i.getLang(),l=e("../common/base64"),s=e("../common/wizStyle"),c=e("../common/utils"),d=e("../domUtils/domExtend"),u=e("../rangeUtils/rangeExtend"),f=e("../common/historyUtils"),g=e("./todoStyle"),m="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",p={addUserInfo:function(e,t,n,i){if(e){var a,l,s,c,f,m,h,b,C;if(a=p.deleteUserInfo(e.parentNode),!t)return void g.removeUnUsedTodoStyle(a);for(a=i.getUserGuid(),l=i.getUserAlias(),s=i.getUserAvatarFileName(o.CSS.TODO_LIST.IMG_WIDTH),c=p.getTime(),p.setUserAvatarStyle(a,s),f=p.getUserInfoHtml(a,l,c),m=r.doc.createElement("span"),d.addClass(m,o.CLASS.TODO_USER_INFO),m.innerHTML=f,m.setAttribute(o.ATTR.TODO_ID,n),C=e.childNodes.length-1;C>=0;C--)h=e.childNodes[C],d.isTag(h,"br")&&e.removeChild(h);for(b=e.nextElementSibling;b;){if(p.isMain(b)){e.parentElement.insertBefore(m,b);break}if(d.isTag(b,"br")){e.parentElement.insertBefore(m,b);break}b=b.nextElementSibling}b||e.parentElement.appendChild(m),m.hasChildNodes()||m.appendChild(r.doc.createElement("br")),u.setRange(m,m.childNodes.length)}},canBeContainer:function(e){return!d.isTag(e,["body","blockquote","td","th"])&&d.isBlock(e)},canCreateTodo:function(){var e=u.getRange();if(!e)return!1;if(d.getParentByClass(e.startContainer,o.CLASS.CODE_CONTAINER,!0))return!1;var t=u.getRangeDomList({noSplit:!0}),n=d.getBlockParent(t.startDom,!0)||r.doc.body,i=null;if(e.collapsed||t.endDom===t.startDom)e.collapsed&&n===r.doc.body&&(n=r.doc.body.childNodes[0]);else if(i=d.getBlockParent(t.endDom,!0)||r.doc.body,i!==n)return!1;return{rangeList:t,start:n,end:i}},cancelTodo:function(e,t){if(e){var n,i,a,l,s,c=u.getRange();n=c?c.startContainer:null,i=c?c.startOffset:0,a=p.getMainInDom(e),s=p.deleteUserInfo(e),g.removeUnUsedTodoStyle(s),l=p.deleteMain(a),l=l?l.start:null,d.removeClass(e,o.CLASS.TODO_LAYER),d.removeClass(e,o.CLASS.TODO_CHECKED),d.removeClass(e,o.CLASS.TODO_UNCHECKED),l&&!d.isEmptyDom(e)||e.querySelector("br")||(l=r.doc.createElement("br"),e.appendChild(l)),t||(n&&n.parentNode||(n=l,i=0),u.setRange(n,i)),p.checkTodoStyle(!1)}},check:function e(t,n){var r=this.getContainerFromChild(t);n?(d.removeClass(r,o.CLASS.TODO_UNCHECKED),d.addClass(r,o.CLASS.TODO_CHECKED)):(d.removeClass(r,o.CLASS.TODO_CHECKED),d.addClass(r,o.CLASS.TODO_UNCHECKED));var e=p.getCheckbox(t),i=n?"checked":"unchecked";e.setAttribute(o.ATTR.TODO_CHECK,i)},checkTodo:function(e,t){var n={checkbox:null,checked:!1};f.saveSnap(!1);var r,i=p.getMainFromChild(e);return i&&i.children[0]==e||p.fixCheckbox(e,!1),r="checked"!==e.getAttribute(o.ATTR.TODO_CHECK),p.check(i,r),n.checkbox=e,n.checked=r,t.isPersonalDocument()||p.addUserInfo(i,r,e.id,t),n},checkTodoStyle:function(e){var t=r.doc.querySelector("."+o.CLASS.TODO_CHECKBOX);t?g.insertTodoStyle(e):g.removeTodoStyle()},clearBlock:function(e){if(!e||1!==e.nodeType&&3!==e.nodeType&&11!==e.nodeType)return!1;var t,n;for(n=0;n<e.childNodes.length;n++)t=e.childNodes[n],p.clearBlock(t)&&t!=e.childNodes[n]&&n--;var r=11==e.nodeType,o=!r&&p.isTodoTag(e),i=!r&&d.isBlock(e);if(i&&d.isEmptyDom(e)){if(!(e.children.length>0))return d.remove(e),!0;d.peelDom(e)}else(i||o)&&d.peelDom(e);return!1},clearTodoClass:function(e){e&&d.removeClass(e,[o.CLASS.TODO_ACCOUNT,o.CLASS.TODO_AVATAR,o.CLASS.TODO_DATE,o.CLASS.TODO_LAYER,o.CLASS.TODO_MAIN,o.CLASS.TODO_CHECKED,o.CLASS.TODO_UNCHECKED,o.CLASS.TODO_USER_INFO])},cloneTodo:function(e){if(!e)return null;var t,n,i,a,l;if(t=d.clone(e,!0),a=p.getMainInDom(e),!a)return null;n=d.clone(a,!0),d.removeClass(t,o.CLASS.TODO_CHECKED),d.addClass(t,o.CLASS.TODO_UNCHECKED);for(var s=a,c=n;s&&s.childNodes&&s.childNodes.length;){for(l=s.childNodes[s.childNodes.length-1];l&&(3===l.nodeType&&0===l.nodeValue.replace(o.FILL_CHAR_REG,"").length||d.isBlock(l)||d.isSelfClosingTag(l));)l=l.previousSibling;!l||p.isCheckbox(l)?(i=r.doc.createTextNode(""),l=null):i=d.clone(l,!0),c.appendChild(i),c=i,s=l}return t.appendChild(n),u.setRange(n,1),t},deleteMain:function(e){return d.peelDom(e,function(e){return!p.isMain(e)&&!p.isCheckbox(e)})},deleteUserInfo:function(e){var t="",n=p.getMainInDom(e),r=e.querySelector("."+o.CLASS.TODO_AVATAR),i=r?r.className:"",a=new RegExp("^(.*"+o.CLASS.TODO_USER_AVATAR+")([^ ]*)(.*)$","i");i.indexOf(o.CLASS.TODO_USER_AVATAR)>-1&&(t=i.replace(a,"$2"));for(var l,s=n?n.nextElementSibling:e.firstChild;s&&!p.isMain(s);)p.isUserInfo(s)?(l=s,s=s.nextElementSibling,e.removeChild(l)):s=s.nextElementSibling;return t},fixCheckbox:function(e,t){if(e){if(e.id||(e.id=p.getCheckId()),d.attr(e,{style:null}),d.isTag(e,"input")){var n=r.doc.createElement("img");n.id=e.id,n.className=e.className,n.src=m,n.setAttribute(o.ATTR.TODO_CHECK,e.getAttribute(o.ATTR.TODO_CHECK)),d.before(n,e),d.remove(e),e=n}if(t||!p.getMainFromChild(e)){var i,a,l,s,c=d.getBlockParent(e),u=p.canBeContainer(c),f=r.doc.createElement("span"),g=!1;for(f.className=(t?o.CLASS.TODO_LABEL_OLD:o.CLASS.TODO_MAIN)+" "+o.CLASS.TODO_UNCHECKED,i=r.doc.createElement(u?c.tagName:"div"),u?d.after(i,c):d.before(i,e),i.appendChild(f),a=e;a;){if(l=a.nextSibling,d.isBlock(a)){if(!u)break;g=!0,s=i.nextSibling}g?d.before(a,s):p.isUserInfo(a)?d.after(a,f):f.appendChild(a),a=l}d.addClass(i,o.CLASS.TODO_LAYER);var h=p.getContainerFromChild(i.parentNode);h&&d.removeClass(h,o.CLASS.TODO_LAYER),u&&d.isEmptyDom(c)&&d.remove(c)}}},fixMain:function(e){if(e){var t,n,r=d.getLastDeepChild(e),i=p.getCheckbox(e);if(i||d.removeClass(e,o.CLASS.TODO_MAIN),d.attr(e,{style:null}),t=p.getContainerFromChild(e),t&&t!=e&&t!==e.parentNode)try{t.appendChild(e)}catch(e){console.error(e)}d.hasClass(e,o.CLASS.TODO_CHECKED)?(d.addClass(t,o.CLASS.TODO_CHECKED),d.removeClass(e,o.CLASS.TODO_CHECKED)):d.hasClass(e,o.CLASS.TODO_UNCHECKED)&&(d.addClass(t,o.CLASS.TODO_UNCHECKED),d.removeClass(e,o.CLASS.TODO_UNCHECKED));var a=e.querySelectorAll("."+o.CLASS.TODO_MAIN);for(n=a.length-1;n>=0;n--)d.after(a[n],e);if(d.isEmptyDom(e)&&e.parentNode&&d.remove(e),r!=i&&(1!==r.nodeType&&3!==r.nodeType||1==r.nodeType&&d.isTag(r,"br")||3===r.nodeType&&0===r.nodeValue.replace(o.FILL_CHAR_REG,"").length)){for(t=r.parentNode;t!=e&&1==t.childNodes.length;)r=t,t=t.parentNode;d.remove(r),p.fixMain(e)}}},fixNewTodo:function(e){function t(e){if(d.isEmptyDom(e))return void d.remove(e);var t=p.getCheckbox(e);t||d.removeClass(l,o.CLASS.TODO_LAYER)}var n,i,a,l,s,c,u,f,g,m,h,b,C,E;for(i=e?e:r.doc,a=i.querySelectorAll("."+o.CLASS.TODO_LAYER),n=0;n<a.length;n++)if(l=a[n],d.attr(l,{style:null}),t(l),s=l.querySelectorAll("."+o.CLASS.TODO_LAYER),0!==s.length&&(c=s[0],u=c.parentNode,b=p.isTodoTag(u)||p.isLayer(u)?c:u,C=l,C!==b)){for(;E=b.nextSibling;)d.after(E,C),C=E;d.after(b,l),t(l)}for(m=i.querySelectorAll("."+o.CLASS.TODO_MAIN),n=0;n<m.length;n++)h=m[n],p.fixMain(h);for(f=i.querySelectorAll("."+o.CLASS.TODO_CHECKBOX),n=0;n<f.length;n++)g=f[n],p.fixCheckbox(g,!1);if(e){var v=d.getLastDeepChild(i);d.isTag(v,"br")&&d.remove(v)}},getCheckbox:function(e){return e?e.querySelector("."+o.CLASS.TODO_CHECKBOX):null},getCheckId:function(){return"wiz_todo_"+Date.now()+"_"+Math.floor(1e6*Math.random()+1)},getContainerFromChild:function(e){return e?d.getParentByFilter(e,function(e){return p.isLayer(e)},!0):null},getMainByCaret:function(){var e=u.getRange();if(!e)return null;var t=u.getRangeDetail(e.startContainer,e.startOffset);return p.getMainFromChild(t.container)},getMainFromChild:function(e){return e?d.getParentByClass(e,o.CLASS.TODO_MAIN,!0):null},getMainHtml:function(){var e='<span class="'+o.CLASS.TODO_MAIN+" "+o.CLASS.TODO_UNCHECKED+'"><img src="'+m+'" id="%1" class="'+o.CLASS.TODO_CHECKBOX+" "+o.CLASS.IMG_NOT_DRAG+'" '+o.ATTR.TODO_CHECK+'="unchecked" /></span>';return e=e.replace("%1",p.getCheckId())},getMainInDom:function(e){return e&&e.hasChildNodes()?p.isMain(e)?e:p.isLayer(e)?e.querySelector("."+o.CLASS.TODO_MAIN):null:null},getUserInfoFromChild:function(e){return e?d.getParentByClass(e,o.CLASS.TODO_USER_INFO,!0):null},getUserInfoInDom:function(e){return e.querySelector("."+o.CLASS.TODO_USER_INFO)},getUserInfoHtml:function(e,t,n){var r='<span class="'+o.CLASS.TODO_ACCOUNT+'"><input disabled readonly class="%1" />%2, </span><span class="'+o.CLASS.TODO_DATE+'">%3.</span>',i=o.CLASS.TODO_USER_AVATAR+l.encode(e);return r.replace("%1",o.CLASS.IMG_NOT_DRAG+" "+o.CLASS.TODO_AVATAR+" "+i).replace("%2",t).replace("%3",n)},getTime:function(){function e(e){return(e<10?"0":"")+e}var t,n,r=new Date;return n=e(r.getHours())+":"+e(r.getMinutes()),t="en"==a.version?a.Month[r.getMonth()]+" "+r.getDate()+", "+r.getFullYear()+" at "+n:r.getFullYear()+a.Date.Year+(r.getMonth()+1)+a.Date.Month+r.getDate()+a.Date.Day+" "+n},insertToMain:function(e,t){if(e&&t){var n,r,o=null;for(n=e.length-1;n>=0;n--)r=e[n],p.clearTodoClass(r),t.insertBefore(r,o),o=r}},isCaretAfterCheckbox:function(){var e=u.getRange();if(!e)return!1;var t,n,r,o;return r=p.getMainByCaret(),!!r&&(!!e.collapsed&&(t=u.getRangeDetail(e.startContainer,e.startOffset),!(3===t.container.nodeType&&t.offset>0&&(o=t.container.nodeValue.substr(0,t.offset),!c.isEmpty(o)))&&(n=t.isEnd?t.container:d.getPreviousNode(t.container,!1,r),p.isCheckbox(n))))},isCaretBeforeCheckbox:function(){var e={enable:!1,checkbox:null},t=u.getRange();if(!t)return e;var n=t.endContainer;return 1===n.nodeType?n=n.childNodes[t.endOffset]:3===n.nodeType&&d.isEmptyDom(n)&&t.endOffset==n.nodeValue.length&&!p.getContainerFromChild(n)&&(n=d.getNextNode(n,!1),n&&(n=d.getParentByFilter(n,function(e){return p.isLayer(e)},!0))),p.isLayer(n)||p.isMain(n)?(e.enable=!0,e.checkbox=p.getCheckbox(n)):p.isCheckbox(n)&&(e.enable=!0,e.checkbox=n),e.checkbox||(e.enable=!1),e},isCheckbox:function(e){return d.hasClass(e,o.CLASS.TODO_CHECKBOX)},isEmptyContainer:function(e){if(!e)return!0;var t,n,r=e.childNodes;for(t=0;t<r.length;t++)if(n=r[t],p.isMain(n)){if(!p.isEmptyMain(n))return!1}else if(!d.isEmptyDom(n))return!1;return!0},isEmptyMain:function(e){if(!e)return!0;var t,n,r=e.childNodes;for(t=0;t<r.length;t++)if(n=r[t],!p.isCheckbox(n)&&!d.isEmptyDom(n))return!1;return!0},isMain:function(e){return d.hasClass(e,o.CLASS.TODO_MAIN)},isLayer:function(e){return d.hasClass(e,o.CLASS.TODO_LAYER)},isTodoTag:function(e){return!!e&&(p.isMain(e)||p.isUserInfo(e)||d.hasClass(e,o.CLASS.TODO_ACCOUNT)||d.hasClass(e,o.CLASS.TODO_DATE))},isUserInfo:function(e){return d.hasClass(e,o.CLASS.TODO_USER_INFO)},setTodo:function(e,t){var n,i,a,l,s,c,f,g,m,h,b=[];if(e)i=e;else{var C=p.canCreateTodo();if(C===!1)return null;if(n=C.rangeList,i=C.start,i=d.packageByDiv(i),i!==r.doc.body){var E=d.getPrevBlock(i),v=d.getNextBlock(i);v&&v!==i&&(d.splitDomBeforeSub(i,v),d.isTag(v,"br")&&d.remove(v)),E&&E!==v&&E!==i&&(i=d.splitDomBeforeSub(i,E),d.isTag(E,"br")?d.remove(E):d.before(E,i))}}for(m=0,h=i.childNodes.length;m<h;m++){if(g=i.childNodes[m],d.isBlock(g)){d.splitDomBeforeSub(i,g);break}b.push(g)}s=p.getMainInDom(i),c=p.getUserInfoInDom(i);var y=!!p.getCheckbox(s);if((s||c)&&p.cancelTodo(i),y)return null;for(l=p.getMainHtml(),f=r.doc.createElement("div"),d.addClass(f,o.CLASS.TODO_LAYER),p.canBeContainer(i)?d.addClass(i,o.CLASS.TODO_LAYER):l='<div class="'+o.CLASS.TODO_LAYER+'">'+l+"</div>",f.innerHTML=l,s=p.getMainInDom(f),a=s.lastChild,p.insertToMain(b,s);f.lastChild;)i.insertBefore(f.lastChild,i.firstChild);return d.isSelfClosingTag(a)?u.setRange(a.parentNode,d.getIndex(a)+1):u.setRange(a,d.getEndOffset(a)),t.setDocumentType(o.TYPE.TODO),p.checkTodoStyle(!1),s},setUserAvatarStyle:function(e,t){var n=l.encode(e),i=o.ID.TODO_AVATAR_STYLE+n,a=o.CLASS.TODO_USER_AVATAR+n,c=r.doc.getElementById(i);if(!c)return(c=r.win.parent.document.getElementById(i))?void s.insertStyle({id:i},c.innerHTML):void d.convertImageToBase64(t,50,50,function(e){var t=r.doc.getElementById(i);t||s.insertStyle({id:i},"."+a+"{background-image:url("+e+");}")})},oldPatch:{fixImg:function(e){if(e){var t=r.doc.createElement("img");t.className=e.className,t.src=m,d.removeClass(t,o.CLASS.TODO_CHECK_IMG_OLD),d.addClass(t,o.CLASS.TODO_CHECKBOX),e.id&&(t.id=e.id),e.getAttribute("state")&&t.setAttribute(o.ATTR.TODO_CHECK,e.getAttribute("state"));
var n=e.parentNode;n.insertBefore(t,e),n.removeChild(e)}},fixLabel:function(e){if(e&&(d.removeClass(e,o.CLASS.TODO_LABEL_OLD),d.addClass(e,o.CLASS.TODO_MAIN),d.hasClass(e,o.CLASS.TODO_CHECKED_OLD)?(d.removeClass(e,o.CLASS.TODO_CHECKED_OLD),d.addClass(e,o.CLASS.TODO_CHECKED)):d.hasClass(e,o.CLASS.TODO_UNCHECKED_OLD)&&(d.removeClass(e,o.CLASS.TODO_UNCHECKED_OLD),d.addClass(e,o.CLASS.TODO_UNCHECKED))),e&&!d.isTag(e,"span")){var t=e.parentNode;if(t){var n=r.doc.createElement("span");for(n.className=e.className;e.firstChild;)n.appendChild(e.firstChild);t.insertBefore(n,e),t.removeChild(e)}}},fixOldTodo:function(){var e,t,n,i,a,l,s,c,u,f,g,m;for(s=r.doc.querySelectorAll("."+o.CLASS.TODO_CHECK_IMG_OLD),e=s.length-1;e>=0;e--)c=s[e],f=p.oldPatch.getLabelFromChild(c),f&&f.children[0]===c||p.fixCheckbox(c,!0),p.oldPatch.fixImg(c);for(u=r.doc.querySelectorAll("."+o.CLASS.TODO_LABEL_OLD),e=0;e<u.length;e++){for(f=u[e],a=p.oldPatch.packageTodo(f),d.addClass(a,o.CLASS.TODO_LAYER),n=a.querySelectorAll("."+o.CLASS.TODO_LABEL_OLD),t=n.length-1;t>0;t--)i=n[t],l=p.oldPatch.packageTodo(i),d.after(l,a);p.oldPatch.fixUserInfo(f)}for(u=r.doc.querySelectorAll("."+o.CLASS.TODO_LABEL_OLD),e=u.length-1;e>=0;e--)p.oldPatch.fixLabel(u[e]);for(g=r.doc.querySelectorAll("."+o.CLASS.TODO_TAIL_OLD),e=g.length-1;e>=0;e--)m=g[e],d.isEmptyDom(m)?d.remove(m):d.removeClass(o.CLASS.TODO_TAIL_OLD)},fixUserInfo:function(e){var t,n,r=e.parentNode,i=p.oldPatch.getCheckImg(e),a=i?i.id:"",l=r.childNodes,s=!1;for(n=0;n<l.length;n++)t=l[n],d.hasClass(t,o.CLASS.TODO_USER_INFO)&&(s?(r.removeChild(t),n--):(s=!0,t.setAttribute(o.ATTR.TODO_ID,a)))},getCheckImg:function(e){return e?e.querySelector("."+o.CLASS.TODO_CHECK_IMG_OLD):null},getLabelFromChild:function(e){return e?d.getParentByFilter(e,function(e){return d.hasClass(e,o.CLASS.TODO_LABEL_OLD)},!0):null},isFirstLabel:function(e){if(!e)return!1;var t,n,r=e.parentNode,o=r.childNodes;for(t=0;t<o.length;t++){if(n=o[t],n===e)return!0;if(!d.isEmptyDom(n))return!1}return!1},packageTodo:function(e){if(!e)return null;var t=e.parentNode;if(t!==r.doc.body&&p.oldPatch.isFirstLabel(e))return t;var n,i=p.oldPatch.getCheckImg(e),a=i?i.id:"",l=a?t.querySelector("span["+o.ATTR.TODO_ID+"="+a+"]"):null,s=e.nextSibling,c=r.doc.createElement("div");for(c.appendChild(e);s;)n=s.nextSibling,c.appendChild(s),s=s===l?null:n;return t.insertBefore(c,n),c}}};t.exports=p},{"../common/base64":13,"../common/const":14,"../common/env":16,"../common/historyUtils":17,"../common/lang":18,"../common/utils":20,"../common/wizStyle":21,"../domUtils/domExtend":25,"../rangeUtils/rangeExtend":39,"./todoStyle":48}],50:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=e("./common/env"),i=e("./common/const"),a=e("./common/utils"),l=(e("./common/base64"),e("./common/wizStyle")),s=e("./imgUtils/imgUtils"),c=e("./nightMode/nightModeUtils"),d=e("./amend/amendInfo"),u=e("./amend/amendUser"),f=e("./todoUtils/todoCore"),g=e("./highlightUtils/highlightUtils"),m=e("./reader/base"),p=e("./markdown/markdownRender"),h={init:function(e){return o.init("reader",e),o.dependency.files.init(),m.init(),p.init(),o.options.noAmend||(u.initUser(o.options.userInfo),u.setUsersData(o.options.usersData)),o.win.WizTemplate&&o.win.WizTemplate.init({document:o.doc,lang:o.options.lang,clientType:o.options.clientType}),h},on:function(e,t){function n(){o.readonly!==!1&&m.afterRender(function(){"function"==typeof t&&t()})}return e&&e.noteType&&(o.options.noteType=e.noteType),o.options.pc.pluginModified=!1,m.on(),h.amendInfo.on(),o.win.WizTemplate&&o.win.WizTemplate.on(!0),o.options.noteType===i.NOTE_TYPE.MARKDOWN?h.markdown(n):o.options.noteType===i.NOTE_TYPE.MATHJAX?h.mathJax(n):setTimeout(function(){n()},0),h},off:function(){return g.off(),h.amendInfo.off(),o.win.WizTemplate&&o.win.WizTemplate.off(),m.off(),h},closeDocument:function(){return f.closeDocument()},getWordCount:function(){var e=o.doc.body.innerText?o.doc.body.innerText:"",t=a.getWordCount(e);return JSON.stringify(t)},highlight:{next:function(){g.next()},on:function(e,t){return g.on(e,t)},off:function(){g.off()},previous:function(){g.previous()}},insertDefaultStyle:function(e,t){return l.insertDefaultStyle(e,t),h},insertCustomStyle:function(e,t,n){return l.insertCustomStyle(e,t,n),h},removeStyleById:function(e){return l.removeStyleById(e),h},markdown:function(e,t){t=t?t:o.options.timeout.markdown,e=e||o.options.callback.markdown;var n=!1,i=function(){e&&/^function$/i.test("undefined"==typeof e?"undefined":r(e))&&!n&&(e(),n=!0)};p.markdown({markdown:function(e){e?setTimeout(i,t):i()},mathJax:function(){i()}})},mathJax:function(e,t){t=t?t:o.options.timeout.mathJax,e=e||o.options.callback.mathJax;var n=!1,r=function(){e&&!n&&(e(),n=!0)};setTimeout(r,t),p.mathJax(function(){r()})},setPluginModify:function(e){return o.options.pc.pluginModified?o.options.pc.pluginModified:(o.options.noteType===i.NOTE_TYPE.COMMON&&(o.options.pc.pluginModified=!!e),o.options.pc.pluginModified)},amendInfo:{on:function(){return o.options.noAmend?h:(d.init({readonly:!0},{onAccept:null,onRefuse:null}),h)},off:function(){return d.remove(),h}},img:{getAll:function(e){return s.getAll(e).join(",")}},todo:{setTodoInfo:f.setTodoInfo,onCheckDocLock:f.onCheckDocLock},nightMode:{on:function(e,t,n){c.on(e,t,n)},off:function(){c.off()}}};window.WizReader=h,t.exports=h},{"./amend/amendInfo":5,"./amend/amendUser":6,"./common/base64":13,"./common/const":14,"./common/env":16,"./common/utils":20,"./common/wizStyle":21,"./highlightUtils/highlightUtils":29,"./imgUtils/imgUtils":33,"./markdown/markdownRender":36,"./nightMode/nightModeUtils":37,"./reader/base":40,"./todoUtils/todoCore":46}]},{},[50]);